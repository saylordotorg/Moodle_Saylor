{"version":3,"sources":["../src/vplidebinaryfile.js"],"names":["define","$","VPLUtil","isBinary","setOldContent","setContent","c","call","setModified","updateDataURL","fileName","getFileName","value","getContent","tid","getTId","isImage","prevalue","getMIME","find","attr","adjustSize","isOpen","editTag","length","tabs","parent","newHeight","height","position","top","open","showFileName","setOpen","addClass","append","text","str","close"],"mappings":"AAuBAA,OAAM,4BACF,CACI,QADJ,CAEI,iBAFJ,CADE,CAKF,SAASC,CAAT,CAAYC,CAAZ,CAAqB,CACjB,MAAO,WAAW,CACd,KAAKC,QAAL,CAAgB,UAAW,CACvB,QACH,CAFD,CAGA,GAAIC,CAAAA,CAAa,CAAG,KAAKC,UAAzB,CACA,KAAKA,UAAL,CAAkB,SAASC,CAAT,CAAY,CAC1BF,CAAa,CAACG,IAAd,CAAmB,IAAnB,CAAyBD,CAAzB,EACA,KAAKE,WAAL,GACA,KAAKC,aAAL,EACH,CAJD,CAKA,KAAKA,aAAL,CAAqB,UAAW,IACxBC,CAAAA,CAAQ,CAAG,KAAKC,WAAL,EADa,CAExBC,CAAK,CAAG,KAAKC,UAAL,EAFgB,CAGxBC,CAAG,CAAG,KAAKC,MAAL,EAHkB,CAI5B,GAAIb,CAAO,CAACc,OAAR,CAAgBN,CAAhB,CAAJ,CAA+B,CAC3B,GAAIO,CAAAA,CAAQ,CAAG,QAAUf,CAAO,CAACgB,OAAR,CAAgBR,CAAhB,CAAV,CAAsC,UAArD,CACAT,CAAC,CAACa,CAAD,CAAD,CAAOK,IAAP,CAAY,KAAZ,EAAmBC,IAAnB,CAAwB,KAAxB,CAA+BH,CAAQ,CAAGL,CAA1C,CACH,CAHD,IAGO,CACHX,CAAC,CAACa,CAAD,CAAD,CAAOK,IAAP,CAAY,KAAZ,EAAmBC,IAAnB,CAAwB,KAAxB,CAA+B,EAA/B,CACH,CACJ,CAVD,CAWA,KAAKC,UAAL,CAAkB,UAAW,CACzB,GAAI,CAAC,KAAKC,MAAL,EAAL,CAAoB,CAChB,QACH,CACD,GAAIC,CAAAA,CAAO,CAAGtB,CAAC,CAAC,KAAKc,MAAL,EAAD,CAAf,CACA,GAAuB,CAAnB,GAAAQ,CAAO,CAACC,MAAZ,CAA0B,CACtB,QACH,CAPwB,GAQrBC,CAAAA,CAAI,CAAGF,CAAO,CAACG,MAAR,EARc,CASrBC,CAAS,CAAGF,CAAI,CAACG,MAAL,EATS,CAUzBD,CAAS,EAAIJ,CAAO,CAACM,QAAR,GAAmBC,GAAhC,CACA,GAAIH,CAAS,EAAIJ,CAAO,CAACK,MAAR,EAAjB,CAAmC,CAC/BL,CAAO,CAACK,MAAR,CAAeD,CAAf,EACA,QACH,CACD,QACH,CAhBD,CAiBA,KAAKI,IAAL,CAAY,UAAW,CACnB,KAAKC,YAAL,GADmB,GAEftB,CAAAA,CAAQ,CAAG,KAAKC,WAAL,EAFI,CAGfG,CAAG,CAAG,KAAKC,MAAL,EAHS,CAInB,KAAKkB,OAAL,KACA,GAAI/B,CAAO,CAACc,OAAR,CAAgBN,CAAhB,CAAJ,CAA+B,CAC3BT,CAAC,CAACa,CAAD,CAAD,CAAOoB,QAAP,CAAgB,aAAhB,EAA+BC,MAA/B,CAAsC,SAAtC,EACA,KAAK1B,aAAL,EACH,CAHD,IAGO,CACHR,CAAC,CAACa,CAAD,CAAD,CAAOoB,QAAP,CAAgB,gBAAhB,EAAkCE,IAAlC,CAAuClC,CAAO,CAACmC,GAAR,CAAY,YAAZ,CAAvC,CACH,CACJ,CAXD,CAYA,KAAKC,KAAL,CAAa,UAAW,CACpB,KAAKL,OAAL,IACH,CACJ,CACJ,CA5DC,CAAN","sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Binary files extension methods. Add to VPLFile object.\n *\n * @copyright 2013 Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\ndefine(\n    [\n        'jquery',\n        'mod_vpl/vplutil',\n    ],\n    function($, VPLUtil) {\n        return function() {\n            this.isBinary = function() {\n                return true;\n            };\n            var setOldContent = this.setContent;\n            this.setContent = function(c) {\n                setOldContent.call(this, c);\n                this.setModified();\n                this.updateDataURL();\n            };\n            this.updateDataURL = function() {\n                var fileName = this.getFileName();\n                var value = this.getContent();\n                var tid = this.getTId();\n                if (VPLUtil.isImage(fileName)) {\n                    var prevalue = 'data:' + VPLUtil.getMIME(fileName) + ';base64,';\n                    $(tid).find('img').attr('src', prevalue + value);\n                } else {\n                    $(tid).find('img').attr('src', '');\n                }\n            };\n            this.adjustSize = function() {\n                if (!this.isOpen()) {\n                    return false;\n                }\n                var editTag = $(this.getTId());\n                if (editTag.length === 0) {\n                    return false;\n                }\n                var tabs = editTag.parent();\n                var newHeight = tabs.height();\n                newHeight -= editTag.position().top;\n                if (newHeight != editTag.height()) {\n                    editTag.height(newHeight);\n                    return true;\n                }\n                return false;\n            };\n            this.open = function() {\n                this.showFileName();\n                var fileName = this.getFileName();\n                var tid = this.getTId();\n                this.setOpen(true);\n                if (VPLUtil.isImage(fileName)) {\n                    $(tid).addClass('vpl_ide_img').append('<img />');\n                    this.updateDataURL();\n                } else {\n                    $(tid).addClass('vpl_ide_binary').text(VPLUtil.str('binaryfile'));\n                }\n            };\n            this.close = function() {\n                this.setOpen(false);\n            };\n        };\n    }\n);\n"],"file":"vplidebinaryfile.min.js"}