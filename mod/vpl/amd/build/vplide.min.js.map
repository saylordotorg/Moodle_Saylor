{"version":3,"file":"vplide.min.js","sources":["../src/vplide.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * IDE Control\n *\n * @copyright 2017 Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\n/* globals MathJax */\n\ndefine(\n    [\n        'jquery',\n        'jqueryui',\n        'mod_vpl/vplutil',\n        'mod_vpl/vplidefile',\n        'mod_vpl/vplidebutton',\n        'mod_vpl/vplterminal',\n        'mod_vpl/vplvnc',\n    ],\n    function($, jqui, VPLUtil, VPLFile, VPLIDEButtons, VPLTerminal, VPLVNCClient) {\n        if (typeof VPLIDE !== 'undefined') {\n            return VPLIDE;\n        }\n        var vplIdeInstance;\n        var VPLIDE = function(rootId, options) {\n            var self = this;\n            var fileManager;\n            var adjustTabsTitles;\n            var autoResizeTab;\n            var showErrorMessage;\n            var updateMenu;\n            var executionActions;\n            var minNumberOfFiles = options.minfiles || 0;\n            var maxNumberOfFiles = options.maxfiles || 0;\n            var restrictedEdit = options.restrictededitor || options.example;\n            var readOnly = options.example;\n            var isTeacher = options.isTeacher;\n            var fullScreen = false;\n            var scrollBarWidth = VPLUtil.scrollBarWidth();\n            var str = VPLUtil.str;\n            var rootObj = $('#' + rootId);\n            $(\"head\").append('<meta name=\"viewport\" content=\"initial-scale=1\">')\n                          .append('<meta name=\"viewport\" width=\"device-width\">')\n                          .append('<link rel=\"stylesheet\" href=\"../editor/VPLIDE.css\"/>');\n            if (typeof rootObj != 'object') {\n                throw new Error(\"VPL: constructor tag_id not found\");\n            }\n            var optionsToCheck = {\n                'new': true,\n                'rename': true,\n                'delete': true,\n                'save': true,\n                'run': true,\n                'edit': true,\n                'debug': true,\n                'evaluate': true,\n                'import': true,\n                'resetfiles': true,\n                'sort': true,\n                'multidelete': true,\n                'acetheme': true,\n                'console': true,\n                'comments': true\n            };\n            if ((typeof options.loadajaxurl) == 'undefined') {\n                options.loadajaxurl = options.ajaxurl;\n            }\n            (function() {\n                var activateModification = (minNumberOfFiles < maxNumberOfFiles);\n                options.new = activateModification;\n                options.rename = activateModification;\n                options.delete = activateModification;\n                options.comments = options.comments && !options.example;\n                options.acetheme = true;\n            })();\n            options.sort = (maxNumberOfFiles - minNumberOfFiles >= 2);\n            options.multidelete = options.sort;\n            options.import = !restrictedEdit;\n            var isOptionAllowed = function(op) {\n                if (!optionsToCheck[op]) {\n                    return true;\n                }\n                return options[op];\n            };\n            options.console = isOptionAllowed('run') || isOptionAllowed('debug');\n            if ((typeof options.fontSize) == 'undefined') {\n                options.fontSize = 12;\n            }\n            options.fontSize = parseInt(options.fontSize);\n            /**\n             * Handler for dragover event.\n             * @param {object} e event.\n             */\n            function dragoverHandler(e) {\n                if (restrictedEdit) {\n                    e.originalEvent.dataTransfer.dropEffect = 'none';\n                } else {\n                    e.originalEvent.dataTransfer.dropEffect = 'copy';\n                }\n                e.preventDefault();\n            }\n            /**\n             * Handler for drop event.\n             * @param {object} e event.\n             * @returns {boolean}\n             */\n            function dropHandler(e) {\n                if (restrictedEdit) { // No drop allowed.\n                    e.stopImmediatePropagation();\n                    return false;\n                }\n                var dt = e.originalEvent.dataTransfer;\n                // Drop files.\n                if (dt.files.length > 0) {\n                    VPLUtil.readSelectedFiles(dt.files, function(file) {\n                        return fileManager.addFile(file, true, updateMenu, showErrorMessage);\n                    },\n                    function() {\n                        fileManager.fileListVisibleIfNeeded();\n                    });\n                    e.stopImmediatePropagation();\n                    return false;\n                }\n                return false;\n            }\n            rootObj.on('drop', dropHandler);\n            rootObj.on('dragover', dragoverHandler);\n            /**\n             * Handler for paste limited by restrictedEdit var.\n             * @param {object} e event.\n             * @returns {boolean}\n             */\n            function restrictedPaste(e) {\n                if (restrictedEdit) {\n                    e.stopPropagation();\n                    return false;\n                }\n                return true;\n            }\n            // Init editor vars.\n            var menu = $('#vpl_menu');\n            var menuButtons = new VPLIDEButtons(menu, isOptionAllowed);\n            var tr = $('#vpl_tr');\n            var fileListContainer = $('#vpl_filelist');\n            var fileList = $('#vpl_filelist_header');\n            var fileListContent = $('#vpl_filelist_content');\n            var tabsUl = $('#vpl_tabs_ul');\n            var tabs = $('#vpl_tabs');\n            var resultContainer = $('#vpl_results');\n            var result = $('#vpl_results_accordion');\n            fileListContainer.vplMinWidth = 80;\n            resultContainer.vplMinWidth = 100;\n            /**\n             * Avoids selecting grade.\n             * @param {object} event Unuse.\n             * @param {object} ui UI origen.\n             * @returns {boolean}\n             */\n            function avoidSelectGrade(event, ui) {\n                if (\"newHeader\" in ui) {\n                    if (ui.newHeader.hasClass('vpl_ide_accordion_t_grade')) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            /**\n             * Constructor of FileManager objects\n             */\n            function FileManager() {\n                var tabsUl = $('#vpl_tabs_ul');\n                $('#vpl_tabs').tabs();\n                var tabs = $('#vpl_tabs').tabs(\"widget\");\n                var files = [];\n                var openFiles = [];\n                var modified = true;\n                var self = this;\n                (function() {\n                    var version;\n                    self.setVersion = function(v) {\n                       version = v;\n                    };\n                    self.getVersion = function() {\n                       return version;\n                    };\n                })();\n                this.updateFileList = function() {\n                    self.generateFileList();\n                };\n                this.fileNameExists = function(name) {\n                    var checkName = name.toLowerCase();\n                    for (var i = 0; i < files.length; i++) {\n                        if (files[i].getFileName().toLowerCase() == checkName) {\n                            return i;\n                        }\n                    }\n                    return -1;\n                };\n                /**\n                 * Checks if name is included in current files names\n                 * @param {string} name Name of file\n                 * @returns {boolean} if found or not found\n                 */\n                function fileNameIncluded(name) {\n                    var checkName = name.toLowerCase() + '/';\n                    for (var i = 0; i < files.length; i++) {\n                        var nameMod = files[i].getFileName().toLowerCase() + '/';\n                        // Check for name as directory existent.\n                        if (nameMod.indexOf(checkName) === 0 || checkName.indexOf(nameMod) === 0) {\n                            return true;\n                        }\n                    }\n                    return false;\n                }\n                /**\n                 * Checks if changing file name results in two blovkly files\n                 * @param {string} oldname The old file name\n                 * @param {string} newname The new file name\n                 * @returns {boolean} if results two two blovkly files\n                 */\n                function twoBlockly(oldname, newname) {\n                    if (VPLUtil.isBlockly(oldname)) {\n                        return false;\n                    }\n                    if (VPLUtil.isBlockly(newname)) {\n                        for (var i = 0; i < files.length; i++) {\n                            if (VPLUtil.isBlockly(files[i].getFileName())) {\n                                return true;\n                            }\n                        }\n                    }\n                    return false;\n                }\n                this.restrictedPaste = restrictedPaste;\n                this.dropHandler = dropHandler;\n                this.dragoverHandler = dragoverHandler;\n                this.readOnly = readOnly;\n                this.restrictedEdit = restrictedEdit;\n                this.adjustTabsTitles = adjustTabsTitles;\n                this.minNumberOfFiles = minNumberOfFiles;\n                this.scrollBarWidth = scrollBarWidth;\n                var localClipboard = \"\";\n                this.setClipboard = function(t) {\n                    localClipboard = t;\n                };\n                this.getClipboard = function() {\n                    return localClipboard;\n                };\n                this.getTabPos = function(file) {\n                    for (var i = 0; i < openFiles.length; i++) {\n                        if (openFiles[i] == file) {\n                            return i;\n                        }\n                    }\n                    return openFiles.length;\n                };\n                this.getTheme = function() {\n                    return options.theme;\n                };\n                this.setTheme = function(theme) {\n                    options.theme = theme;\n                    for (var i = 0; i < files.length; i++) {\n                        files[i].setTheme(theme);\n                    }\n                };\n                this.addTab = function(fid) {\n                    var hlink = '<a href=\"#vpl_file' + fid + '\"></a>';\n                    tabsUl.append('<li id=\"vpl_tab_name' + fid + '\">' + hlink + '</li>');\n                    tabs.append('<div id=\"vpl_file' + fid + '\" class=\"vpl_ide_file\"></div>');\n                };\n                this.removeTab = function(fid) {\n                    tabsUl.find('#vpl_tab_name' + fid).remove();\n                    tabs.find('#vpl_file' + fid).remove();\n                };\n                this.open = function(pos) {\n                    var file;\n                    if (typeof pos == 'object') {\n                        file = pos;\n                    } else {\n                        file = files[pos];\n                    }\n                    if (file.isOpen()) {\n                        return;\n                    }\n                    var fid = file.getId();\n                    self.addTab(fid);\n                    openFiles.push(file);\n                    menuButtons.setGetkeys(file.open());\n                    tabs.tabs('refresh');\n                    adjustTabsTitles(false);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    VPLUtil.delay('updateMenu', updateMenu);\n                };\n                this.close = function(file) {\n                    if (!file.isOpen()) {\n                        return;\n                    }\n                    var pos;\n                    var fid = file.getId();\n                    file.close();\n                    self.removeTab(fid);\n                    var ptab = self.getTabPos(file);\n                    openFiles.splice(ptab, 1);\n                    tabs.tabs('refresh');\n                    adjustTabsTitles(false);\n                    self.fileListVisible(true);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    VPLUtil.delay('adjustTabsTitles', adjustTabsTitles, false);\n                    if (openFiles.length > ptab) {\n                        pos = self.getFilePosById(openFiles[ptab].getId());\n                        self.gotoFile(pos, 'c');\n                        return;\n                    }\n                    if (ptab > 0) {\n                        pos = self.getFilePosById(openFiles[ptab - 1].getId());\n                        self.gotoFile(pos, 'c');\n                        return;\n                    }\n                };\n                this.isClosed = function(pos) {\n                    return !files[pos].isOpen();\n                };\n                this.fileListVisible = function(b) {\n                    if (b === fileListContainer.vplVisible) {\n                        return;\n                    }\n                    if (b) {\n                        VPLUtil.delay('fileListVisible', function() {\n                            fileListContainer.vplVisible = true;\n                            self.updateFileList();\n                            fileListContainer.show();\n                            autoResizeTab();\n                         });\n                    } else {\n                        VPLUtil.delay('fileListVisible', function() {\n                            fileListContainer.vplVisible = false;\n                            fileListContainer.hide();\n                            autoResizeTab();\n                         });\n                    }\n                };\n                this.isFileListVisible = function() {\n                    return fileListContainer.vplVisible;\n                };\n                this.fileListVisibleIfNeeded = function() {\n                    if (this.isFileListVisible()) {\n                        return;\n                    }\n                    for (var i = 0; i < files.length; i++) {\n                        if (!files[i].isOpen()) {\n                            this.fileListVisible(true);\n                            return;\n                        }\n                    }\n                };\n                this.setFontSize = function(size) {\n                    options.fontSize = size;\n                    for (var i = 0; i < files.length; i++) {\n                        files[i].setFontSize(size);\n                    }\n                    terminal.setFontSize(size);\n                };\n                this.getFontSize = function() {\n                    return options.fontSize;\n                };\n                this.addFile = function(file, replace, ok, showError) {\n                    if ((typeof file.name != 'string') || !VPLUtil.validPath(file.name)) {\n                        showError(str('incorrect_file_name') + ' (' + file.name + ')');\n                        return false;\n                    }\n                    if (replace !== true) {\n                        replace = false;\n                    }\n                    var pos = this.fileNameExists(file.name);\n                    if (pos != -1) {\n                        if (replace) {\n                            files[pos].setContent(file.contents);\n                            self.setModified();\n                            ok();\n                            VPLUtil.delay('updateFileList', self.updateFileList);\n                            return file;\n                        } else {\n                            showError(str('filenotadded', file.name));\n                            return false;\n                        }\n                    }\n                    if (fileNameIncluded(file.name) || twoBlockly('', file.name)) {\n                        showError(str('filenotadded', file.name));\n                        return false;\n                    }\n                    if (files.length >= maxNumberOfFiles) {\n                        showError(str('maxfilesexceeded') + ' (' + maxNumberOfFiles + ')');\n                        return false;\n                    }\n                    var fid = VPLUtil.getUniqueId();\n                    var newfile = new VPLFile(fid, file.name, file.contents, this, vplIdeInstance);\n                    if (file.encoding == 1) {\n                        newfile.extendToBinary();\n                    } else {\n                        if (VPLUtil.isBlockly(file.name)) {\n                            newfile.extendToBlockly();\n                        } else {\n                            newfile.extendToCodeEditor();\n                        }\n                    }\n                    newfile.setFileName(file.name);\n                    files.push(newfile);\n                    self.setModified();\n                    if (files.length > 5) {\n                        self.fileListVisible(true);\n                    }\n                    ok();\n                    return newfile;\n                };\n                this.renameFile = function(oldname, newname, showError) {\n                    var pos = this.fileNameExists(oldname);\n                    try {\n                        if (pos == -1) {\n                            throw new Error(\"Internal error: File name not found\");\n                        }\n                        if (pos < minNumberOfFiles) {\n                            throw new Error(\"Internal error: Renaming requested filename\");\n                        }\n                        if (files[pos].getFileName() == newname) {\n                            return true; // Equals name file.\n                        }\n                        if (!VPLUtil.validPath(newname) ||\n                               fileNameIncluded(newname) ||\n                               twoBlockly(oldname, newname)) {\n                            throw str('incorrect_file_name');\n                        }\n                        if (VPLUtil.isBinary(oldname) && VPLUtil.fileExtension(oldname) != VPLUtil.fileExtension(newname)) {\n                            throw str('incorrect_file_name');\n                        }\n                        if (VPLUtil.isBlockly(oldname) != VPLUtil.isBlockly(newname)) {\n                            if (files[pos].getContent() > '') {\n                                showMessage(str('delete_file_fq', oldname), {\n                                    ok: function() {\n                                        var file = {\n                                            name: newname,\n                                            contents: '',\n                                            encoding: 0\n                                        };\n                                        fileManager.deleteFile(oldname, showError);\n                                        var fileResult = fileManager.addFile(file, false, updateMenu, showErrorMessage);\n                                        if (fileResult) {\n                                            fileManager.gotoFileName(newname);\n                                        }\n                                    }\n                                });\n                            } else {\n                                var file = {\n                                    name: newname,\n                                    contents: '',\n                                    encoding: 0\n                                };\n                                fileManager.deleteFile(oldname, showError);\n                                var fileResult = fileManager.addFile(file, false, updateMenu, showError);\n                                if (fileResult) {\n                                    fileManager.gotoFileName(newname);\n                                }\n                            }\n                            return true;\n                        }\n                        files[pos].setFileName(newname);\n                    } catch (e) {\n                        showError(str('filenotrenamed', newname) + ': ' + e);\n                        return false;\n                    }\n                    self.setModified();\n                    adjustTabsTitles(false);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    return true;\n                };\n                this.deleteFile = function(name, showError) {\n                    var pos = this.fileNameExists(name);\n                    if (pos == -1) {\n                        showError(str('filenotdeleted', name));\n                        return false;\n                    }\n                    if (pos < minNumberOfFiles) {\n                        showError(str('filenotdeleted', name));\n                        return false;\n                    }\n                    self.setModified();\n                    self.close(files[pos]);\n                    files.splice(pos, 1);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    return true;\n                };\n                this.currentFile = function() {\n                    var id = tabs.tabs('option', 'active');\n                    if (id in openFiles) {\n                        var file = openFiles[id];\n                        if (arguments.length === 0) {\n                            return file;\n                        }\n                        var action = arguments[0];\n                        if (typeof file[action] === 'function') {\n                            var fun = file[action];\n                            var args = Array.prototype.slice(arguments);\n                            args.shift();\n                            return fun.apply(file, args);\n                        }\n                    }\n                    return false;\n                };\n                this.currentPos = function() {\n                    return tabs.tabs('option', 'active');\n                };\n                this.getFileTab = function(id) {\n                    for (var i = 0; i < openFiles.length; i++) {\n                        if (openFiles[i].getId() == id) {\n                            return i;\n                        }\n                    }\n                    return -1;\n                };\n                this.getFilePosById = function(id) {\n                    for (var i = 0; i < files.length; i++) {\n                        if (files[i].getId() == id) {\n                            return i;\n                        }\n                    }\n                    return -1;\n                };\n                this.gotoFile = function(pos, l) {\n                    var file = files[pos];\n                    self.open(file);\n                    tabs.tabs('option', 'active', self.getFileTab(file.getId()));\n                    if (l !== 'c') {\n                        file.gotoLine(parseInt(l, 10));\n                    }\n                    file.focus();\n                };\n                this.gotoFileLink = function(a) {\n                    var tag = $(a);\n                    var fname = tag.data('file');\n                    var fpos = -1;\n                    if (fname > '') {\n                        fpos = this.fileNameExists(fname);\n                    } else {\n                        fpos = self.getFilePosById(tag.data('fileid'));\n                    }\n                    if (fpos >= 0) {\n                        var line = tag.data('line');\n                        if (typeof line == 'undefined') {\n                            line = 'c';\n                        }\n                        self.gotoFile(fpos, line);\n                        return true;\n                    }\n                    return false;\n                };\n                this.gotoFileName = function(fname, line) {\n                    var fpos = this.fileNameExists(fname);\n                    if (fpos >= 0) {\n                        if (typeof line == 'undefined') {\n                            line = 'c';\n                        }\n                        self.gotoFile(fpos, line);\n                        return true;\n                    }\n                    return false;\n                };\n                this.getFilesToSave = function() {\n                    var ret = [];\n                    for (var i = 0; i < files.length; i++) {\n                        var file = {};\n                        file.name = files[i].getFileName();\n                        file.contents = files[i].getContent();\n                        file.encoding = files[i].isBinary() ? 1 : 0;\n                        ret.push(file);\n                    }\n                    return ret;\n                };\n                this.resetModified = function() {\n                    modified = false;\n                    for (var i = 0; i < files.length; i++) {\n                        files[i].resetModified();\n                    }\n                    VPLUtil.delay('updateMenu', updateMenu);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                };\n                this.setModified = function() {\n                    modified = true;\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    VPLUtil.delay('updateMenu', updateMenu);\n                };\n                this.isModified = function() {\n                    return modified;\n                };\n                this.length = function() {\n                    return files.length;\n                };\n                this.clearAnnotations = function() {\n                    for (var i = 0; i < files.length; i++) {\n                        files[i].clearAnnotations();\n                    }\n                };\n                this.getFile = function(i) {\n                    return files[i];\n                };\n                this.getFiles = function() {\n                    return files;\n                };\n                this.getDirectoryStructure = function() {\n                    var structure = {\n                        isDir: true,\n                        content: {}\n                    };\n                    /**\n                     * Adds a new file the structure of directories\n                     * @param {int} i Index of file to add in the file array\n                     */\n                    function addFilePath(i) {\n                        var file = files[i];\n                        var fileName = file.getFileName();\n                        var path = fileName.split(\"/\");\n                        var curdir = structure;\n                        for (var p in path) {\n                            if (path.hasOwnProperty(p)) {\n                                var part = path[p];\n                                if (p == path.length - 1) { // File.\n                                    curdir.content[part] = {\n                                        isDir: false,\n                                        content: file,\n                                        pos: i\n                                    };\n                                } else {\n                                    if (!curdir.content[part]) { // New dir.\n                                        curdir.content[part] = {\n                                            isDir: true,\n                                            content: {}\n                                        };\n                                    }\n                                    // Descend Dir.\n                                    curdir = curdir.content[part];\n                                }\n                            }\n                        }\n                    }\n                    for (var i in files) {\n                        if (files.hasOwnProperty(i)) {\n                            addFilePath(i);\n                        }\n                    }\n                    return structure;\n                };\n                this.generateFileList = function() {\n                    if (!self.isFileListVisible()) {\n                        return;\n                    }\n                    var dirIndent = '<span class=\"vpl_ide_dirindent\"></span>';\n                    /**\n                     * Generates an array of string with the HTML code to represent the list of IDE files\n                     * @param {Object} dir Current directory\n                     * @param {int} indent Html code to indent subdirectories\n                     * @param {Array} lines Output. Each line contains the HTML to represent an IDE file\n                     */\n                    function lister(dir, indent, lines) {\n                        for (var name in dir.content) {\n                            if (dir.content.hasOwnProperty(name)) {\n                                var fd = dir.content[name];\n                                if (fd.isDir) {\n                                    lines.push(indent + VPLUtil.iconFolder() + VPLUtil.sanitizeText(name));\n                                    lister(fd, indent + dirIndent, lines);\n                                } else {\n                                    var file = fd.content;\n                                    var sname = VPLUtil.sanitizeText(name);\n                                    var path = VPLUtil.sanitizeText(file.getFileName());\n                                    if (file.isOpen()) {\n                                        sname = '<b>' + sname + '</b>';\n                                    }\n                                    var attrs = 'href=\"#\" data-fileid=\"' + file.getId() + '\" title=\"' + path + '\"';\n                                    var line = '<a ' + attrs + '>' + sname + '</a>';\n                                    if (file.isModified()) {\n                                        line = VPLUtil.iconModified() + line;\n                                    }\n                                    if (fd.pos < minNumberOfFiles) {\n                                        line = line + VPLUtil.iconRequired();\n                                    }\n                                    lines.push(indent + line);\n                                }\n                            }\n                        }\n                    }\n\n                    var structure = self.getDirectoryStructure();\n                    var lines = [];\n                    var html = '';\n                    lister(structure, '', lines);\n                    for (var i = 0; i < lines.length; i++) {\n                        html += lines[i] + '<br>';\n                    }\n                    fileListContent.html('<div>' + html + '</div>');\n                };\n                tabsUl.on('click', 'span.vpl_ide_closeicon', function() {\n                    fileManager.close(fileManager.currentFile());\n                });\n                tabsUl.on('dblclick', 'span.vpl_ide_closeicon', menuButtons.getAction('delete'));\n                tabsUl.on('dblclick', 'a', menuButtons.getAction('rename'));\n                fileListContent.on('dblclick', 'a', menuButtons.getAction('rename'));\n\n            }\n            this.updateEvaluationNumber = function(res) {\n                if (typeof res.nevaluations != 'undefined') {\n                    var text = res.nevaluations;\n                    if (typeof res.reductionbyevaluation != 'undefined'\n                         && res.reductionbyevaluation > ''\n                         && res.reductionbyevaluation != 0) {\n                        if (res.freeevaluations != 0) {\n                            text = text + '/' + res.freeevaluations;\n                        }\n                        text = text + ' -' + res.reductionbyevaluation;\n                    }\n                    menuButtons.setExtracontent('evaluate', text);\n                }\n            };\n            this.lastResult = null;\n            this.getTerminal = function() {\n                return terminal;\n            };\n            this.setResultGrade = function(content, raw) {\n                var name = 'grade';\n                var titleclass = 'vpl_ide_accordion_t_' + name;\n                var contentclass = 'vpl_ide_accordion_c_' + name;\n                if (result.find('.' + contentclass).length == 0) {\n                    result.append('<div class=\"' + titleclass + '\"></div>');\n                    result.append('<div class=\"' + contentclass + '\"></div>');\n                }\n                if (typeof raw == 'undefined') {\n                    return result.find('h4.' + titleclass).length > 0;\n                }\n                var titleTag = result.find('.' + titleclass);\n                if (content > '') {\n                    titleTag.replaceWith('<h4 class=\"' + titleclass + '\">' + content + '</h4>');\n                    return true;\n                } else {\n                    titleTag.replaceWith('<div class=\"' + titleclass + '\"></div>');\n                    return false;\n                }\n            };\n            this.setResultTab = function(name, content, raw) {\n                var titleclass = 'vpl_ide_accordion_t_' + name;\n                var contentclass = 'vpl_ide_accordion_c_' + name;\n                if (result.find('.' + contentclass).length == 0) {\n                    result.append('<div class=\"' + titleclass + '\"></div>');\n                    result.append('<div class=\"' + contentclass + '\"></div>');\n                }\n                if (typeof raw == 'undefined') {\n                    return result.find('h4.' + titleclass).length > 0;\n                }\n                var titleTag = result.find('.' + titleclass);\n                var contentTag = result.find('.' + contentclass);\n                var HTMLcontent = $('<div>' + content + '</div>');\n                HTMLcontent.find('h4').replaceWith(function() {\n                    return $(\"<h5>\").append($(this).contents());\n                });\n                if (contentTag.html() == HTMLcontent.html()) {\n                    return content > '';\n                }\n                if (content > '') {\n                    titleTag.replaceWith('<h4 class=\"' + titleclass + '\">' + str(name) + '</h4>');\n                    contentTag.replaceWith('<div class=\"ui-widget ' + contentclass + '\">' + HTMLcontent.html() + '</div>');\n                    return true;\n                } else {\n                    titleTag.replaceWith('<div class=\"' + titleclass + '\"></div>');\n                    contentTag.replaceWith('<div class=\"' + contentclass + '\"></div>');\n                    return false;\n                }\n            };\n            this.setResult = function(res, go) {\n                self.updateEvaluationNumber(res);\n                var files = fileManager.getFiles();\n                var fileNames = [];\n                var i;\n                for (i = 0; i < files.length; i++) {\n                    fileNames[i] = files[i].getFileName();\n                    files[i].clearAnnotations();\n                }\n                var show = false;\n                var hasContent;\n                var grade = VPLUtil.sanitizeText(res.grade);\n                var gradeShow;\n                var formated;\n                gradeShow = self.setResultGrade(grade, res.grade);\n                show = show || gradeShow;\n                hasContent = self.setResultTab('variables', res.variables, res.variables);\n                show = show || hasContent;\n                formated = VPLUtil.processResult(res.compilation, fileNames, files, true, false);\n                hasContent = self.setResultTab('compilation', formated, res.compilation);\n                show = show || hasContent;\n                formated = VPLUtil.processResult(res.evaluation, fileNames, files, false, false);\n                hasContent = self.setResultTab('comments', formated, res.evaluation);\n                show = show || hasContent;\n                formated = VPLUtil.sanitizeText(res.execution);\n                hasContent = self.setResultTab('execution', formated, res.execution);\n                show = show || hasContent;\n                hasContent = self.setResultTab('description', window.VPLDescription, window.VPLDescription);\n                if (hasContent && typeof MathJax == 'object') { // MathJax workaround.\n                    var math = result.find(\".vpl_ide_accordion_c_description\")[0];\n                    MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, math]);\n                }\n                show = show || hasContent;\n                if (show) {\n                    resultContainer.show();\n                    resultContainer.vplVisible = true;\n                    result.accordion(\"refresh\");\n                    result.accordion('option', 'active', gradeShow ? 1 : 0);\n                    for (i = 0; i < files.length; i++) {\n                        var anot = files[i].getAnnotations();\n                        for (var j = 0; j < anot.length; j++) {\n                            if (go || anot[j].type == 'error') {\n                                fileManager.gotoFile(i, anot[j].row + 1);\n                                break;\n                            }\n                        }\n                    }\n                    $('#vpl_ide_rightpanel').show();\n                } else {\n                    resultContainer.hide();\n                    resultContainer.vplVisible = false;\n                    $('#vpl_ide_rightpanel').hide();\n                }\n                VPLUtil.delay('autoResizeTab', autoResizeTab);\n            };\n\n            result.accordion({\n                heightStyle: 'fill',\n                header: 'h4',\n                animate: false,\n                beforeActivate: avoidSelectGrade,\n            });\n            resultContainer.width(2 * resultContainer.vplMinWidth);\n            result.on('click', 'a', function(event) {\n                if (fileManager.gotoFileLink(event.currentTarget)) {\n                    event.preventDefault();\n                }\n            });\n            resultContainer.vplVisible = false;\n            resultContainer.hide();\n\n            fileListContainer.addClass('ui-tabs ui-widget ui-widget-content ui-corner-all');\n            fileList.text(str('filelist'));\n            fileList.html(VPLUtil.iconFolder() + fileList.html());\n            fileList.addClass(\"ui-widget-header ui-button-text-only ui-corner-all\");\n            fileListContent.addClass(\"ui-widget ui-corner-all\");\n            fileListContainer.width(2 * fileListContainer.vplMinWidth);\n            fileListContainer.on('click', 'a', function(event) {\n                event.preventDefault();\n                fileManager.gotoFileLink(event.currentTarget);\n            });\n            fileListContainer.vplVisible = false;\n            fileListContainer.hide();\n            var tabsAir = false;\n            /**\n             * Returns separation space\n             * @returns {int} size in pixels\n             */\n            function getTabsAir() {\n                if (tabsAir === false) {\n                    tabsAir = (tabs.outerWidth(true) - tabs.width()) / 2;\n                }\n                return tabsAir;\n            }\n            /**\n             * Resize tab width\n             * @param {Event} e Unused\n             * @param {Object} ui UI object\n             */\n            function resizeTabWidth(e, ui) {\n                var diffLeft = ui.position.left - ui.originalPosition.left;\n                var maxWidth;\n                if (diffLeft !== 0) {\n                    maxWidth = tabs.width() + fileListContainer.width() - fileListContainer.vplMinWidth;\n                    tabs.resizable('option', 'maxWidth', maxWidth);\n                    fileListContainer.width(fileListContainer.vplOriginalWidth + diffLeft);\n                } else {\n                    maxWidth = tabs.width() + resultContainer.width() - resultContainer.vplMinWidth;\n                    tabs.resizable('option', 'maxWidth', maxWidth);\n                    var diffWidth = ui.size.width - ui.originalSize.width;\n                    resultContainer.width(resultContainer.vplOriginalWidth - diffWidth);\n                }\n                fileManager.currentFile('adjustSize');\n            }\n            var resizableOptions = {\n                containment: 'parent',\n                resize: resizeTabWidth,\n                start: function() {\n                    $(window).off('resize', autoResizeTab);\n                    tabs.resizable('option', 'minWidth', 100);\n                    if (resultContainer.vplVisible) {\n                        resultContainer.vplOriginalWidth = resultContainer.width();\n                    }\n                    if (fileListContainer.vplVisible) {\n                        fileListContainer.vplOriginalWidth = fileListContainer.width();\n                    }\n                },\n                stop: function(e, ui) {\n                    resizeTabWidth(e, ui);\n                    tabs.resizable('option', 'maxWidth', 100000);\n                    tabs.resizable('option', 'minWidth', 0);\n                    autoResizeTab();\n                    $(window).on('resize', autoResizeTab);\n                },\n                handles: \"\"\n            };\n            tabs.resizable(resizableOptions);\n             /**\n              * Updates handles for internal IDE resize\n              */\n            function updateTabsHandles() {\n                var handles = ['e', 'w', 'e', 'e, w'];\n                var index = 0;\n                index += fileListContainer.vplVisible ? 1 : 0;\n                index += resultContainer.vplVisible ? 2 : 0;\n                tabs.resizable('destroy');\n                resizableOptions.handles = handles[index];\n                resizableOptions.disable = index === 0;\n                tabs.resizable(resizableOptions);\n            }\n            /**\n             * Resize the IDE height\n             */\n            function resizeHeight() {\n                var newHeight = $(window).outerHeight();\n                newHeight -= menu.offset().top + menu.height() + (fullScreen ? getTabsAir() : 20);\n                if (newHeight < 150) {\n                    newHeight = 150;\n                }\n                tr.height(newHeight);\n                var panelHeight = newHeight - 3 * getTabsAir();\n                tabs.height(panelHeight);\n                if (resultContainer.vplVisible) {\n                    resultContainer.height(panelHeight + getTabsAir());\n                    result.accordion('refresh');\n                }\n                if (fileListContainer.vplVisible) {\n                    fileListContent.height(panelHeight - (fileList.outerHeight() + getTabsAir()));\n                    fileListContainer.height(panelHeight);\n                }\n            }\n            adjustTabsTitles = function(center) {\n                var newWidth = tabs.width();\n                var tabsUlWidth = 0;\n                tabsUl.width(100000);\n                var last = tabsUl.children('li:visible').last();\n                if (last.length) {\n                    var parentScrollLeft = tabsUl.parent().scrollLeft();\n                    tabsUlWidth = parentScrollLeft + last.position().left + last.width() + tabsAir;\n                    tabsUl.width(tabsUlWidth);\n                    var file = fileManager.currentFile();\n                    if (file && center) {\n                        var fileTab = $(file.getTabNameId());\n                        var scroll = parentScrollLeft + fileTab.position().left;\n                        scroll -= (newWidth - fileTab.outerWidth()) / 2;\n                        if (scroll < 0) {\n                            scroll = 0;\n                        }\n                        tabsUl.parent().finish().animate({\n                            scrollLeft: scroll\n                        }, 'slow');\n                    }\n                }\n                if (tabsUlWidth < newWidth) {\n                    tabsUl.width('');\n                }\n            };\n            autoResizeTab = function() {\n                var oldWidth = tabs.width();\n                var newWidth = menu.width();\n                var planb = false;\n                updateTabsHandles();\n                tr.width(menu.outerWidth());\n                if (fileListContainer.vplVisible) {\n                    var left = fileListContainer.outerWidth() + tabsAir;\n                    oldWidth += left;\n                    if (left >= 100) {\n                        newWidth -= left;\n                        tabs.css('left', left);\n                    } else {\n                        planb = true;\n                    }\n                } else {\n                    tabs.css('left', 0);\n                }\n                if (resultContainer.vplVisible) {\n                    var right = resultContainer.outerWidth() + tabsAir;\n                    oldWidth += right;\n                    newWidth -= right;\n                    if (newWidth < 100) {\n                        planb = true;\n                    }\n                }\n                if (planb) {\n                    var rel = menu.width() / oldWidth;\n                    var wfl = 0;\n                    if (fileListContainer.vplVisible) {\n                        wfl = fileListContainer.width() * rel;\n                        fileListContainer.width(wfl - tabsAir);\n                        wfl += tabsAir;\n                        tabs.css('left', wfl);\n                    }\n                    tabs.width(tabs.width() * rel);\n                    if (resultContainer.vplVisible) {\n                        resultContainer.width(menu.width() - (wfl + tabs.width() + tabsAir));\n                    }\n                } else {\n                    tabs.width(newWidth);\n                }\n                adjustTabsTitles(true);\n                resizeHeight();\n                fileManager.currentFile('adjustSize');\n            };\n            /**\n             * Transfer focus to current file\n             */\n            function focusCurrentFile() {\n                fileManager.currentFile('focus');\n            }\n            var dialogbaseOptions = $.extend({}, {\n                close: focusCurrentFile\n            }, VPLUtil.dialogbaseOptions);\n            /**\n             * Shows a dialog with a message.\n             * @param {string} message\n             * @param {Object} options icon, title, actions handler (ok, yes, no, close)\n             * @returns {JQuery} JQueryUI Dialog object already open\n             */\n            function showMessage(message, options) {\n                return VPLUtil.showMessage(message, $.extend({}, dialogbaseOptions, options));\n            }\n            showErrorMessage = function(message) {\n                return VPLUtil.showErrorMessage(message, {\n                    close: focusCurrentFile\n                });\n            };\n\n            var dialogNew = $('#vpl_ide_dialog_new');\n            /**\n             * The event handler for the new file action\n             * @param {Object} event\n             * @return {boolean}\n             */\n            function newFileHandler(event) {\n                if (!(event.type == 'click' || ((event.type == 'keypress') && event.keyCode == 13))) {\n                    return true;\n                }\n                dialogNew.dialog('close');\n                var file = {\n                    name: $('#vpl_ide_input_newfilename').val(),\n                    contents: '',\n                    encoding: 0\n                };\n                var newfile = fileManager.addFile(file, false, updateMenu, showErrorMessage);\n                if (newfile) {\n                    fileManager.open(newfile);\n                    tabs.tabs('option', 'active', fileManager.getTabPos(newfile));\n                    newfile.focus();\n                    return true;\n                }\n                return false;\n            }\n\n            var dialogButtons = {};\n            dialogButtons[str('ok')] = newFileHandler;\n            dialogButtons[str('cancel')] = function() {\n                $(this).dialog('close');\n            };\n            dialogNew.find('input').on('keypress', newFileHandler);\n            dialogNew.dialog($.extend({}, dialogbaseOptions, {\n                title: str('create_new_file'),\n                buttons: dialogButtons\n            }));\n            VPLUtil.setDialogTitleIcon(dialogNew, 'new');\n\n            var dialogRename = $('#vpl_ide_dialog_rename');\n            /**\n             * The event handler for the rename current file action\n             * @param {Object} event\n             */\n            function renameHandler(event) {\n                if (!(event.type == 'click' || ((event.type == 'keypress') && event.keyCode == 13))) {\n                    return;\n                }\n                dialogRename.dialog('close');\n                fileManager.renameFile(fileManager.currentFile('getFileName'),\n                        $('#vpl_ide_input_renamefilename').val(), showErrorMessage);\n                event.preventDefault();\n            }\n            dialogRename.find('input').on('keypress', renameHandler);\n            dialogButtons[str('ok')] = renameHandler;\n            dialogRename.dialog($.extend({}, dialogbaseOptions, {\n                open: function() {\n                    $('#vpl_ide_input_renamefilename').val(fileManager.currentFile('getFileName'));\n                },\n                title: str('rename_file'),\n                buttons: dialogButtons\n            }));\n            VPLUtil.setDialogTitleIcon(dialogRename, 'rename');\n\n            dialogButtons[str('ok')] = function() {\n                $(this).dialog('close');\n            };\n            var dialogComments = $('#vpl_ide_dialog_comments');\n            dialogComments.dialog($.extend({}, dialogbaseOptions, {\n                title: str('comments'),\n                width: '40em',\n                buttons: dialogButtons\n            }));\n            VPLUtil.setDialogTitleIcon(dialogComments, 'comments');\n\n            $('#vpl_ide_input_comments').width('30em');\n            var aboutDialog = $('#vpl_ide_dialog_about');\n            var OKButtons = {};\n            OKButtons[str('ok')] = function() {\n                $(this).dialog('close');\n            };\n            var shortcutDialog = $('#vpl_ide_dialog_shortcuts');\n            shortcutDialog.dialog($.extend({}, dialogbaseOptions, {\n                open: function() {\n                    var html = menuButtons.getShortcuts(fileManager.currentFile('getEditor'));\n                    $('#vpl_ide_dialog_shortcuts').html(html);\n                },\n                title: str('shortcuts'),\n                width: 400,\n                height: 300,\n                buttons: OKButtons\n            }));\n            shortcutDialog.dialog('option', 'height', 300);\n            VPLUtil.setDialogTitleIcon(shortcutDialog, 'shortcuts');\n\n            OKButtons[str('shortcuts')] = function() {\n                $(this).dialog('close');\n                shortcutDialog.dialog('open');\n            };\n            aboutDialog.dialog($.extend({}, dialogbaseOptions, {\n                open: function() {\n                    var html = menuButtons.getShortcuts(fileManager.currentFile('getEditor'));\n                    aboutDialog.next().find(\"button\").filter(\n                        function() {\n                            return $(this).text() == str('shortcuts');\n                        }\n                  ).button(html != '' ? 'enable' : 'disable');\n                },\n                title: str('about'),\n                width: 400,\n                height: 300,\n                buttons: OKButtons\n            }));\n            aboutDialog.dialog('option', 'height', 300);\n            VPLUtil.setDialogTitleIcon(aboutDialog, 'about');\n\n            var dialogSort = $('#vpl_ide_dialog_sort');\n            var dialogSortButtons = {};\n            dialogSortButtons[str('ok')] = function() {\n                var files = fileManager.getFiles();\n                var regNoNumber = /[^\\d]*/;\n                var sorted = [];\n                var i = 0;\n                var newOrder = $('#vpl_sort_list li');\n                if (newOrder.length != files.length) {\n                    return;\n                }\n                newOrder.each(function() {\n                    var orig = parseInt(this.id.replace(regNoNumber, ''));\n                    sorted.push(files[orig]);\n                });\n                for (i = 0; i < newOrder.length; i++) {\n                    files[i] = sorted[i];\n                }\n                fileManager.setModified();\n                $(this).dialog('close');\n            };\n            dialogSortButtons[str('cancel')] = function() {\n                $(this).dialog('close');\n            };\n            dialogSort.dialog($.extend({}, dialogbaseOptions, {\n                title: str('sort'),\n                buttons: dialogSortButtons,\n                open: function() {\n                    var list = $('#vpl_sort_list');\n                    list.html('');\n                    var files = fileManager.getFiles();\n                    for (var i = 0; i < files.length; i++) {\n                        var file = $('<li id=\"vpl_fsort_' + i + '\"class=\"ui-widget-content\"></li>');\n                        if (i < minNumberOfFiles) {\n                            file.addClass('ui-state-disabled');\n                        }\n                        file.text((i + 1) + '-' + files[i].getFileName());\n                        list.append(file);\n                    }\n                    list.sortable({\n                        items: \"li:not(.ui-state-disabled)\",\n                        placeholder: \"ui-state-highlight\",\n                        start: function(event, ui) {\n                            ui.item.addClass('ui-state-highlight');\n                        },\n                        stop: function(event, ui) {\n                            ui.item.removeClass('ui-state-highlight');\n                        },\n                    });\n                    list.disableSelection();\n                },\n                maxHeight: 400\n            }));\n            VPLUtil.setDialogTitleIcon(dialogSort, 'sort');\n\n            var dialogMultidelete = $('#vpl_ide_dialog_multidelete');\n            var dialogMultideleteButtons = {};\n            dialogMultideleteButtons[str('selectall')] = function() {\n                $(this).find('input').prop(\"checked\", true);\n            };\n            dialogMultideleteButtons[str('deselectall')] = function() {\n                $(this).find('input').prop(\"checked\", false);\n            };\n            dialogMultideleteButtons[str('deleteselected')] = function() {\n                var files = fileManager.getFiles();\n                var toDeleteList = [];\n                var labelList = $('#vpl_multidelete_list label');\n                labelList.each(function() {\n                    var label = $(this);\n                    if (label.find('input').prop('checked')) {\n                        var id = label.data('fileid');\n                        toDeleteList.push(files[id].getFileName());\n                    }\n                });\n                for (var i = 0; i < toDeleteList.length; i++) {\n                    fileManager.deleteFile(toDeleteList[i], showErrorMessage);\n                }\n                VPLUtil.delay('updateMenu', updateMenu);\n                VPLUtil.delay('updateFileList', fileManager.updateFileList);\n                $(this).dialog('close');\n            };\n            dialogMultideleteButtons[str('cancel')] = function() {\n                $(this).dialog('close');\n            };\n            dialogMultidelete.dialog($.extend({}, dialogbaseOptions, {\n                title: str('multidelete'),\n                buttons: dialogMultideleteButtons,\n                open: function() {\n                    var list = $('#vpl_multidelete_list');\n                    list.html('');\n                    var files = fileManager.getFiles();\n                    for (var i = minNumberOfFiles; i < files.length; i++) {\n                        var name = VPLUtil.sanitizeText(files[i].getFileName());\n                        var file = $('<label><input type=\"checkbox\"> ' + name + '</label>');\n                        file.data('fileid', i);\n                        list.append(file);\n                        list.append('<br>');\n                    }\n                    list.find('label').button();\n                },\n                maxHeight: 400,\n                maxWidth: 400\n            }));\n            VPLUtil.setDialogTitleIcon(dialogMultidelete, 'multidelete');\n\n            var dialogFontsize = $('#vpl_ide_dialog_fontsize');\n            var fontsizeSlider = $('#vpl_ide_dialog_fontsize .vpl_fontsize_slider');\n            var dialogFontFizeButtons = {};\n            dialogFontFizeButtons[str('ok')] = function() {\n                var value = fontsizeSlider.slider(\"value\");\n                fileManager.setFontSize(value);\n                $(this).dialog('close');\n                $.ajax({\n                    async: true,\n                    type: \"POST\",\n                    url: '../editor/userpreferences.json.php',\n                    'data': JSON.stringify({fontSize: value}),\n                    contentType: \"application/json; charset=utf-8\",\n                    dataType: \"json\"\n                });\n            };\n            dialogFontFizeButtons[str('cancel')] = function() {\n                fileManager.setFontSize(fontsizeSlider.data(\"vpl_fontsize\"));\n                $(this).dialog('close');\n            };\n            dialogFontFizeButtons[str('reset')] = function() {\n                fontsizeSlider.slider('value', 12);\n            };\n            dialogFontsize.dialog($.extend({}, dialogbaseOptions, {\n                title: str('fontsize'),\n                buttons: dialogFontFizeButtons,\n                open: function() {\n                    fontsizeSlider.data(\"vpl_fontsize\", fileManager.getFontSize());\n                    fontsizeSlider.slider('value', fileManager.getFontSize());\n                },\n            }));\n            fontsizeSlider.slider({\n                min: 1,\n                max: 48,\n                change: function() {\n                    var value = fontsizeSlider.slider(\"value\");\n                    fileManager.setFontSize(value);\n                    dialogFontsize.find('.vpl_fontsize_slider_value').text(value);\n                }\n            });\n            VPLUtil.setDialogTitleIcon(dialogFontsize, 'fontsize');\n\n            var dialogAceTheme = $('#vpl_ide_dialog_acetheme');\n            var acethemeSelect = $('#vpl_ide_dialog_acetheme select');\n            var dialogAceThemeButtons = {};\n            dialogAceThemeButtons[str('ok')] = function() {\n                fileManager.setTheme(acethemeSelect.val());\n                $(this).dialog('close');\n                VPLUtil.setUserPreferences({aceTheme: acethemeSelect.val()});\n            };\n            dialogAceThemeButtons[str('cancel')] = function() {\n                fileManager.setTheme(acethemeSelect.data(\"acetheme\"));\n                $(this).dialog('close');\n            };\n            dialogAceThemeButtons[str('reset')] = function() {\n                acethemeSelect.val(acethemeSelect.data(\"acetheme\"));\n                fileManager.setTheme(acethemeSelect.val());\n            };\n            dialogAceTheme.dialog($.extend({}, dialogbaseOptions, {\n                title: str('theme'),\n                buttons: dialogAceThemeButtons,\n                modal: false,\n                open: function() {\n                    acethemeSelect.data(\"acetheme\", fileManager.getTheme());\n                    acethemeSelect.val(fileManager.getTheme());\n                },\n            }));\n            acethemeSelect.on('change', function() {\n                    fileManager.setTheme(acethemeSelect.val());\n            });\n            VPLUtil.setDialogTitleIcon(dialogAceTheme, 'theme');\n\n            var terminal = new VPLTerminal('vpl_dialog_terminal', 'vpl_terminal', str);\n            var VNCClient = new VPLVNCClient('vpl_dialog_vnc', str);\n            var lastConsole = terminal;\n            var fileSelect = $('#vpl_ide_input_file');\n            var fileSelectHandler = function() {\n                VPLUtil.readSelectedFiles(this.files, function(file) {\n                    return fileManager.addFile(file, true, updateMenu, showErrorMessage);\n                },\n                function() {\n                    fileManager.fileListVisibleIfNeeded();\n                });\n            };\n            fileSelect.on('change', fileSelectHandler);\n            // Menu acctions.\n            menuButtons.add({\n                name: 'filelist',\n                originalAction: function() {\n                    fileManager.fileListVisible(!fileManager.isFileListVisible());\n                    VPLUtil.delay('updateMenu', updateMenu);\n                    VPLUtil.delay('autoResizeTab', autoResizeTab);\n                    VPLUtil.delay('updateFileList', fileManager.updateFileList);\n                },\n                bindKey: {\n                    win: 'Ctrl-L',\n                    mac: 'Ctrl-L'\n                }\n            });\n\n            menuButtons.add({\n                name: 'new',\n                originalAction: function() {\n                    if (fileManager.length() < maxNumberOfFiles) {\n                        dialogNew.dialog('open');\n                    }\n                },\n                bindKey: {\n                    win: 'Alt-N',\n                    mac: 'Option-N'\n                }\n            });\n            menuButtons.add({\n                name: 'rename',\n                originalAction: function() {\n                    var file = fileManager.currentFile();\n                    if (file && fileManager.getFilePosById(file.getId()) >= minNumberOfFiles) {\n                        dialogRename.dialog('open');\n                    }\n                },\n                bindKey: {\n                    win: 'Ctrl-R',\n                    mac: 'Ctrl-R'\n                }\n            });\n            menuButtons.add({\n                name: 'delete',\n                originalAction: function() {\n                    var file = fileManager.currentFile();\n                    if (!file) {\n                        return;\n                    }\n                    var filename = file.getFileName();\n                    var message = str('delete_file_fq', filename);\n                    showMessage(message, {\n                        ok: function() {\n                            fileManager.deleteFile(filename, showErrorMessage);\n                        },\n                        title: str('delete_file_q'),\n                        icon: 'trash'\n                    });\n                },\n                bindKey: {\n                    win: 'Ctrl-D',\n                    mac: 'Ctrl-D'\n                }\n            });\n            menuButtons.add({\n                name: 'close',\n                originalAction: function() {\n                    var file = fileManager.currentFile();\n                    if (!file) {\n                        return;\n                    }\n                    fileManager.close(file);\n                },\n                bindKey: {\n                    win: 'Alt-W',\n                    mac: 'Option-W'\n                }\n            });\n            menuButtons.add({\n                name: 'import',\n                originalAction: function() {\n                    fileSelect.val('');\n                    fileSelect.trigger('click');\n                },\n                bindKey: {\n                    win: 'Ctrl-I',\n                    mac: 'Ctrl-I'\n                }\n            });\n            menuButtons.add({\n                name: 'sort',\n                originalAction: function() {\n                    dialogSort.dialog('open');\n                },\n                bindKey: {\n                    win: 'Ctrl-O',\n                    mac: 'Ctrl-O'\n                }\n            });\n            menuButtons.add({\n                name: 'multidelete',\n                originalAction: function() {\n                    dialogMultidelete.dialog('open');\n                }\n            });\n            menuButtons.add({\n                name: 'fontsize',\n                originalAction: function() {\n                    dialogFontsize.dialog('open');\n                }\n            });\n            menuButtons.add({\n                name: 'theme',\n                originalAction: function() {\n                    dialogAceTheme.dialog('open');\n                }\n            });\n            menuButtons.add({\n                name: 'print',\n                originalAction: function() {\n                    window.print();\n                },\n                bindKey: {\n                    win: 'Alt-P',\n                    mac: 'Command-P'\n                }\n            });\n            menuButtons.add({\n                name: 'undo',\n                originalAction: function() {\n                    fileManager.currentFile('undo');\n                }\n            });\n            menuButtons.add({\n                name: 'redo',\n                originalAction: function() {\n                    fileManager.currentFile('redo');\n                }\n            });\n            menuButtons.add({\n                name: 'select_all',\n                editorName: 'selectall',\n                originalAction: function() {\n                    fileManager.currentFile('selectAll');\n                }\n            });\n            menuButtons.add({\n                name: 'find',\n                originalAction: function() {\n                    fileManager.currentFile('find');\n                }\n            });\n            menuButtons.add({\n                name: 'find_replace',\n                editorName: 'replace',\n                originalAction: function() {\n                    fileManager.currentFile('replace');\n                }\n            });\n            menuButtons.add({\n                name: 'next',\n                editorName: 'findnext',\n                originalAction: function() {\n                    fileManager.currentFile('next');\n                }\n            });\n            menuButtons.add({\n                name: 'fullscreen',\n                originalAction: function() {\n                    var tags = 'header, nav, footer, aside, .dropdown, #page-header, div.navbar, #nav-drawer';\n                    tags += ', div.tabtree, #dock, .breadcrumb-nav, .moodle-actionmenu';\n                    if (fullScreen) {\n                        rootObj.removeClass('vpl_ide_root_fullscreen');\n                        $('body').removeClass('vpl_body_fullscreen');\n                        menuButtons.setText('fullscreen', 'fullscreen');\n                        $(tags).show();\n                        $('#vpl_ide_user').hide();\n                        fullScreen = false;\n                    } else {\n                        $('body').addClass('vpl_body_fullscreen').scrollTop(0);\n                        $(tags).hide();\n                        rootObj.addClass('vpl_ide_root_fullscreen');\n                        menuButtons.setText('fullscreen', 'regularscreen');\n                        if (options.username) {\n                            $('#vpl_ide_user').show();\n                        }\n                        fullScreen = true;\n                    }\n                    focusCurrentFile();\n                    setTimeout(autoResizeTab, 10);\n                },\n                bindKey: {\n                    win: 'Alt-F',\n                    mac: 'Ctrl-F'\n                }\n            });\n            menuButtons.add({\n                name: 'download',\n                originalAction: function() {\n                    window.location = options.download;\n                }\n            });\n            /**\n             * Reset files action\n             */\n            function resetFiles() {\n                VPLUtil.requestAction('resetfiles', '', {}, options.ajaxurl)\n                .done(function(response) {\n                    var files = response.files;\n                    for (var fileName in files) {\n                        if (files.hasOwnProperty(fileName)) {\n                            fileManager.addFile(files[fileName], true, VPLUtil.doNothing, showErrorMessage);\n                        }\n                    }\n                    fileManager.fileListVisibleIfNeeded();\n                    VPLUtil.delay('updateMenu', updateMenu);\n                }).fail(showErrorMessage);\n            }\n            menuButtons.add({\n                name: 'resetfiles',\n                originalAction: function() {\n                    showMessage(str('sureresetfiles'), {\n                        title: str('resetfiles'),\n                        ok: resetFiles,\n                        icon: 'resetfiles'\n                    });\n                }\n            });\n            menuButtons.add({\n                name: 'save',\n                originalAction: function() {\n                    var data = {\n                        files: fileManager.getFilesToSave(),\n                        comments: $('#vpl_ide_input_comments').val(),\n                        version: fileManager.getVersion()\n                    };\n                    if (JSON.stringify(data).length > options.postMaxSize) {\n                        showErrorMessage(str('maxpostsizeexceeded'));\n                        return;\n                    }\n                    /**\n                     * Save action\n                     */\n                    function doSave() {\n                        VPLUtil.requestAction('save', 'saving', data, options.ajaxurl)\n                        .done(function(response) {\n                            if (response.requestsconfirmation) {\n                                showMessage(response.question, {\n                                    title: str('saving'),\n                                    icon: 'alert',\n                                    yes: function() {\n                                        data.version = response.version;\n                                        doSave();\n                                    }\n                                });\n                            } else {\n                                fileManager.resetModified();\n                                fileManager.setVersion(response.version);\n                                menuButtons.setTimeLeft(response);\n                                VPLUtil.delay('updateMenu', updateMenu);\n                                if (VPLUtil.monitorRunning()) {\n                                    data.processid = VPLUtil.getProcessId();\n                                    VPLUtil.requestAction('update', 'updating', data, options.ajaxurl);\n                                }\n                            }\n                        }).fail(showErrorMessage);\n                    }\n                    doSave();\n                },\n                bindKey: {\n                    win: 'Ctrl-S',\n                    mac: 'Command-S'\n                }\n            });\n\n            /**\n             * Launches the action\n             *\n             * @param {string} action Action 'run', 'debug', 'evaluate'\n             * @param {string} acting I18n for the action in progress\n             * @param {string} data Data attached to the action\n             */\n            function executionRequest(action, acting, data) {\n                if (!data) {\n                    data = {};\n                }\n                if (!lastConsole.isConnected()) {\n                    VPLUtil.requestAction(action, '', data, options.ajaxurl)\n                    .done(function(response) {\n                        VPLUtil.webSocketMonitor(response, action, acting, executionActions);\n                    })\n                    .fail(showErrorMessage);\n                }\n            }\n            /**\n             * Launches the run action\n             */\n            function runAction() {\n                executionRequest('run', 'running', {\n                    XGEOMETRY: VNCClient.getCanvasSize()\n                });\n            }\n            menuButtons.add({\n                name: 'run',\n                originalAction: function() {\n                    executionActions.setLastAction(runAction);\n                    runAction();\n                },\n                bindKey: {\n                    win: 'Ctrl-F11',\n                    mac: 'Command-U'\n                }\n            });\n            /**\n             * Launches the debug action\n             */\n            function debugAction() {\n                executionRequest('debug', 'debugging', {\n                    XGEOMETRY: VNCClient.getCanvasSize()\n                });\n            }\n            menuButtons.add({\n                name: 'debug',\n                originalAction: function() {\n                    executionActions.setLastAction(debugAction);\n                    debugAction();\n                },\n                bindKey: {\n                    win: 'Alt-F11',\n                    mac: 'Option-U'\n                }\n            });\n            /**\n             * Launches the evaluate action\n             */\n            function evaluateAction() {\n                executionRequest('evaluate', 'evaluating');\n            }\n            menuButtons.add({\n                name: 'evaluate',\n                originalAction: function() {\n                    executionActions.setLastAction(evaluateAction);\n                    evaluateAction();\n                },\n                bindKey: {\n                    win: 'Shift-F11',\n                    mac: 'Command-Option-U'\n                }\n            });\n            menuButtons.add({\n                name: 'comments',\n                originalAction: function() {\n                    dialogComments.dialog('open');\n                },\n            });\n            menuButtons.add({\n                name: 'console',\n                originalAction: function() {\n                    if (lastConsole.isOpen()) {\n                        lastConsole.close();\n                    } else {\n                        lastConsole.show();\n                    }\n                }\n            });\n            menuButtons.add({name: 'user'});\n            menuButtons.add({\n                name: 'about',\n                originalAction: function() {\n                    aboutDialog.dialog('open');\n                }\n            });\n            menuButtons.add({\n                name: 'timeleft',\n                originalAction: function() {\n                    menuButtons.toggleTimeLeft();\n                }\n            });\n            menuButtons.add({\n                name: 'more',\n                originalAction: function() {\n                    var tag = $('#vpl_ide_menuextra');\n                    if (tag.is(\":visible\")) {\n                        menuButtons.setText('more', 'more', VPLUtil.str('more'));\n                        tag.hide();\n                    } else {\n                        menuButtons.setText('more', 'less', VPLUtil.str('less'));\n                        tag.show();\n                    }\n                    VPLUtil.delay('updateMenu', updateMenu);\n                    VPLUtil.delay('autoResizeTab', autoResizeTab);\n                }\n            });\n            menuButtons.add({\n                name: 'rightpanel',\n                icon: 'close-rightpanel',\n                originalAction: function() {\n                    if (resultContainer.vplVisible) {\n                        resultContainer.hide();\n                        resultContainer.vplVisible = false;\n                        menuButtons.setText('rightpanel', 'open-rightpanel', VPLUtil.str('rightpanel'));\n                    } else {\n                        menuButtons.setText('rightpanel', 'close-rightpanel', VPLUtil.str('rightpanel'));\n                        resultContainer.show();\n                        resultContainer.vplVisible = true;\n                    }\n                    VPLUtil.delay('autoResizeTab', autoResizeTab);\n                },\n                bindKey: {\n                    win: 'Ctrl-M',\n                    mac: 'Ctrl-M'\n                }\n            });\n            var rightpanelstyle = \"position:absolute;right:0;top:60px;z-index:100;margin:3px\";\n            tr.append('<span style=\"' + rightpanelstyle + '\">' + menuButtons.getHTML('rightpanel') + '</span>');\n            var rightPanelButton = $('#vpl_ide_rightpanel');\n            menuButtons.setText('rightpanel', 'close-rightpanel', VPLUtil.str('rightpanel'));\n\n            rightPanelButton.button();\n            rightPanelButton.css('padding', '0');\n            $('#vpl_ide_rightpanel.ui-button-text').css('padding', '0');\n            rightPanelButton.on('click', function() {\n                menuButtons.launchAction('rightpanel');\n            });\n            rightPanelButton.hide();\n            menu.addClass(\"ui-widget-header ui-corner-all\");\n            var menuHtml = \"\";\n            menuHtml += menuButtons.getHTML('more');\n            menuHtml += menuButtons.getHTML('save');\n            menuHtml += \"<span id='vpl_ide_mexecution'>\";\n            menuHtml += menuButtons.getHTML('run');\n            menuHtml += menuButtons.getHTML('debug');\n            menuHtml += menuButtons.getHTML('evaluate');\n            menuHtml += menuButtons.getHTML('comments');\n            menuHtml += menuButtons.getHTML('console');\n            menuHtml += \"</span> \";\n            menuHtml += \"<span id='vpl_ide_menuextra'>\";\n            menuHtml += \"<span id='vpl_ide_file'>\";\n            // TODO autosave not implemented.\n            menuHtml += menuButtons.getHTML('filelist');\n            menuHtml += menuButtons.getHTML('new');\n            menuHtml += menuButtons.getHTML('rename');\n            menuHtml += menuButtons.getHTML('delete');\n            menuHtml += menuButtons.getHTML('import');\n            menuHtml += menuButtons.getHTML('download');\n            menuHtml += menuButtons.getHTML('resetfiles');\n            menuHtml += menuButtons.getHTML('sort');\n            menuHtml += menuButtons.getHTML('multidelete');\n            menuHtml += menuButtons.getHTML('fontsize');\n            menuHtml += menuButtons.getHTML('theme');\n            menuHtml += \"</span> \";\n            // TODO print still not implemented.\n            menuHtml += \"<span id='vpl_ide_edit'>\";\n            menuHtml += menuButtons.getHTML('undo');\n            menuHtml += menuButtons.getHTML('redo');\n            menuHtml += menuButtons.getHTML('select_all');\n            menuHtml += menuButtons.getHTML('find');\n            menuHtml += menuButtons.getHTML('find_replace');\n            menuHtml += menuButtons.getHTML('next');\n            menuHtml += \"</span> \";\n            menuHtml += \"</span> \";\n            menuHtml += menuButtons.getHTML('fullscreen') + ' ';\n            menuHtml += menuButtons.getHTML('about') + ' ';\n            menuHtml += menuButtons.getHTML('user') + ' ';\n            menuHtml += menuButtons.getHTML('timeleft');\n            menuHtml += '<div class=\"clearfix\"></div>';\n            menu.append(menuHtml);\n            $('#vpl_ide_more').button();\n            $('#vpl_ide_save').button();\n            $('#vpl_ide_menuextra').hide();\n            $('#vpl_ide_file').controlgroup();\n            $('#vpl_ide_edit').controlgroup();\n            $('#vpl_ide_mexecution').controlgroup();\n            $('#vpl_ide_fullscreen').button();\n            $('#vpl_ide_acetheme').button();\n            $('#vpl_ide_about').button();\n            $('#vpl_ide_user').button().css('float', 'right').hide();\n            $('#vpl_ide_timeleft').button().css('float', 'right').hide();\n            $('#vpl_menu .ui-button').css('padding', '6px');\n            $('#vpl_menu .ui-button-text').css('padding', '0');\n            var alwaysActive = ['filelist', 'more', 'fullscreen', 'about', 'resetfiles',\n                                'download', 'comments', 'console', 'import',\n                                'fontsize', 'timeleft'];\n            for (var i = 0; i < alwaysActive.length; i++) {\n                menuButtons.enable(alwaysActive[i], true);\n            }\n            menuButtons.setExtracontent('user', options.username);\n            menuButtons.setTimeLeft(options);\n            updateMenu = function() {\n                var i;\n                var file = fileManager.currentFile();\n                var nfiles = fileManager.length();\n                if (nfiles) {\n                    tabs.show();\n                } else {\n                    tabs.hide();\n                }\n                if (fileManager.isFileListVisible()) {\n                    menuButtons.setText('filelist', 'filelistclose', VPLUtil.str('filelist'));\n                } else {\n                    menuButtons.setText('filelist', 'filelist', VPLUtil.str('filelist'));\n                }\n                var modified = fileManager.isModified();\n                menuButtons.enable('save', modified);\n                var running = VPLUtil.monitorRunning();\n                if (running) {\n                    menuButtons.setText('run', 'running');\n                } else {\n                    menuButtons.setText('run', 'run');\n                }\n                menuButtons.enable('run', !running && (!modified || options.example) && isOptionAllowed('run'));\n                menuButtons.enable('debug', !running && (!modified || options.example) && isOptionAllowed('debug'));\n                menuButtons.enable('evaluate', !running && (!modified || options.example) && isOptionAllowed('evaluate'));\n                menuButtons.enable('download', !modified);\n                menuButtons.enable('new', nfiles < maxNumberOfFiles);\n                menuButtons.enable('sort', nfiles - minNumberOfFiles > 1);\n                menuButtons.enable('multidelete', nfiles - minNumberOfFiles > 1);\n                menuButtons.enable('theme', true);\n                var sel;\n                if (!file || nfiles === 0) {\n                    sel = ['rename', 'delete', 'undo', 'redo', 'select_all', 'find', 'find_replace', 'next'];\n                    for (i = 0; i < sel.length; i++) {\n                        menuButtons.enable(sel[i], false);\n                    }\n                    return;\n                }\n                var id = fileManager.getFilePosById(file.getId());\n                menuButtons.enable('rename', id >= minNumberOfFiles && nfiles !== 0);\n                menuButtons.enable('delete', id >= minNumberOfFiles && nfiles !== 0);\n                menuButtons.enable('undo', file.hasUndo());\n                menuButtons.enable('redo', file.hasRedo());\n                menuButtons.enable('select_all', file.hasSelectAll());\n                menuButtons.enable('find', file.hasFind());\n                menuButtons.enable('find_replace', file.hasFindReplace());\n                menuButtons.enable('next', file.hasNext());\n                VPLUtil.delay('updateFileList', fileManager.updateFileList);\n            };\n\n            executionActions = {\n                'open': updateMenu,\n                'close': updateMenu,\n                'getConsole': function() {\n                    return lastConsole;\n                },\n                'setResult': self.setResult,\n                'ajaxurl': options.ajaxurl,\n                'run': function(content, coninfo, ws) {\n                    var parsed = /^([^:]*):?(.*)/i.exec(content);\n                    var type = parsed[1];\n                    if (type == 'terminal' || type == 'webterminal') {\n                        if (lastConsole && lastConsole.isOpen()) {\n                            lastConsole.close();\n                        }\n                        lastConsole = terminal;\n                        terminal.connect(coninfo.executionURL, function() {\n                            ws.close();\n                            focusCurrentFile();\n                        });\n                        if (type == 'webterminal') {\n                            var URLfavicon = (coninfo.secure ? \"https\" : \"http\") + \"://\" + coninfo.server + \":\" + coninfo.portToUse;\n                            URLfavicon += \"/favicon.ico\";\n                            var imgFavicon = $('<img>');\n                            imgFavicon.attr('src', URLfavicon);\n                            imgFavicon.attr('style', 'display:none');\n                            $('body').append(imgFavicon);\n                        }\n                    } else if (type == 'vnc') {\n                        if (lastConsole && lastConsole.isOpen()) {\n                            lastConsole.close();\n                        }\n                        lastConsole = VNCClient;\n                        VNCClient.connect(coninfo.secure, coninfo.server, coninfo.portToUse, coninfo.VNCpassword,\n                                coninfo.executionPath, function() {\n                                    ws.close();\n                                    focusCurrentFile();\n                                });\n                    } else if (type == \"browser\") {\n                        var URL = (coninfo.secure ? \"https\" : \"http\") + \"://\" + coninfo.server + \":\" + coninfo.portToUse + \"/\";\n                        URL += parsed[2] + \"/httpPassthrough\";\n                        if (isTeacher) {\n                            URL += \"?private\";\n                        }\n                        var message = '<a href=\"' + URL + '\" target=\"_blank\">';\n                        message += VPLUtil.str('open') + '</a>';\n                        var options = {\n                            width: 200,\n                            icon: 'run',\n                            title: VPLUtil.str('run'),\n                        };\n                        showMessage(message, options);\n                    } else {\n                        VPLUtil.log(\"Type of run error \" + content, true);\n                    }\n                },\n                'lastAction': false,\n                'getLastAction': function() {\n                    var ret = this.lastAction;\n                    this.lastAction = false;\n                    return ret;\n                },\n                'setLastAction': function(action) {\n                    this.lastAction = action;\n                }\n            };\n\n            tabs.on(\"tabsactivate\", function() {\n                fileManager.currentFile('focus');\n                VPLUtil.delay('updateMenu', updateMenu);\n                VPLUtil.delay('autoResizeTab', autoResizeTab);\n            });\n\n            // VPLIDE resize view control.\n            var jw = $(window);\n            jw.on('resize', autoResizeTab);\n            // Save? before exit.\n            if (!options.example) {\n                jw.on('beforeunload', function() {\n                    if (fileManager.isModified()) {\n                        return str('changesNotSaved');\n                    }\n                    return undefined;\n                });\n            }\n            fileManager = new FileManager();\n\n            autoResizeTab();\n            // Checks menu width every 1 sec as it can change without event.\n            (function() {\n                var oldMenuWidth = menu.width();\n                /**\n                 * Checks menu width change\n                 */\n                function checkMenuWidth() {\n                    var newMenuWidth = menu.width();\n                    if (oldMenuWidth != newMenuWidth) {\n                        oldMenuWidth = newMenuWidth;\n                        autoResizeTab();\n                    }\n                }\n                checkMenuWidth();\n                setInterval(checkMenuWidth, 1000);\n            }());\n            fileManager.resetModified();\n            VPLUtil.requestAction('load', 'loading', options, options.loadajaxurl)\n            .done(function(response) {\n                var allOK = true;\n                var files = response.files;\n                var showFileList = false;\n                for (var i = 0; i < files.length; i++) {\n                    var file = files[i];\n                    var r = fileManager.addFile(file, false, updateMenu, showErrorMessage);\n                    if (r) {\n                        r.resetModified();\n                        if (i < minNumberOfFiles || files.length <= 5) {\n                            fileManager.open(r);\n                        } else {\n                            showFileList = true;\n                        }\n                    } else {\n                        allOK = false;\n                    }\n                }\n                tabs.tabs('option', 'active', 0);\n\n                if (response.compilationexecution) {\n                    self.setResult(response.compilationexecution, false);\n                }\n                menuButtons.setTimeLeft(response);\n                if (response.comments > '') {\n                    $('#vpl_ide_input_comments').val(response.comments);\n                }\n                if (allOK) {\n                    fileManager.resetModified();\n                } else {\n                    fileManager.setModified();\n                }\n                if (fileManager.length() === 0 && maxNumberOfFiles > 0) {\n                    menuButtons.getAction('new')();\n                } else if (!options.saved) {\n                    fileManager.setModified();\n                }\n                fileManager.setFontSize(options.fontSize);\n                fileManager.setVersion(response.version);\n                fileManager.fileListVisible(showFileList);\n                VPLUtil.afterAll('AfterLoadFiles', function() {\n                    updateMenu();\n                    autoResizeTab();\n                    adjustTabsTitles(true);\n                });\n            })\n            .fail(showErrorMessage);\n        };\n        window.VPLIDE = VPLIDE;\n        return {\n            init: function(rootId, options) {\n                vplIdeInstance = new VPLIDE(rootId, options);\n            }\n        };\n    }\n);\n"],"names":["define","$","jqui","VPLUtil","VPLFile","VPLIDEButtons","VPLTerminal","VPLVNCClient","VPLIDE","vplIdeInstance","rootId","options","fileManager","adjustTabsTitles","autoResizeTab","showErrorMessage","updateMenu","executionActions","self","this","minNumberOfFiles","minfiles","maxNumberOfFiles","maxfiles","restrictedEdit","restrictededitor","example","readOnly","isTeacher","fullScreen","scrollBarWidth","str","rootObj","append","_typeof","Error","activateModification","optionsToCheck","new","rename","delete","save","run","edit","debug","evaluate","import","resetfiles","sort","multidelete","acetheme","console","comments","loadajaxurl","ajaxurl","isOptionAllowed","op","dragoverHandler","e","originalEvent","dataTransfer","dropEffect","preventDefault","dropHandler","stopImmediatePropagation","dt","files","length","readSelectedFiles","file","addFile","fileListVisibleIfNeeded","restrictedPaste","stopPropagation","fontSize","parseInt","on","menu","menuButtons","tr","fileListContainer","fileList","fileListContent","tabsUl","tabs","resultContainer","result","vplMinWidth","updateEvaluationNumber","res","nevaluations","text","reductionbyevaluation","freeevaluations","setExtracontent","lastResult","getTerminal","terminal","setResultGrade","content","raw","titleclass","find","titleTag","replaceWith","setResultTab","name","contentclass","contentTag","HTMLcontent","contents","html","setResult","go","i","getFiles","fileNames","getFileName","clearAnnotations","hasContent","gradeShow","formated","show","grade","sanitizeText","variables","processResult","compilation","evaluation","execution","window","VPLDescription","MathJax","math","Hub","Queue","vplVisible","accordion","anot","getAnnotations","j","type","gotoFile","row","hide","delay","heightStyle","header","animate","beforeActivate","event","ui","newHeader","hasClass","width","gotoFileLink","currentTarget","addClass","iconFolder","tabsAir","getTabsAir","outerWidth","resizeTabWidth","maxWidth","diffLeft","position","left","originalPosition","resizable","vplOriginalWidth","diffWidth","size","originalSize","currentFile","resizableOptions","containment","resize","start","off","stop","handles","focusCurrentFile","center","newWidth","tabsUlWidth","last","children","parentScrollLeft","parent","scrollLeft","fileTab","getTabNameId","scroll","finish","index","oldWidth","planb","disable","css","right","rel","wfl","newHeight","outerHeight","offset","top","height","panelHeight","resizeHeight","dialogbaseOptions","extend","close","showMessage","message","dialogNew","newFileHandler","keyCode","dialog","val","encoding","newfile","open","getTabPos","focus","dialogButtons","title","buttons","setDialogTitleIcon","dialogRename","renameHandler","renameFile","dialogComments","aboutDialog","OKButtons","shortcutDialog","getShortcuts","next","filter","button","dialogSort","dialogSortButtons","regNoNumber","sorted","newOrder","each","orig","id","replace","push","setModified","list","sortable","items","placeholder","item","removeClass","disableSelection","maxHeight","dialogMultidelete","dialogMultideleteButtons","prop","toDeleteList","label","data","deleteFile","updateFileList","dialogFontsize","fontsizeSlider","dialogFontFizeButtons","value","slider","setFontSize","ajax","async","url","JSON","stringify","contentType","dataType","getFontSize","min","max","change","dialogAceTheme","acethemeSelect","dialogAceThemeButtons","setTheme","setUserPreferences","aceTheme","modal","getTheme","VNCClient","lastConsole","fileSelect","resetFiles","requestAction","done","response","fileName","hasOwnProperty","doNothing","fail","executionRequest","action","acting","isConnected","webSocketMonitor","runAction","XGEOMETRY","getCanvasSize","debugAction","evaluateAction","add","originalAction","fileListVisible","isFileListVisible","bindKey","win","mac","getFilePosById","getId","filename","ok","icon","trigger","print","editorName","tags","setText","scrollTop","username","setTimeout","location","download","getFilesToSave","version","getVersion","postMaxSize","doSave","requestsconfirmation","question","yes","resetModified","setVersion","setTimeLeft","monitorRunning","processid","getProcessId","setLastAction","isOpen","toggleTimeLeft","tag","is","getHTML","rightPanelButton","launchAction","menuHtml","controlgroup","alwaysActive","enable","nfiles","modified","isModified","sel","running","hasUndo","hasRedo","hasSelectAll","hasFind","hasFindReplace","hasNext","getConsole","coninfo","ws","parsed","exec","connect","executionURL","URLfavicon","secure","server","portToUse","imgFavicon","attr","VNCpassword","executionPath","URL","log","lastAction","getLastAction","ret","jw","openFiles","fileNameIncluded","checkName","toLowerCase","nameMod","indexOf","twoBlockly","oldname","newname","isBlockly","v","generateFileList","fileNameExists","localClipboard","setClipboard","t","getClipboard","theme","addTab","fid","hlink","removeTab","remove","pos","setGetkeys","ptab","splice","isClosed","b","showError","validPath","setContent","getUniqueId","extendToBinary","extendToBlockly","extendToCodeEditor","setFileName","isBinary","fileExtension","getContent","gotoFileName","arguments","fun","args","Array","prototype","slice","shift","apply","currentPos","getFileTab","l","gotoLine","a","fname","fpos","line","getFile","getDirectoryStructure","structure","isDir","addFilePath","path","split","curdir","p","part","lines","lister","dir","indent","fd","sname","iconModified","iconRequired","getAction","oldMenuWidth","checkMenuWidth","newMenuWidth","setInterval","allOK","showFileList","r","compilationexecution","saved","afterAll","init"],"mappings":"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"}