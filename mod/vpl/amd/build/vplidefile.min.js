/**
 * File management
 *
 * @copyright 2013 Juan Carlos Rodríguez-del-Pino
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>
 */
define("mod_vpl/vplidefile",["jquery","jqueryui","mod_vpl/vplutil","mod_vpl/vplidecodefile","mod_vpl/vplideblocklyfile","mod_vpl/vplidebinaryfile"],(function($,jqui,VPLUtil,codeExtension,blocklyExtension,binaryExtension){return function(id,name,value,fileManager,vplIdeInstance){var tid="#vpl_file"+id,tabnameid="#vpl_tab_name"+id,fileName=name,modified=!0,opened=!1,self=this;this.getContent=function(){return value},this.setContent=function(c){value=c},this.getFileManager=function(){return fileManager},this.getFileName=function(){return fileName},this.getId=function(){return id},this.getTabNameId=function(){return tabnameid},this.getTId=function(){return tid},this.getFileName=function(){return fileName},this.isModified=function(){return modified},this.resetModified=function(){modified=!1,this.showFileName()},this.setModified=function(){modified=!0,this.showFileName()},this.getTabPos=function(){return fileManager.getTabPos(this)},this.isOpen=function(){return opened},this.setOpen=function(openState){opened=openState},this.getVPLIDE=function(){return vplIdeInstance},this.change=function(){modified||(this.setModified(),fileManager.generateFileList(),this.showFileName(),VPLUtil.longDelay("setModified",fileManager.setModified))},this.setFileName=function(name){return!!VPLUtil.validPath(name)&&(name!=fileName&&(fileName=name,self.change()),!this.isOpen()||(this.showFileName(),this.langSelection(),!0))},this.showFileName=function(){var name=this.getFileName(),fn=VPLUtil.getFileName(name);fn.length>20&&(fn=fn.substring(0,16)+"...");var html=(modified?VPLUtil.iconModified():"")+fn;this.getTabPos()<fileManager.minNumberOfFiles?html+=VPLUtil.iconRequired():html+=VPLUtil.iconClose(),$(tabnameid+" a").html(html),fn!=name&&$(tabnameid+" a").attr("title",name),VPLUtil.afterAll("adjustTabsTitles"+self.id,(function(){fileManager.adjustTabsTitles(!0),VPLUtil.delay("adjustTabsTitles"+self.id,(function(){self.adjustSize()}))}))},this.destroy=function(){$(tabnameid).remove(),$(tid).remove()},this.adjustSize=function(){if(!this.isOpen())return!1;var editTag=$(tid),tabs=editTag.parent();if(0===editTag.length)return!1;var editorHeight=editTag.height(),editorWidth=editTag.width(),newHeight=tabs.height();newHeight-=editTag.position().top;var newWidth=$("#vpl_tabs_scroll").width();return(newHeight!=editorHeight||newWidth!=editorWidth)&&($(editTag).height(newHeight),$(editTag).width(newWidth),!0)},this.gotoLine=VPLUtil.doNothing,this.setReadOnly=VPLUtil.doNothing,this.focus=VPLUtil.doNothing,this.blur=VPLUtil.doNothing,this.undo=VPLUtil.doNothing,this.redo=VPLUtil.doNothing,this.selectAll=VPLUtil.doNothing,this.open=VPLUtil.doNothing,this.hasUndo=VPLUtil.returnFalse,this.hasRedo=VPLUtil.returnFalse,this.hasSelectAll=VPLUtil.returnFalse,this.hasFind=VPLUtil.returnFalse,this.hasFindReplace=VPLUtil.returnFalse,this.hasNext=VPLUtil.returnFalse,this.find=VPLUtil.doNothing,this.replace=VPLUtil.doNothing,this.next=VPLUtil.doNothing,this.getAnnotations=function(){return[]},this.setAnnotations=VPLUtil.doNothing,this.setFontSize=VPLUtil.doNothing,this.setTheme=VPLUtil.doNothing,this.clearAnnotations=VPLUtil.doNothing,this.langSelection=VPLUtil.doNothing,this.isBinary=VPLUtil.returnFalse,this.extendToCodeEditor=codeExtension,this.extendToBlockly=blocklyExtension,this.extendToBinary=binaryExtension}}));

//# sourceMappingURL=vplidefile.min.js.map