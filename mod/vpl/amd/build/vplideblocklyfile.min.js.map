{"version":3,"sources":["../src/vplideblocklyfile.js"],"names":["define","$","VPLUtil","self","vplIdeInstance","getVPLIDE","firstContent","workspaceInstance","adaptBlockly","Blockly","PHP","workspaceToCodeOld","workspaceToCode","workspace","Python","oldAdjustSize","adjustSize","call","editTag","getTId","length","tabs","parent","newHeight","height","position","top","bdiv","width","svgResize","undo","isOpen","redo","interpreter","animateRun","RUNSTATE","STEPSTATE","STOPSTATE","executionState","goNext","initRun","animate","ter","getTerminal","isConnected","closeLocal","JavaScript","STATEMENT_PREFIX","addReservedWords","code","Interpreter","initApi","scope","setProperty","createNativeFunction","wrapperAlert","text","toString","createPrimitive","writeLocal","createAsyncFunction","wrapperPrompt","callback","setDataCallback","t","wrapperHighlightBlock","id","getBreakpoint","updateRunButtons","setMessage","str","highlightBlock","connectLocal","stop","doNothing","reservedWords","breakpoint","lastSelection","setBreakpoint","removeBreakpoint","setLastSelection","selection","isSelectingBreakpoint","getVarValue","val","HTML","type","sanitizeText","class","ar","properties","i","getVariables","proname","pro","value","getParameters","args","showStack","sn","stack","stateStack","lastFunc","level","node","callee","name","arguments_","setResult","variables","runLoop","step","setTimeout","start","startAnimate","pause","resume","hasUndo","hasRedo","oldSetFileName","setFileName","generatorMap","py","dart","js","lua","php","generator","newName","oldFileName","getFileName","oldExt","fileExtension","log","ext2","exec","fn2","generatedFilename","updateGeneratedCode","afterAll","close","open","blocklyNotLoaded","fileManager","getFileManager","fid","fileNameExists","addFile","contents","fileGenerated","getFile","getContent","setContent","change","gotoLine","setReadOnly","changeCode","event","element","newValue","longDelay","clearUndo","recordUndo","triesUpdateRunButtons","removeClass","addClass","setToolbox","ext","toolboxname","ajax","url","dataType","success","data","blocklyIn18","addUpdateButtons","func","callBacks","wp","updateToolbox","key","registerButtonCallback","showFileName","loadScript","setOpen","fileName","horizontalMenu","test","tid","getId","html","options","toolbox","media","horizontalLayout","zoom","controls","wheel","startScale","maxScale","minScale","scaleSpeed","inject","addChangeListener","adjustBlockly","scrollX","scrollY","resizeSvgContents","getContentOld","xml","Xml","workspaceToDom","xmlText","domToPrettyText","setContentOld","c","clear","textToDom","domToWorkspace","dispose","blocklyToolbox","blockly0Toolbox","blockly1Toolbox","blockly2Toolbox","blockly3Toolbox","blocklyStrs","l","reg","RegExp","rep","replace"],"mappings":"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","sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Blockly file management\n *\n * @copyright 2013 Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\n/* globals Interpreter */\n/* globals Blockly */\n\ndefine(\n    [\n        'jquery',\n        'mod_vpl/vplutil',\n    ],\n    function($, VPLUtil) {\n        return function() {\n            var self = this;\n            var vplIdeInstance = this.getVPLIDE();\n            this.firstContent = true;\n            this.workspaceInstance = false;\n            var adaptBlockly = function() {\n                if (typeof Blockly.PHP.workspaceToCodeOld == 'undefined') {\n                    Blockly.PHP.workspaceToCodeOld = Blockly.PHP.workspaceToCode;\n                    Blockly.PHP.workspaceToCode = function(workspace) {\n                        return \"<?php\\n\" + Blockly.PHP.workspaceToCodeOld(workspace);\n                    };\n                }\n                if (typeof Blockly.Python.workspaceToCodeOld == 'undefined') {\n                    Blockly.Python.workspaceToCodeOld = Blockly.Python.workspaceToCode;\n                    Blockly.Python.workspaceToCode = function(workspace) {\n                        return \"# -*- coding: utf-8 -*-\\n\" + Blockly.Python.workspaceToCodeOld(workspace);\n                    };\n                }\n            };\n            var oldAdjustSize = this.adjustSize;\n            this.adjustSize = function() {\n                if (oldAdjustSize.call(this)) {\n                    var editTag = $(this.getTId());\n                    if (editTag.length === 0) {\n                        return false;\n                    }\n                    var tabs = editTag.parent();\n                    var newHeight = tabs.height();\n                    newHeight -= editTag.position().top;\n                    editTag.height(newHeight);\n                    $('#' + this.bdiv).height(newHeight);\n                    $('#' + this.bdiv).width(editTag.width());\n                    Blockly.svgResize(this.workspaceInstance);\n                    return false;\n                }\n                return false;\n            };\n            this.undo = function() {\n                if (this.isOpen()) {\n                    this.workspaceInstance.undo(false);\n                }\n            };\n            this.redo = function() {\n                if (this.isOpen()) {\n                    this.workspaceInstance.undo(true);\n                }\n            };\n            this.interpreter = false;\n            this.animateRun = false;\n            this.RUNSTATE = 1;\n            this.STEPSTATE = 2;\n            this.STOPSTATE = 3;\n            this.executionState = this.STOPSTATE;\n            this.goNext = false;\n            this.initRun = function(animate) {\n                var ter = vplIdeInstance.getTerminal();\n                if (ter.isConnected()) {\n                    ter.closeLocal();\n                }\n                this.animateRun = animate;\n                Blockly.JavaScript.STATEMENT_PREFIX = 'highlightBlock(%1);\\n';\n                Blockly.JavaScript.addReservedWords('highlightBlock');\n                var code = Blockly.JavaScript.workspaceToCode(self.workspaceInstance);\n                var initApi = function(interpreter, scope) {\n                    // Add an API function for the alert() block.\n                    var wrapperAlert = function(text) {\n                        text = typeof text != 'string' ? text.toString() + '\\r\\n' : text + '\\r\\n';\n                        return interpreter.createPrimitive(ter.writeLocal(text));\n                    };\n                    interpreter.setProperty(scope, 'alert',\n                            interpreter.createNativeFunction(wrapperAlert));\n\n                    // Add an API function for the prompt() block.\n                    var wrapperPrompt = function(text, callback) {\n                        text = typeof text != 'string' ? text.toString() : '' + text;\n                        ter.writeLocal(text);\n                        ter.setDataCallback(function(t) {\n                                               ter.writeLocal('\\n');\n                                               callback(t);\n                                            });\n                    };\n                    interpreter.setProperty(scope, 'prompt',\n                        interpreter.createAsyncFunction(wrapperPrompt));\n\n                    var wrapperHighlightBlock = function(id) {\n                        if (id == self.getBreakpoint()) {\n                            self.executionState = self.STEPSTATE;\n                            self.updateRunButtons();\n                            vplIdeInstance.getTerminal().setMessage(VPLUtil.str('breakpoint'));\n                        }\n                        if (self.animateRun || self.executionState == self.STEPSTATE) {\n                            self.workspaceInstance.highlightBlock(id);\n                        }\n                        self.goNext = false;\n                    };\n                    interpreter.setProperty(scope, 'highlightBlock',\n                            interpreter.createNativeFunction(wrapperHighlightBlock));\n                };\n                self.interpreter = new Interpreter(code, initApi);\n                ter.connectLocal(self.stop, VPLUtil.doNothing);\n            };\n            this.reservedWords = {\n                'Infinity': true, 'Array': true, 'Boolean': true,\n                'Date': true, 'Error': true, 'EvalError': true,\n                'Function': true, 'JSON': true, 'Math': true,\n                'NaN': true, 'Number': true, 'Object': true, 'RangeError': true,\n                'ReferenceError': true, 'RegExp': true, 'String': true,\n                'SyntaxError': true, 'TypeError': true, 'URIError': true,\n                'alert': true, 'arguments': true, 'constructor': true, 'eval': true,\n                'highlightBlock': true, 'isFinite': true,\n                'isNaN': true, 'parseFloat': true, 'parseInt': true, 'prompt': true,\n                'self': true, 'this': true, 'window': true,\n            };\n            (function() {\n                var breakpoint = null;\n                var lastSelection = null;\n                self.getBreakpoint = function() {\n                    return breakpoint;\n                };\n                self.setBreakpoint = function() {\n                    breakpoint = lastSelection;\n                };\n                self.removeBreakpoint = function() {\n                    breakpoint = null;\n                };\n                self.setLastSelection = function(selection) {\n                    lastSelection = selection;\n                };\n                self.isSelectingBreakpoint = function() {\n                    return breakpoint === null && lastSelection !== null;\n                };\n            })();\n            this.getVarValue = function(val) {\n                var HTML = '';\n                if (val === null) {\n                    HTML = \"<b>null</b>\";\n                } else if (val != undefined) {\n                    var type = typeof val;\n                    if (type == 'string') {\n                        HTML = '\"' + VPLUtil.sanitizeText(val) + '\"';\n                    } else if (type == 'boolean') {\n                        HTML = \"<b>\" + val + \"</b>\";\n                    } else if (type == 'object' && val.class === \"Array\") {\n                        HTML = '[';\n                        var ar = val.properties;\n                        for (var i = 0; i < ar.length; i++) {\n                            HTML += self.getVarValue(ar[i]);\n                            if (i != ar.length - 1) {\n                                HTML += ', ';\n                            }\n                        }\n                        HTML += ']';\n                    } else if (type == 'object') {\n                        HTML = \"<b>\" + val.toString() + \"</b>\";\n                    } else {\n                        HTML += '' + val;\n                    }\n                }\n                return HTML;\n            };\n            this.getVariables = function(properties) {\n                var HTML = '';\n                for (var proname in properties) {\n                    if (this.reservedWords[proname] === true) {\n                        continue;\n                    }\n                    var pro = properties[proname];\n                    if (pro != undefined && !(pro.class === \"Function\")) {\n                        var value = VPLUtil.sanitizeText(self.getVarValue(pro));\n                        HTML += '<b>' + proname + \"</b>:&nbsp;\" + value + \"<br>\\n\";\n                    }\n                }\n                return HTML;\n            };\n            this.getParameters = function(args) {\n                var HTML = '(';\n                for (var i = 0; i < args.length; i++) {\n                    HTML += '' + args[i];\n                    if (i < args.length - 1) {\n                        HTML += ', ';\n                    }\n                }\n                return HTML + ')';\n            };\n            this.showStack = function(interpreter) {\n                var sn = 0;\n                var HTML = '<table class=\"generaltable\">';\n                var stack = interpreter.stateStack;\n                var lastFunc = '<tr><td>0</td><td><b>Globals</b></td>';\n                for (var i = 0; i < stack.length; i++) {\n                    var level = stack[i];\n                    if (lastFunc > '' && (level.node.type == 'CallExpression' || i == stack.length - 1)) {\n                        HTML += lastFunc + '<td>' + self.getVariables(level.scope.properties);\n                        HTML += '</td></tr>';\n                    }\n                    if (level.node.type == 'CallExpression') {\n                        if (self.reservedWords[level.node.callee.name] !== true\n                        && level.node.callee.name != undefined) {\n                            sn++;\n                            lastFunc = '<tr><td>' + sn + '</td>';\n                            lastFunc += '<td>' + level.node.callee.name + self.getParameters(level.arguments_) + '</td>';\n                        } else {\n                            lastFunc = '';\n                        }\n                    }\n                }\n                HTML += '</table>';\n                vplIdeInstance.setResult({variables: HTML});\n            };\n            this.runLoop = function() {\n                if (!self.interpreter) {\n                    return;\n                }\n                self.goNext = true;\n                for (var i = 0; i < 30000 && self.goNext; i++) {\n                    if (self.executionState == self.STOPSTATE) {\n                        break;\n                    }\n                    if (!self.interpreter || !self.interpreter.step()) {\n                        self.executionState = self.STOPSTATE;\n                        self.updateRunButtons();\n                        break;\n                    }\n                }\n                if (self.executionState == self.STOPSTATE) {\n                    self.workspaceInstance.highlightBlock(-1);\n                    vplIdeInstance.getTerminal().closeLocal();\n                    vplIdeInstance.setResult({variables: ''});\n                    return;\n                }\n                if (self.executionState == self.RUNSTATE) {\n                    if (self.animateRun) {\n                        setTimeout(self.runLoop, 1000);\n                        self.showStack(self.interpreter);\n                    } else {\n                        setTimeout(self.runLoop, 0);\n                    }\n                } else {\n                    self.showStack(self.interpreter);\n                }\n            };\n            this.start = function() {\n                if (self.executionState != self.STOPSTATE) {\n                    return;\n                }\n                self.initRun(false);\n                self.executionState = self.RUNSTATE;\n                self.updateRunButtons();\n                vplIdeInstance.getTerminal().setMessage(VPLUtil.str('start'));\n                self.runLoop();\n            };\n            this.startAnimate = function() {\n                if (self.executionState != self.STOPSTATE) {\n                    return;\n                }\n                self.initRun(true);\n                self.executionState = self.RUNSTATE;\n                self.updateRunButtons();\n                vplIdeInstance.getTerminal().setMessage(VPLUtil.str('startanimate'));\n                self.runLoop();\n            };\n            this.stop = function() {\n                self.executionState = self.STOPSTATE;\n                self.workspaceInstance.highlightBlock(-1);\n                self.updateRunButtons();\n                vplIdeInstance.getTerminal().setMessage(VPLUtil.str('stop'));\n                vplIdeInstance.getTerminal().closeLocal();\n                self.interpreter = false;\n                vplIdeInstance.setResult({variables: ''});\n            };\n            this.pause = function() {\n                if (self.executionState != self.RUNSTATE) {\n                    return;\n                }\n                self.executionState = self.STEPSTATE;\n                vplIdeInstance.getTerminal().setMessage(VPLUtil.str('pause'));\n                self.updateRunButtons();\n            };\n            this.resume = function() {\n                if (self.executionState != self.STEPSTATE) {\n                    return;\n                }\n                self.executionState = self.RUNSTATE;\n                vplIdeInstance.getTerminal().setMessage(VPLUtil.str('resume'));\n                self.updateRunButtons();\n                self.runLoop();\n            };\n            this.step = function() {\n                if (self.executionState == self.STOPSTATE) {\n                    self.initRun(true);\n                }\n                self.executionState = self.STEPSTATE;\n                self.updateRunButtons();\n                vplIdeInstance.getTerminal().setMessage(VPLUtil.str('step'));\n                self.runLoop();\n            };\n            this.hasUndo = function() {\n                return true;\n            };\n            this.hasRedo = function() {\n                return true;\n            };\n            this.oldSetFileName = this.setFileName;\n            this.generatorMap = {\n                py: 'Python',\n                dart: 'Dart',\n                js: 'JavaScript',\n                lua: 'Lua',\n                php: 'PHP'\n            };\n            this.generator = '';\n            this.setFileName = function(newName) {\n                var oldFileName = this.getFileName();\n                var oldExt = VPLUtil.fileExtension(oldFileName);\n                if (!self.oldSetFileName(newName)) {\n                    VPLUtil.log(\"Blockly setFileName: name no acepted \" + newName);\n                    return false;\n                }\n                VPLUtil.log('Blockly set filename ' + newName);\n                var regExt2 = /\\.([^.]+)\\.blockly[123]?$/;\n                var regFn2 = /(.+)\\.blockly[123]?$/;\n                var ext2 = regExt2.exec(newName);\n                var fn2 = regFn2.exec(newName);\n                if (ext2 !== null && fn2 !== null && typeof this.generatorMap[ext2[1]] == 'string') {\n                    this.generator = this.generatorMap[ext2[1]];\n                    this.generatedFilename = fn2[1];\n                    VPLUtil.log('Blockly generator ' + this.generator + ' for filename ' + this.generatedFilename);\n                    this.updateGeneratedCode();\n                } else {\n                    this.generator = '';\n                }\n                if (oldExt != VPLUtil.fileExtension(newName)) {\n                    VPLUtil.log('Blockly extension changed');\n                    VPLUtil.afterAll('reopenBlockly', function() {\n                            VPLUtil.log('reopenBlockly');\n                            self.close();\n                            self.open();\n                        }\n                    );\n                }\n                return true;\n            };\n            this.updateGeneratedCode = function() {\n                if (self.blocklyNotLoaded) {\n                    return;\n                }\n                var fileManager = self.getFileManager();\n                if (self.generator != '') {\n                    VPLUtil.log('Blockly generate ' + self.generator);\n                    var code = Blockly[self.generator].workspaceToCode(self.workspaceInstance);\n                    var fid = fileManager.fileNameExists(self.generatedFilename);\n                    // Try to create generated code file.\n                    if (fid == -1) {\n                        VPLUtil.log(\"try to create \" + self.generatedFilename + \" files\");\n                        fileManager.addFile({\n                            name: self.generatedFilename,\n                            contents: ''},\n                            false, VPLUtil.doNothing, VPLUtil.doNothing);\n                        fid = fileManager.fileNameExists(self.generatedFilename);\n                    }\n                    if (fid != -1) {\n                        var fileGenerated = fileManager.getFile(fid);\n                        if (fileGenerated.getContent() != code) {\n                            fileGenerated.setContent(code);\n                            fileGenerated.change();\n                            fileGenerated.gotoLine(1);\n                            fileGenerated.setReadOnly(true);\n                        }\n                    }\n                }\n            };\n            this.changeCode = function(event) {\n                VPLUtil.log(event);\n                if (event.type == 'ui' && event.element == 'selected') {\n                    self.setLastSelection(event.newValue);\n                    return;\n                }\n                if (event.type == 'ui'\n                        && event.element == 'category'\n                        && event.newValue == VPLUtil.str('run')) {\n                        VPLUtil.longDelay('updateRunButtons', self.updateRunButtons);\n                    return;\n                }\n                if (self.firstContent) {\n                    if (event.type == 'finished_loading') {\n                        self.firstContent = false;\n                        self.workspaceInstance.clearUndo();\n                    } else {\n                        return;\n                    }\n                }\n                if (!event.recordUndo) {\n                    return;\n                }\n\n                VPLUtil.log('Call change due changeCode');\n                self.change();\n                if (self.generator != '') {\n                    VPLUtil.afterAll('generate' + self.getFileName(), self.updateGeneratedCode);\n                }\n            };\n            var triesUpdateRunButtons = 0;\n            var triesUpdateRunButtonsLimits = 20;\n            this.updateRunButtons = function() {\n                if ($('.blocklySelectBreakpointC').length == 0) {\n                    triesUpdateRunButtons++;\n                    if (triesUpdateRunButtons > triesUpdateRunButtonsLimits) {\n                        triesUpdateRunButtons = 0;\n                        VPLUtil.log('Giving up to tries of updateRunButtons');\n                        return;\n                    }\n                    VPLUtil.longDelay('updateRunButtons', self.updateRunButtons);\n                    return;\n                }\n                VPLUtil.log('updateRunButtons');\n                triesUpdateRunButtons = 0;\n                var dimmed = 'vpl_dimmed';\n                if (self.isSelectingBreakpoint()) {\n                    $('.blocklySelectBreakpointC').removeClass(dimmed);\n                } else {\n                    $('.blocklySelectBreakpointC').addClass(dimmed);\n                }\n                if (self.getBreakpoint() === null) {\n                    $('.blocklyRemoveBreakpointC').addClass(dimmed);\n                } else {\n                    $('.blocklyRemoveBreakpointC').removeClass(dimmed);\n                }\n                switch (self.executionState) {\n                    case self.RUNSTATE: {\n                        $('.blocklyStartC').addClass(dimmed);\n                        $('.blocklyStartAnimateC').addClass(dimmed);\n                        $('.blocklyStopC').removeClass(dimmed);\n                        $('.blocklyPauseC').removeClass(dimmed);\n                        $('.blocklyResumeC').addClass(dimmed);\n                        $('.blocklyStepC').addClass(dimmed);\n                        break;\n                    }\n                    case self.STEPSTATE: {\n                        $('.blocklyStartC').addClass(dimmed);\n                        $('.blocklyStartAnimateC').addClass(dimmed);\n                        $('.blocklyStopC').removeClass(dimmed);\n                        $('.blocklyPauseC').addClass(dimmed);\n                        $('.blocklyResumeC').removeClass(dimmed);\n                        $('.blocklyStepC').removeClass(dimmed);\n                        break;\n                    }\n                    case self.STOPSTATE: {\n                        $('.blocklyStartC').removeClass(dimmed);\n                        $('.blocklyStartAnimateC').removeClass(dimmed);\n                        $('.blocklyStopC').addClass(dimmed);\n                        $('.blocklyPauseC').addClass(dimmed);\n                        $('.blocklyResumeC').addClass(dimmed);\n                        $('.blocklyStepC').removeClass(dimmed);\n                        break;\n                    }\n                }\n            };\n            this.setToolbox = function() {\n                var ext = VPLUtil.fileExtension(this.getFileName());\n                var toolboxname = ext + 'Toolbox';\n                if (self[toolboxname] === false) {\n                    $.ajax({\n                        url: '../editor/blocklytoolboxes/' + toolboxname + '.xml',\n                        dataType: 'text',\n                        success: function(data) {\n                            self[toolboxname] = self.blocklyIn18(data);\n                            self.setToolbox();\n                        },\n                    });\n                    return;\n                }\n                var addUpdateButtons = function(func) {\n                    return function() {\n                        func();\n                        self.updateRunButtons();\n                    };\n                };\n                var callBacks = {\n                    'blocklyStartButton': this.start,\n                    'blocklyStartAnimateButton': this.startAnimate,\n                    'blocklyStopButton': this.stop,\n                    'blocklyPauseButton': this.pause,\n                    'blocklyResumeButton': this.resume,\n                    'blocklyStepButton': this.step,\n                    'blocklySelectBreakpointButton': this.setBreakpoint,\n                    'blocklyRemoveBreakpointButton': this.removeBreakpoint,\n                };\n                var wp = this.workspaceInstance;\n                wp.updateToolbox(this[toolboxname]);\n                for (var key in callBacks) {\n                    wp.registerButtonCallback(key, addUpdateButtons(callBacks[key]));\n                }\n                this.adjustSize();\n            };\n            this.open = function() {\n                this.showFileName();\n                if (self.blocklyNotLoaded) {\n                    VPLUtil.loadScript(\n                        [\n                            '../editor/blockly/blockly_compressed.js',\n                            '../editor/blockly/msg/js/en.js',\n                            '../editor/blockly/blocks_compressed.js',\n                            '../editor/blockly/python_compressed.js',\n                            '../editor/blockly/javascript_compressed.js',\n                            '../editor/blockly/php_compressed.js',\n                            '../editor/blockly/lua_compressed.js',\n                            '../editor/blockly/dart_compressed.js',\n                            '../editor/acorn/acorn.js',\n                            '../editor/acorn/interpreter.js',\n                        ],\n                        function() {\n                            VPLUtil.log('Blocklyloaded', true);\n                            adaptBlockly();\n                            self.blocklyNotLoaded = false;\n                            self.open();\n                        }\n                    );\n                    return false;\n                }\n                var code = this.getContent();\n                this.setOpen(true);\n                var fileName = this.getFileName();\n                var horizontalMenu = false;\n                if (/.*[0-9]$/.test(VPLUtil.fileExtension(fileName))) {\n                    horizontalMenu = true;\n                }\n                var tid = this.getTId();\n                // Workaround to remove jquery-ui theme background color.\n                $(tid).removeClass('ui-widget-content ui-tabs-panel');\n                $(tid).addClass('ui-corner-bottom');\n                this.bdiv = 'bkdiv' + this.getId();\n                $(tid).html('<div id=\"' + this.bdiv + '\" style=\"height: 480px; width: 600px;\"></div>');\n                var options = {\n                    toolbox: '<xml><category name=\"\" colour=\"330\"><block type=\"math_number\"></block></category></xml>',\n                    media: '../editor/blockly/media/',\n                    horizontalLayout: horizontalMenu,\n                    zoom: {\n                        controls: true,\n                        wheel: true,\n                        startScale: 1.0,\n                        maxScale: 3,\n                        minScale: 0.2,\n                        scaleSpeed: 0.3\n                    }\n                };\n                this.workspaceInstance = Blockly.inject(this.bdiv, options);\n                this.setToolbox();\n                this.firstContent = true;\n                self.workspaceInstance.addChangeListener(self.changeCode);\n                this.setContent(code);\n                VPLUtil.adjustBlockly(self.workspaceInstance, 10, 10);\n                self.workspaceInstance.scrollX = 0;\n                self.workspaceInstance.scrollY = 0;\n                Blockly.svgResize(self.workspaceInstance);\n                Blockly.resizeSvgContents(self.workspaceInstance);\n                self.adjustSize();\n                // Must return false. Do not change it.\n                return false;\n            };\n            var getContentOld = this.getContent;\n            this.getContent = function() {\n                if (!this.isOpen()) {\n                    return getContentOld.call(this);\n                }\n                var xml = Blockly.Xml.workspaceToDom(this.workspaceInstance);\n                var xmlText = Blockly.Xml.domToPrettyText(xml);\n                return xmlText;\n            };\n            var setContentOld = this.setContent;\n            this.setContent = function(c) {\n                setContentOld.call(this, c);\n                if (c.length > 0 && this.isOpen()) {\n                    this.workspaceInstance.clear();\n                    var xml = Blockly.Xml.textToDom(c);\n                    Blockly.Xml.domToWorkspace(xml, this.workspaceInstance);\n                }\n            };\n            this.close = function() {\n                if (this.isOpen()) {\n                    setContentOld.call(this, this.getContent());\n                    this.workspaceInstance.dispose();\n                    this.workspaceInstance = false;\n                    this.setOpen(false);\n                }\n            };\n            this.blocklyNotLoaded = true;\n            this.blocklyToolbox = false;\n            this.blockly0Toolbox = false;\n            this.blockly1Toolbox = false;\n            this.blockly2Toolbox = false;\n            this.blockly3Toolbox = false;\n            this.blocklyStrs = [\n                'basic',\n                'intermediate',\n                'advanced',\n                'variables',\n                'operatorsvalues',\n                'control',\n                'inputoutput',\n                'functions',\n                'lists',\n                'math',\n                'text',\n                'run',\n                'start',\n                'startanimate',\n                'stop',\n                'pause',\n                'resume',\n                'step',\n                'breakpoint',\n                'selectbreakpoint',\n                'removebreakpoint'\n            ];\n            this.blocklyIn18 = function(data) {\n                var l = this.blocklyStrs.length;\n                for (var i = 0; i < l; i++) {\n                    var str = this.blocklyStrs[i];\n                    var reg = new RegExp('\\\\[\\\\[' + str + '\\\\]\\\\]', 'g');\n                    var rep = VPLUtil.str(str);\n                    data = data.replace(reg, rep);\n                }\n                return data;\n            };\n        };\n    }\n);\n"],"file":"vplideblocklyfile.min.js"}