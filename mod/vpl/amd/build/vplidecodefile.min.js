define ("mod_vpl/vplidecodefile",["jquery","mod_vpl/vplutil"],function(a,b){return function(){var c=this,d=null,e=null,f=c.getFileManager().readOnly,g=this.getContent;this.getContent=function(){if(!this.isOpen()){return g.call(this)}return d.getValue()};var h=this.setContent;this.setContent=function(a){h.call(this,a);if(this.isOpen()){d.setValue(a)}};var i=this.destroy;this.destroy=function(){if(this.isOpen()){d.destroy()}i.call(this)};this.setFontSize=function(a){if(this.isOpen()){d.setFontSize(a)}};var j=this.adjustSize;this.adjustSize=function(){if(j.call(this)){d.resize(!0);return!0}return!1};this.gotoLine=function(a){if(!this.isOpen()){return}d.gotoLine(a,0);d.scrollToLine(a,!0);d.focus()};this.setReadOnly=function(a){f=a;if(this.isOpen()){d.setReadOnly(a)}};this.focus=function(){if(!this.isOpen()){return}var b=this.getTId();a(b).removeClass("ui-widget-content ui-tabs-panel");d.focus()};this.blur=function(){if(!this.isOpen()){return}d.blur()};this.undo=function(){if(!this.isOpen()){return}d.undo();d.focus()};this.redo=function(){if(!this.isOpen()){return}d.redo();d.focus()};this.selectAll=function(){if(!this.isOpen()){return}d.selectAll();d.focus()};this.hasUndo=function(){if(!this.isOpen()){return!1}return e.getUndoManager().hasUndo()};this.hasRedo=function(){if(!this.isOpen()){return!1}return e.getUndoManager().hasRedo()};this.hasSelectAll=b.returnTrue;this.hasFind=b.returnTrue;this.hasFindReplace=b.returnTrue;this.hasNext=b.returnTrue;this.find=function(){if(!this.isOpen()){return}d.execCommand("find")};this.replace=function(){if(!this.isOpen()){return}d.execCommand("replace")};this.next=function(){if(!this.isOpen()){return}d.execCommand("findnext")};this.getAnnotations=function(){if(!this.isOpen()){return[]}return e.getAnnotations()};this.setAnnotations=function(b){if(!this.isOpen()){return!1}return e.setAnnotations(b)};this.clearAnnotations=function(){if(!this.isOpen()){return!1}return e.clearAnnotations()};this.langSelection=function(){if(!this.isOpen()){return}var a=b.fileExtension(this.getFileName()),c="text";if(""!==a){c=b.langType(a)}e.setMode("ace/mode/"+c)};this.getEditor=function(){if(!this.isOpen()){return!1}return d};this.setTheme=function(a){if(!this.isOpen()){return}d.setTheme("ace/theme/"+a)};this.open=function(){this.showFileName();if("undefined"==typeof ace){b.loadScript(["../editor/ace9/ace.js","../editor/ace9/ext-language_tools.js"],function(){c.open()});return!1}if(this.isOpen()){return d}var g=this.getFileManager(),h=this.getTId();a(h).removeClass("ui-widget-content ui-tabs-panel");ace.require("ext/language_tools");d=ace.edit("vpl_file"+this.getId());e=d.getSession();d.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0});d.setValue(this.getContent());d.setFontSize(g.getFontSize());d.setTheme("ace/theme/"+g.getTheme());d.$blockScrolling=1/0;d.gotoLine(1,0);d.setReadOnly(f);e.setUseSoftTabs(!0);e.setTabSize(4);e.setUndoManager(new ace.UndoManager);this.setOpen(!0);this.langSelection();d.execCommand("replace");var i=function(){var b=a(h+" div.ace_search");if(b.length){b.on("drop",g.dropHandler);var c=a(".ace_searchbtn_close");c.trigger("click")}else{setTimeout(i,50)}};d.on("change",function(){c.change()});setTimeout(i,5);var j=d.onPaste;d.onPaste=function(a){if(g.restrictedEdit){d.insert(g.getClipboard())}else{j.call(d,a)}};d.on("copy",function(a){g.setClipboard(a.text)});a(h).on("paste","*",g.restrictedPaste);a(h+" div.ace_content").on("drop",g.dropHandler);a(h+" div.ace_content").on("dragover",g.dragoverHandler);a(h).find("div.ace_scroller").css("position","static");this.adjustSize();a(h).find("div.ace_scroller").css("position","absolute");return d};this.close=function(){this.setOpen(!1);if(null===d){return}this.setContent(d.getValue());d.destroy();d=null;e=null}}});
//# sourceMappingURL=vplidecodefile.min.js.map
