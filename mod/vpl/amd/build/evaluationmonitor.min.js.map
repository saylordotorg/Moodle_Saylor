{"version":3,"sources":["../src/evaluationmonitor.js"],"names":["define","VPLUtil","init","options","next","window","location","nexturl","showErrorMessage","message","action","executionActions","ajaxurl","requestAction","done","response","webSocketMonitor","fail"],"mappings":"AAuBAA,OAAM,6BAAC,CAAC,iBAAD,CAAD,CAAsB,SAASC,CAAT,CAAkB,CAC1C,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAkB,CACpBA,CAAO,CAACC,IAAR,CAAe,UAAW,CACtBC,MAAM,CAACC,QAAP,CAAkBH,CAAO,CAACI,OAC7B,CAFD,CASA,QAASC,CAAAA,CAAT,CAA0BC,CAA1B,CAAmC,CAC/BR,CAAO,CAACO,gBAAR,CAAyBC,CAAzB,CAAkC,CAC9BL,IAAI,CAAED,CAAO,CAACC,IADgB,CAAlC,CAGH,CAdmB,GAehBM,CAAAA,CAfgB,CAgBhBC,CAAgB,CAAG,CACnB,QAAWR,CAAO,CAACS,OADA,CAEnB,IAAOJ,CAFY,CAGnB,cAAiB,wBAAW,CACxBE,CAAM,EACT,CALkB,CAhBH,CAuBpBA,CAAM,CAAG,UAAW,CAChBT,CAAO,CAACY,aAAR,CAAsB,UAAtB,CAAkC,YAAlC,CAAgD,EAAhD,CAAoDV,CAAO,CAACS,OAA5D,EACCE,IADD,CAEQ,SAASC,CAAT,CAAmB,CACfd,CAAO,CAACe,gBAAR,CAAyBD,CAAzB,CAAmC,UAAnC,CAA+C,YAA/C,CAA6DJ,CAA7D,EACCG,IADD,CACMX,CAAO,CAACC,IADd,EAECa,IAFD,CAEMT,CAFN,CAGH,CANT,EAQCS,IARD,CAQMT,CARN,CASH,CAVD,CAWAE,CAAM,EACT,CApCE,CAsCV,CAvCK,CAAN","sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Evaluation monitoring\n *\n * @copyright 2013 onward Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\ndefine(['mod_vpl/vplutil'], function(VPLUtil) {\n    return {\n        init: function(options) {\n            options.next = function() {\n                window.location = options.nexturl;\n            };\n            /**\n             * Show a error message in a modal dialog.\n             * Allows to go next evaluation.\n             *\n             * @param {string} message Message to shohw in dialog.\n             */\n            function showErrorMessage(message) {\n                VPLUtil.showErrorMessage(message, {\n                    next: options.next\n                });\n            }\n            var action;\n            var executionActions = {\n                'ajaxurl': options.ajaxurl,\n                'run': showErrorMessage,\n                'getLastAction': function() {\n                    action();\n                },\n            };\n            action = function() {\n                VPLUtil.requestAction('evaluate', 'evaluating', {}, options.ajaxurl)\n                .done(\n                        function(response) {\n                            VPLUtil.webSocketMonitor(response, 'evaluate', 'evaluating', executionActions)\n                            .done(options.next)\n                            .fail(showErrorMessage);\n                        }\n                )\n                .fail(showErrorMessage);\n            };\n            action();\n        }\n    };\n});\n"],"file":"evaluationmonitor.min.js"}