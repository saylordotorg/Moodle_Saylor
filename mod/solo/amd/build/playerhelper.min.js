define(["jquery","mod_solo/conversationconstants"],(function($,constants){return{controls:{},init:function(mediatype){this.initControls(mediatype),this.registerEvents()},initControls:function(mediatype){mediatype===constants.mediatype_video?this.controls.mediaPlayer=$(constants.videoplayer):this.controls.mediaPlayer=$(constants.audioplayer),this.controls.playBtn=$(constants.playbutton),this.controls.prevBtn=$(constants.prevbutton),this.controls.nextBtn=$(constants.nextbutton),this.controls.progressBar=$(constants.progressbar),this.controls.progressLine=$(constants.progressline),this.controls.greenProgress=$(constants.greenprogress),this.controls.progressMarker=$(constants.progressmarker),this.controls.mediaDuration=0,this.controls.timeTotal=$(constants.timetotal),this.controls.timeCurrent=$(constants.timecurrent)},toTimeString:function(date){return date=(date=date.toTimeString().split(" ")[0]).slice(3,8)},moveSlider:function(event){},stepBack:function(){var current=this.controls.mediaPlayer[0].currentTime;current>5?current-=5:current=0,this.controls.mediaPlayer[0].currentTime=current},stepForward:function(){var current=this.controls.mediaPlayer[0].currentTime,duration=this.controls.mediaPlayer[0].duration;current<=duration-5?current+=5:current=duration,this.controls.mediaPlayer[0].currentTime=current},getCoords:function(elem){var box=elem.getBoundingClientRect();return{top:box.top+pageYOffset,left:box.left+pageXOffset}},registerEvents:function(){var c=this.controls,that=this;c.playBtn.click((function(e){e.preventDefault(),"4"==c.mediaPlayer[0].readyState?(c.playBtn.hasClass("playing")?c.mediaPlayer[0].pause():c.mediaPlayer[0].play(),c.playBtn.toggleClass("playing")):alert("No media..")})),c.prevBtn.click((function(e){e.preventDefault(),that.stepBack()})),c.nextBtn.click((function(e){e.preventDefault(),that.stepForward()})),c.progressLine.click((function(e){if(e.preventDefault(),$(e.target).hasClass("progress-marker"))return!1;var positionRatio=e.offsetX/c.progressLine.width(),progressCurrent=100*positionRatio;c.greenProgress.width(progressCurrent+"%"),c.progressMarker.css({left:progressCurrent+"%",opacity:1}),c.mediaPlayer[0].currentTime=c.mediaDuration*positionRatio;var durationCurrent=new Date(0,0,0,0,0,0,c.mediaDuration*positionRatio*1e3);c.timeCurrent.text(that.toTimeString(durationCurrent))})),c.mediaPlayer.on("loadeddata",(function(e){if(c.mediaDuration=c.mediaPlayer[0].duration,!isNaN(c.mediaDuration)&&isFinite(c.mediaDuration)){var duration=new Date(0,0,0,0,0,0,1e3*c.mediaDuration);c.timeTotal.text(that.toTimeString(duration))}c.timeCurrent.text("0:00"),c.progressMarker.css({left:"0%",opacity:1}),c.mediaPlayer.on("timeupdate",(function(ex){var video=c.mediaPlayer[0],leftPosition=100*(video.currentTime/video.duration)+"%";c.greenProgress.width(leftPosition),c.progressMarker.css({left:leftPosition,opacity:1});var currentTime=new Date(0,0,0,0,0,0,1e3*video.currentTime);currentTime=that.toTimeString(currentTime),c.timeCurrent.text(currentTime)}))})),c.mediaPlayer.on("durationchange",(function(e){if(c.mediaDuration=c.mediaPlayer[0].duration,!isNaN(c.mediaDuration)&&isFinite(c.mediaDuration)){var duration=new Date(0,0,0,0,0,0,1e3*c.mediaDuration);c.timeTotal.text(that.toTimeString(duration))}}));var sliderElem=c.progressLine[0],thumbElem=c.progressMarker[0];thumbElem.onmousedown=function(e){var sliderCoords=that.getCoords(sliderElem);document.onmousemove=function(e){var newLeft=e.pageX-sliderCoords.left;newLeft<0&&(newLeft=0);var rightEdge=sliderElem.offsetWidth;newLeft>rightEdge&&(newLeft=rightEdge),thumbElem.style.left=newLeft+"px",c.greenProgress.width(newLeft+"px"),c.mediaPlayer[0].currentTime=c.mediaDuration*(newLeft/rightEdge);var durationCurrent=new Date(0,0,0,0,0,0,c.mediaDuration*(newLeft/rightEdge)*1e3);c.timeCurrent.text(that.toTimeString(durationCurrent))},document.onmouseup=function(e){document.onmousemove=document.onmouseup=null}},thumbElem.ondragstart=function(){return!1}}}}));

//# sourceMappingURL=playerhelper.min.js.map