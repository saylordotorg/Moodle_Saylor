define ("mod_solo/recordercontroller",["jquery","core/log","mod_solo/definitions","mod_solo/cloudpoodllloader","mod_solo/recorderhelper"],function(a,b,c,d,e){"use strict";b.debug("Recorder controller: initialising");return{clone:function clone(){return a.extend(!0,{},this)},init:function init(d){var e=this.clone();if(d.hasOwnProperty("token")){e.activitydata=d}else{var f="#amdopts_"+d.widgetid,g=a(f).get(0);if(g){e.activitydata=JSON.parse(g.value);e.activitydata.widgetid=d.widgetid;a(f).remove()}else{b.debug("solo Recorder Controller: No config found on page. Giving up.");return}}e.cmid=d.cmid;e.recorderid=e.activitydata.recorderid;e.updatecontrolid=e.activitydata.widgetid+"_"+c.C_UPDATECONTROL;e.streamingresultsid=e.activitydata.widgetid+c.C_STREAMINGCONTROL;b.debug(e.activitydata);b.debug("updateid",e.updatecontrolid);if(!e.is_browser_ok()){return}e.setup_recorder()},is_browser_ok:function is_browser_ok(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},setup_recorder:function setup_recorder(){var d=this,f=a(".mod_solo_step2").find("form"),g=a(".mod_solo_uploadwarning"),h=a(".mod_solo_recordingcontainer");e.init(d.activitydata,function on_recording_start(){if(d.activitydata.transcriber==c.transcriber_amazonstreaming){d.streamingresults=[]}},function on_recording_end(){a("button.mod_solo_step2_btn").attr("disabled",!0)},function on_media_processing(b){g.show();var e=a("#"+d.updatecontrolid);e.val(b.mediaurl);if(d.activitydata.transcriber==c.transcriber_amazonstreaming&&d.streamingresults&&0<d.streamingresults.length){var f=a("#"+d.streamingresultsid);f.val(JSON.stringify(d.streamingresults))}h.hide()},function on_speech(a){var e=a.capturedspeech,f=a.speechresults;if(d.activitydata.transcriber==c.transcriber_amazonstreaming){d.streamingresults.push(f);b.debug(d.streamingresults)}},function on_file_submitted(){g.hide();a("button.mod_solo_step2_btn").attr("disabled",!1);a("button.mod_solo_step2_btn").trigger("click")})},process_html:function process_html(){var a=this.activitydata;this.controls={}},register_events:function register_events(){this}}});
//# sourceMappingURL=recordercontroller.min.js.map
