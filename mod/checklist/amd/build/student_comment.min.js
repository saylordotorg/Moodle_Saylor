/**
 * Push student comments to checklist plugin via ajax.
 *
 * @module     mod_checklist/student_comments
 * @copyright  2021 Kristian Ringer <kristian.ringer@gmail.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_checklist/student_comment",["jquery","core/ajax","core/notification","core/str"],(function($,Ajax,Notification,String){return{init:function(cmid){let comments=$(".studentcommentinput"),currentComments=[];for(let i=0;i<comments.length;i+=1){let comment=comments[i];currentComments[i]=comment.value,comment.addEventListener("change",(function(e){const newComment=e.target.value.trim();if(currentComments[i]!==newComment){let classString=e.target.classList[0],checklistitemid=classString.substr(classString.lastIndexOf("studentcommentid")+"studentcommentid".length),spinner="#checklistspinnerstudentcomment"+checklistitemid;$(spinner).css("display","inline-block");let request={methodname:"mod_checklist_update_student_comment",args:{comment:{commenttext:newComment,checklistitemid:checklistitemid,cmid:cmid}}};Ajax.call([request])[0].done((function(data){$(spinner).css("display","none"),!0===data?(currentComments[i]=newComment,comment.defaultValue=newComment):Notification.addNotification({message:String.get_string("update_student_comment_failed","mod_checklist"),type:"error"})})).fail(Notification.exception)}}))}}}}));

//# sourceMappingURL=student_comment.min.js.map