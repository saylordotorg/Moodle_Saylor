{"version":3,"sources":["../src/activitycontroller.js"],"names":["define","$","jqui","log","def","recorderhelper","modelaudiokaraoke","Ajax","notification","smallreporthelper","landr","debug","cmid","activitydata","holderid","recorderid","playerid","sorryboxid","controls","ra_recorder","rec_time_start","enableshadow","enablepreview","enablelandr","letsshadow","streamingresults","passagefinished","clone","extend","init","props","dd","theid","widgetid","configcontrol","get","JSON","parse","value","remove","is_browser_ok","show","setupmodelaudio","setuplandr","setup_recorder","process_html","register_events","domenulayout","doreadinglayout","karaoke_opts","breaks","audioplayerclass","landr_opts","language","region","phonetics","ds_only","opts","hider","introbox","progresscontainer","feedbackcontainer","errorcontainer","passagecontainer","recordingcontainer","dummyrecorder","recordercontainer","menubuttonscontainer","menuinstructionscontainer","previewinstructionscontainer","landrinstructionscontainer","activityinstructionscontainer","recinstructionscontainerright","recinstructionscontainerleft","allowearlyexit","wheretonextcontainer","modelaudioplayer","startlandrbutton","startpreviewbutton","startreadingbutton","startshadowbutton","returnmenubutton","stopandplay","smallreportcontainer","navigator","mediaDevices","getUserMedia","beginall","passagerecorded","play","on_recording_start","Date","getTime","dopassagelayout","transcriber","transcriber_amazonstreaming","on_recording_end","now","douploadlayout","currentTime","pause","on_audio_processing","eventdata","rectime","Math","ceil","length","setTimeout","send_streaming_submission","mediaurl","send_submission","dofinishedlayout","on_speech","speech","capturedspeech","speechresults","push","click","dopreviewlayout","keypress","e","which","preventDefault","dolandrlayout","isandroid","is","location","reload","that","filename","call","methodname","args","awsresults","stringify","done","ajaxresult","payloadobject","success","message","fail","exception","m","fadeOut","hide","removeClass","addClass","deactivate","activate","fadeIn","doerrorlayout","test","userAgent"],"mappings":"AACAA,OAAM,oCAAC,CAAC,QAAD,CAAW,UAAX,CAAuB,UAAvB,CAAmC,2BAAnC,CACC,8BADD,CACiC,iCADjC,CAEC,WAFD,CAEa,mBAFb,CAEiC,iCAFjC,CAEmE,+BAFnE,CAAD,CAGF,SAAUC,CAAV,CAAaC,CAAb,CAAmBC,CAAnB,CAAwBC,CAAxB,CAA6BC,CAA7B,CAA6CC,CAA7C,CAAgEC,CAAhE,CAAsEC,CAAtE,CAAoFC,CAApF,CAAuGC,CAAvG,CAA8G,CAE9G,aAEAP,CAAG,CAACQ,KAAJ,CAAU,mCAAV,EAEA,MAAO,CAEHC,IAAI,CAAE,IAFH,CAGHC,YAAY,CAAE,IAHX,CAIHC,QAAQ,CAAE,IAJP,CAKHC,UAAU,CAAE,IALT,CAMHC,QAAQ,CAAE,IANP,CAOHC,UAAU,CAAE,IAPT,CAQHC,QAAQ,CAAE,IARP,CASHC,WAAW,CAAE,IATV,CAUHC,cAAc,CAAE,CAVb,CAWHC,YAAY,GAXT,CAYHC,aAAa,GAZV,CAaHC,WAAW,GAbR,CAcHC,UAAU,GAdP,CAeHC,gBAAgB,GAfb,CAkBHC,eAAe,CAAEtB,CAAG,CAACsB,eAlBlB,CAqBHC,KAAK,CAAE,gBAAY,CACf,MAAO1B,CAAAA,CAAC,CAAC2B,MAAF,IAAe,EAAf,CAAmB,IAAnB,CACV,CAvBE,CA0BHC,IAAI,CAAE,cAAUC,CAAV,CAAiB,IACfC,CAAAA,CAAE,CAAG,KAAKJ,KAAL,EADU,CAIfK,CAAK,CAAG,YAAcF,CAAK,CAACG,QAJb,CAKfC,CAAa,CAAGjC,CAAC,CAAC+B,CAAD,CAAD,CAASG,GAAT,CAAa,CAAb,CALD,CAMnB,GAAID,CAAJ,CAAmB,CACfH,CAAE,CAAClB,YAAH,CAAkBuB,IAAI,CAACC,KAAL,CAAWH,CAAa,CAACI,KAAzB,CAAlB,CACArC,CAAC,CAAC+B,CAAD,CAAD,CAASO,MAAT,EACH,CAHD,IAGO,CAEHpC,CAAG,CAACQ,KAAJ,CAAU,iEAAV,EACA,MACH,CAEDoB,CAAE,CAACnB,IAAH,CAAUkB,CAAK,CAAClB,IAAhB,CACAmB,CAAE,CAACjB,QAAH,CAAcgB,CAAK,CAACG,QAAN,CAAiB,SAA/B,CACAF,CAAE,CAAChB,UAAH,CAAgBe,CAAK,CAACG,QAAN,CAAiB,WAAjC,CACAF,CAAE,CAACf,QAAH,CAAcc,CAAK,CAACG,QAAN,CAAiB,SAA/B,CACAF,CAAE,CAACd,UAAH,CAAgBa,CAAK,CAACG,QAAN,CAAiB,WAAjC,CAIA,GAAI,CAACF,CAAE,CAACS,aAAH,EAAL,CAAyB,CACrBvC,CAAC,CAAC,IAAM8B,CAAE,CAACd,UAAV,CAAD,CAAuBwB,IAAvB,GACA,MACH,CAGDV,CAAE,CAACV,YAAH,CAAiBU,CAAE,CAAClB,YAAH,CAAgBQ,YAAjC,CACAU,CAAE,CAACT,aAAH,CAAkBS,CAAE,CAAClB,YAAH,CAAgBS,aAAlC,CACAS,CAAE,CAACR,WAAH,CAAgBQ,CAAE,CAAClB,YAAH,CAAgBU,WAAhC,CACAQ,CAAE,CAACW,eAAH,GAGAX,CAAE,CAACY,UAAH,GAIAZ,CAAE,CAACa,cAAH,GACAb,CAAE,CAACc,YAAH,CAAgBd,CAAE,CAAClB,YAAnB,EACAkB,CAAE,CAACe,eAAH,GAIA,GAAGf,CAAE,CAACV,YAAH,EAAmBU,CAAE,CAACT,aAAtB,IAAH,CAA+C,CAC3CS,CAAE,CAACgB,YAAH,EACH,CAFD,IAEK,CACDhB,CAAE,CAACiB,eAAH,EACH,CACJ,CA5EE,CA8EHN,eAAe,CAAE,0BAAU,CACvB,GAAIO,CAAAA,CAAY,CAAC,CAACC,MAAM,CAAC,KAAKrC,YAAL,CAAkBqC,MAA1B,CAAkCC,gBAAgB,CAAC,KAAKtC,YAAL,CAAkBsC,gBAArE,CAAjB,CACA7C,CAAiB,CAACuB,IAAlB,CAAuBoB,CAAvB,CACH,CAjFE,CAmFHN,UAAU,CAAE,qBAAU,CAClB,GAAIS,CAAAA,CAAU,CAAC,CAAC9C,iBAAiB,CAAEA,CAApB,CAAuCM,IAAI,CAAE,KAAKA,IAAlD,CAAwDyC,QAAQ,CAAE,KAAKxC,YAAL,CAAkBwC,QAApF,CACXC,MAAM,CAAE,KAAKzC,YAAL,CAAkByC,MADf,CACuBC,SAAS,CAAE,KAAK1C,YAAL,CAAkB0C,SADpD,CAC+DC,OAAO,CAAE,KAAK3C,YAAL,CAAkB2C,OAD1F,CAAf,CAEA9C,CAAK,CAACmB,IAAN,CAAWuB,CAAX,CACH,CAvFE,CAyFHP,YAAY,CAAE,sBAAUY,CAAV,CAAgB,CAI1B,GAAIvC,CAAAA,CAAQ,CAAG,CACXwC,KAAK,CAAEzD,CAAC,CAAC,IAAMwD,CAAI,MAAX,CADG,CAEXE,QAAQ,CAAE1D,CAAC,kBAFA,CAGX2D,iBAAiB,CAAE3D,CAAC,CAAC,IAAMwD,CAAI,kBAAX,CAHT,CAIXI,iBAAiB,CAAE5D,CAAC,CAAC,IAAMwD,CAAI,kBAAX,CAJT,CAKXK,cAAc,CAAE7D,CAAC,CAAC,IAAMwD,CAAI,eAAX,CALN,CAMXM,gBAAgB,CAAE9D,CAAC,CAAC,IAAMwD,CAAI,iBAAX,CANR,CAOXO,kBAAkB,CAAE/D,CAAC,CAAC,IAAMwD,CAAI,mBAAX,CAPV,CAQXQ,aAAa,CAAEhE,CAAC,CAAC,IAAMwD,CAAI,cAAX,CARL,CASXS,iBAAiB,CAAEjE,CAAC,CAAC,IAAMwD,CAAI,kBAAX,CATT,CAUXU,oBAAoB,CAAElE,CAAC,CAAC,IAAMwD,CAAI,qBAAX,CAVZ,CAWXW,yBAAyB,CAAEnE,CAAC,CAAC,IAAMwD,CAAI,0BAAX,CAXjB,CAYXY,4BAA4B,CAAEpE,CAAC,CAAC,IAAMwD,CAAI,6BAAX,CAZpB,CAaXa,0BAA0B,CAAErE,CAAC,CAAC,IAAMwD,CAAI,2BAAX,CAblB,CAcXc,6BAA6B,CAAEtE,CAAC,CAAC,IAAMwD,CAAI,8BAAX,CAdrB,CAeXe,6BAA6B,CAAEvE,CAAC,CAAC,IAAMwD,CAAI,8BAAX,CAfrB,CAgBXgB,4BAA4B,CAAExE,CAAC,CAAC,IAAMwD,CAAI,6BAAX,CAhBpB,CAiBXiB,cAAc,CAAEzE,CAAC,CAAC,IAAMwD,CAAI,eAAX,CAjBN,CAkBXkB,oBAAoB,CAAE1E,CAAC,CAAC,IAAMwD,CAAI,qBAAX,CAlBZ,CAmBXmB,gBAAgB,CAAE3E,CAAC,CAAC,IAAMwD,CAAI,iBAAX,CAnBR,CAoBXoB,gBAAgB,CAAE5E,CAAC,CAAC,IAAMwD,CAAI,iBAAX,CApBR,CAqBXqB,kBAAkB,CAAE7E,CAAC,CAAC,IAAMwD,CAAI,mBAAX,CArBV,CAsBXsB,kBAAkB,CAAE9E,CAAC,CAAC,IAAMwD,CAAI,mBAAX,CAtBV,CAuBXuB,iBAAiB,CAAE/E,CAAC,CAAC,IAAMwD,CAAI,kBAAX,CAvBT,CAwBXwB,gBAAgB,CAAEhF,CAAC,CAAC,IAAMwD,CAAI,iBAAX,CAxBR,CAyBXyB,WAAW,CAAEjF,CAAC,CAAC,IAAMwD,CAAI,YAAX,CAzBH,CA0BX0B,oBAAoB,CAAElF,CAAC,CAAC,IAAMwD,CAAI,qBAAX,CA1BZ,CAAf,CA4BA,KAAKvC,QAAL,CAAgBA,CACnB,CA1HE,CA4HHsB,aAAa,CAAE,wBAAY,CACvB,MAAQ4C,CAAAA,SAAS,EAAIA,SAAS,CAACC,YAAvB,EACDD,SAAS,CAACC,YAAV,CAAuBC,YACjC,CA/HE,CAiIH1C,cAAc,CAAE,yBAAY,IACpBb,CAAAA,CAAE,CAAG,IADe,CAIpBwD,CAAQ,CAAE,UAAU,CACpBxD,CAAE,CAACyD,eAAH,IACA,GAAGzD,CAAE,CAACV,YAAH,EAAmBU,CAAE,CAACP,UAAzB,CAAoC,CAChCO,CAAE,CAACb,QAAH,CAAY0D,gBAAZ,CAA6B,CAA7B,EAAgCa,IAAhC,EACH,CACJ,CATuB,CA8ExBpF,CAAc,CAACwB,IAAf,CAAoBE,CAAE,CAAClB,YAAvB,CAvDyB,QAArB6E,CAAAA,kBAAqB,EAAqB,CAC1C3D,CAAE,CAACX,cAAH,CAAoB,GAAIuE,CAAAA,IAAJ,GAAWC,OAAX,EAApB,CACA7D,CAAE,CAAC8D,eAAH,GACA9D,CAAE,CAACb,QAAH,CAAY6C,gBAAZ,CAA6BtB,IAA7B,CAAkC,GAAlC,CAAwC8C,CAAxC,EAGA,GAAGxD,CAAE,CAAClB,YAAH,CAAgBiF,WAAhB,EAA+B1F,CAAG,CAAC2F,2BAAtC,CAAmE,CAE/DhE,CAAE,CAACN,gBAAH,CAAsB,EACzB,CACJ,CA6CD,CAxCuB,QAAnBuE,CAAAA,gBAAmB,EAAqB,CAExC,GAAIC,CAAAA,CAAG,CAAG,GAAIN,CAAAA,IAAJ,GAAWC,OAAX,EAAV,CACA,GAAgC,GAA5B,CAACK,CAAG,CAAGlE,CAAE,CAACX,cAAd,CAAsC,CAClC,MACH,CACDW,CAAE,CAACmE,cAAH,GAEA,GAAGnE,CAAE,CAACV,YAAH,EAAmBU,CAAE,CAACP,UAAzB,CAAoC,CAChCO,CAAE,CAACb,QAAH,CAAY0D,gBAAZ,CAA6B,CAA7B,EAAgCuB,WAAhC,CAA4C,CAA5C,CACApE,CAAE,CAACb,QAAH,CAAY0D,gBAAZ,CAA6B,CAA7B,EAAgCwB,KAAhC,EACH,CACJ,CA4BD,CAxB0B,QAAtBC,CAAAA,mBAAsB,CAAUC,CAAV,CAAqB,IAGvCL,CAAAA,CAAG,CAAG,GAAIN,CAAAA,IAAJ,GAAWC,OAAX,EAHiC,CAIvCW,CAAO,CAAGN,CAAG,CAAGlE,CAAE,CAACX,cAJoB,CAK3C,GAAc,CAAV,CAAAmF,CAAJ,CAAiB,CACbA,CAAO,CAAGC,IAAI,CAACC,IAAL,CAAUF,CAAO,CAAG,GAApB,CACb,CAED,GAAGxE,CAAE,CAAClB,YAAH,CAAgBiF,WAAhB,EAA+B1F,CAAG,CAAC2F,2BAAnC,EACChE,CAAE,CAACN,gBADJ,EAE8B,CAA7B,CAAAM,CAAE,CAACN,gBAAH,CAAoBiF,MAFxB,CAEmC,CAE/BC,UAAU,CAAC5E,CAAE,CAAC6E,yBAAJ,CAA8B,IAA9B,CAAmC7E,CAAnC,CAAuCuE,CAAS,CAACO,QAAjD,CAA2DN,CAA3D,CAEb,CAND,IAMM,CACFxE,CAAE,CAAC+E,eAAH,CAAmBR,CAAS,CAACO,QAA7B,CAAuCN,CAAvC,EAEAxE,CAAE,CAACgF,gBAAH,EACH,CAEJ,CAGD,CAnEgB,QAAZC,CAAAA,SAAY,CAAUV,CAAV,CAAqB,IAC7BW,CAAAA,CAAM,CAAGX,CAAS,CAACY,cADU,CAE7BC,CAAa,CAAGb,CAAS,CAACa,aAFG,CAGjC,GAAGpF,CAAE,CAAClB,YAAH,CAAgBiF,WAAhB,EAA+B1F,CAAG,CAAC2F,2BAAtC,CAAmE,CAC/DhE,CAAE,CAACN,gBAAH,CAAoB2F,IAApB,CAAyBD,CAAzB,EACAhH,CAAG,CAACQ,KAAJ,CAAUoB,CAAE,CAACN,gBAAb,CACH,CACJ,CA4DD,CAKH,CApNE,CAsNHqB,eAAe,CAAE,0BAAY,CACzB,GAAIf,CAAAA,CAAE,CAAG,IAAT,CAGAA,CAAE,CAACb,QAAH,CAAY4D,kBAAZ,CAA+BuC,KAA/B,CAAqC,UAAW,CAC5CtF,CAAE,CAACuF,eAAH,EACH,CAFD,EAGAvF,CAAE,CAACb,QAAH,CAAY4D,kBAAZ,CAA+ByC,QAA/B,CAAwC,SAASC,CAAT,CAAW,CAC/C,GAAe,EAAX,EAAAA,CAAC,CAACC,KAAF,EAA4B,EAAX,EAAAD,CAAC,CAACC,KAAvB,CAAqC,CACjC1F,CAAE,CAACuF,eAAH,GACAE,CAAC,CAACE,cAAF,EACH,CACJ,CALD,EAMA3F,CAAE,CAACb,QAAH,CAAY2D,gBAAZ,CAA6BwC,KAA7B,CAAmC,UAAW,CAC1CtF,CAAE,CAAC4F,aAAH,EACH,CAFD,EAGA5F,CAAE,CAACb,QAAH,CAAY2D,gBAAZ,CAA6B0C,QAA7B,CAAsC,SAASC,CAAT,CAAW,CAC7C,GAAe,EAAX,EAAAA,CAAC,CAACC,KAAF,EAA4B,EAAX,EAAAD,CAAC,CAACC,KAAvB,CAAqC,CACjC1F,CAAE,CAAC4F,aAAH,GACAH,CAAC,CAACE,cAAF,EACH,CACJ,CALD,EAMA3F,CAAE,CAACb,QAAH,CAAY6D,kBAAZ,CAA+BsC,KAA/B,CAAqC,UAAW,CAC5CtF,CAAE,CAACP,UAAH,IACAO,CAAE,CAACiB,eAAH,EACH,CAHD,EAIAjB,CAAE,CAACb,QAAH,CAAY6D,kBAAZ,CAA+BwC,QAA/B,CAAwC,SAASC,CAAT,CAAW,CAC/C,GAAe,EAAX,EAAAA,CAAC,CAACC,KAAF,EAA4B,EAAX,EAAAD,CAAC,CAACC,KAAvB,CAAoC,CAChC1F,CAAE,CAACP,UAAH,IACAO,CAAE,CAACiB,eAAH,GACAwE,CAAC,CAACE,cAAF,EACH,CACJ,CAND,EAOA3F,CAAE,CAACb,QAAH,CAAY8D,iBAAZ,CAA8BqC,KAA9B,CAAoC,UAAW,CAC3CtF,CAAE,CAACP,UAAH,IACAO,CAAE,CAACiB,eAAH,EACH,CAHD,EAIAjB,CAAE,CAACb,QAAH,CAAY8D,iBAAZ,CAA8BuC,QAA9B,CAAuC,SAASC,CAAT,CAAW,CAC9C,GAAe,EAAX,EAAAA,CAAC,CAACC,KAAF,EAA4B,EAAX,EAAAD,CAAC,CAACC,KAAvB,CAAoC,CAChC1F,CAAE,CAACP,UAAH,IACAO,CAAE,CAACiB,eAAH,GACAwE,CAAC,CAACE,cAAF,EACH,CACJ,CAND,EAOA3F,CAAE,CAACb,QAAH,CAAY+D,gBAAZ,CAA6BoC,KAA7B,CAAmC,UAAW,CAE1C,GAAGtF,CAAE,CAAC6F,SAAH,IAAkB7F,CAAE,CAACb,QAAH,CAAYoD,0BAAZ,CAAuCuD,EAAvC,CAA0C,UAA1C,CAArB,CAA2E,CACvEC,QAAQ,CAACC,MAAT,EACH,CAFD,IAEM,CACFhG,CAAE,CAACb,QAAH,CAAY0D,gBAAZ,CAA6B,CAA7B,EAAgCuB,WAAhC,CAA8C,CAA9C,CACApE,CAAE,CAACb,QAAH,CAAY0D,gBAAZ,CAA6B,CAA7B,EAAgCwB,KAAhC,GACArE,CAAE,CAACgB,YAAH,EACH,CACJ,CATD,CAUH,CA5QE,CA+QH6D,yBAAyB,CAAE,mCAAUoB,CAAV,CAAgBC,CAAhB,CAA0B1B,CAA1B,CAAmC,CAE1D,GAAI9E,CAAAA,CAAgB,CAACuG,CAAI,CAACvG,gBAA1B,CACAlB,CAAI,CAAC2H,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,wCADL,CAEPC,IAAI,CAAE,CACFxH,IAAI,CAAEoH,CAAI,CAACpH,IADT,CAEFqH,QAAQ,CAAEA,CAFR,CAGF1B,OAAO,CAAEA,CAHP,CAIF8B,UAAU,CAAEjG,IAAI,CAACkG,SAAL,CAAe7G,CAAf,CAJV,CAFC,CAQP8G,IAAI,CAAE,cAAUC,CAAV,CAAsB,CACxB,GAAIC,CAAAA,CAAa,CAAGrG,IAAI,CAACC,KAAL,CAAWmG,CAAX,CAApB,CACA,GAAIC,CAAJ,CAAmB,CACf,OAAQA,CAAa,CAACC,OAAtB,EACI,OACIvI,CAAG,CAACQ,KAAJ,CAAU,+BAAV,EAEA,MAEJ,OACA,QACIR,CAAG,CAACQ,KAAJ,CAAU,mCAAV,EACA,GAAI8H,CAAa,CAACE,OAAlB,CAA2B,CACvBxI,CAAG,CAACQ,KAAJ,CAAU,YAAc8H,CAAa,CAACE,OAAtC,CACH,CAXT,CAaH,CAEDX,CAAI,CAACjB,gBAAL,EACH,CA3BM,CA4BP6B,IAAI,CAAEpI,CAAY,CAACqI,SA5BZ,CAAD,CAAV,CA8BH,CAhTE,CAkTH/B,eAAe,CAAE,yBAAUmB,CAAV,CAAoB1B,CAApB,CAA6B,CAC1C,GAAIyB,CAAAA,CAAI,CAAG,IAAX,CACAzH,CAAI,CAAC2H,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,sCADL,CAEPC,IAAI,CAAE,CACFxH,IAAI,CAAEoH,CAAI,CAACpH,IADT,CAEFqH,QAAQ,CAAGA,CAFT,CAGF1B,OAAO,CAAEA,CAHP,CAFC,CAOPgC,IAAI,CAAE,cAASC,CAAT,CAAoB,CACtB,GAAIC,CAAAA,CAAa,CAAGrG,IAAI,CAACC,KAAL,CAAWmG,CAAX,CAApB,CACA,GAAIC,CAAJ,CAAmB,CACf,OAAQA,CAAa,CAACC,OAAtB,EACI,OACIvI,CAAG,CAACQ,KAAJ,CAAU,+BAAV,EAEA,MAEJ,OACA,QACIR,CAAG,CAACQ,KAAJ,CAAU,mCAAV,EACA,GAAI8H,CAAa,CAACE,OAAlB,CAA2B,CACvBxI,CAAG,CAACQ,KAAJ,CAAU,YAAc8H,CAAa,CAACE,OAAtC,CACH,CAXT,CAaH,CACJ,CAxBM,CAyBPC,IAAI,CAAEpI,CAAY,CAACqI,SAzBZ,CAAD,CAAV,CAuEH,CA3XE,CA6XH7F,eAAe,CAAE,0BAAY,CACzB,GAAI8F,CAAAA,CAAC,CAAG,IAAR,CACAA,CAAC,CAAC5H,QAAF,CAAWwC,KAAX,CAAiBqF,OAAjB,CAAyB,MAAzB,EACAD,CAAC,CAAC5H,QAAF,CAAWqD,6BAAX,CAAyC9B,IAAzC,GACAqG,CAAC,CAAC5H,QAAF,CAAW8C,kBAAX,CAA8BvB,IAA9B,GACAqG,CAAC,CAAC5H,QAAF,CAAWyC,QAAX,CAAoBqF,IAApB,GACAF,CAAC,CAAC5H,QAAF,CAAWkD,yBAAX,CAAqC4E,IAArC,GACAF,CAAC,CAAC5H,QAAF,CAAWiD,oBAAX,CAAgC6E,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWiE,oBAAX,CAAgC6D,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAW+D,gBAAX,CAA4BxC,IAA5B,GACAqG,CAAC,CAAC5H,QAAF,CAAW0C,iBAAX,CAA6BoF,IAA7B,GACAF,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BkF,WAA5B,CAAwC,+CAAxC,EACAH,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BmF,QAA5B,CAAqC,UAArC,EACAJ,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BiF,IAA5B,GACAF,CAAC,CAAC5H,QAAF,CAAW2C,iBAAX,CAA6BmF,IAA7B,GACAF,CAAC,CAAC5H,QAAF,CAAWyD,oBAAX,CAAgCqE,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWgE,WAAX,CAAuB8D,IAAvB,EACH,CA9YE,CAgZHjG,YAAY,CAAE,uBAAY,CACtB,GAAI+F,CAAAA,CAAC,CAAG,IAAR,CACAA,CAAC,CAAC5H,QAAF,CAAWyC,QAAX,CAAoBlB,IAApB,GACAqG,CAAC,CAAC5H,QAAF,CAAWkD,yBAAX,CAAqC3B,IAArC,GACAqG,CAAC,CAAC5H,QAAF,CAAWiD,oBAAX,CAAgC1B,IAAhC,GACAqG,CAAC,CAAC5H,QAAF,CAAWiE,oBAAX,CAAgC1C,IAAhC,GACAqG,CAAC,CAAC5H,QAAF,CAAWqD,6BAAX,CAAyCyE,IAAzC,GACAF,CAAC,CAAC5H,QAAF,CAAW+D,gBAAX,CAA4B+D,IAA5B,GACAF,CAAC,CAAC5H,QAAF,CAAWmD,4BAAX,CAAwC2E,IAAxC,GAEAF,CAAC,CAAC5H,QAAF,CAAWoD,0BAAX,CAAsC0E,IAAtC,GACAtI,CAAK,CAACyI,UAAN,GAEAL,CAAC,CAAC5H,QAAF,CAAW0C,iBAAX,CAA6BoF,IAA7B,GACAF,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BiF,IAA5B,GACAF,CAAC,CAAC5H,QAAF,CAAW8C,kBAAX,CAA8BgF,IAA9B,GACAF,CAAC,CAAC5H,QAAF,CAAW2C,iBAAX,CAA6BmF,IAA7B,GACAF,CAAC,CAAC5H,QAAF,CAAWyD,oBAAX,CAAgCqE,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAW0D,gBAAX,CAA4BoE,IAA5B,GACAF,CAAC,CAAC5H,QAAF,CAAWwC,KAAX,CAAiBsF,IAAjB,GACAF,CAAC,CAAC5H,QAAF,CAAWgE,WAAX,CAAuB8D,IAAvB,EACH,CAraE,CAuaH1B,eAAe,CAAE,0BAAY,CACzB,GAAIwB,CAAAA,CAAC,CAAG,IAAR,CACAA,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BkF,WAA5B,CAAwC,4CAAxC,EACAH,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BmF,QAA5B,CAAqC,aAArC,EACAJ,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BtB,IAA5B,GACAqG,CAAC,CAAC5H,QAAF,CAAWmD,4BAAX,CAAwC5B,IAAxC,GACAqG,CAAC,CAAC5H,QAAF,CAAWoD,0BAAX,CAAsC0E,IAAtC,GACAF,CAAC,CAAC5H,QAAF,CAAWyC,QAAX,CAAoBqF,IAApB,GACAF,CAAC,CAAC5H,QAAF,CAAW+D,gBAAX,CAA4BxC,IAA5B,GACAqG,CAAC,CAAC5H,QAAF,CAAW0D,gBAAX,CAA4BoE,IAA5B,GACAF,CAAC,CAAC5H,QAAF,CAAWiE,oBAAX,CAAgC6D,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWgE,WAAX,CAAuBzC,IAAvB,GACAqG,CAAC,CAAC5H,QAAF,CAAWiD,oBAAX,CAAgC6E,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWwC,KAAX,CAAiBsF,IAAjB,GACAF,CAAC,CAAC5H,QAAF,CAAW0C,iBAAX,CAA6BoF,IAA7B,GACAF,CAAC,CAAC5H,QAAF,CAAWkD,yBAAX,CAAqC4E,IAArC,GACAF,CAAC,CAAC5H,QAAF,CAAWqD,6BAAX,CAAyCyE,IAAzC,GACAF,CAAC,CAAC5H,QAAF,CAAW8C,kBAAX,CAA8BgF,IAA9B,GACAF,CAAC,CAAC5H,QAAF,CAAW2C,iBAAX,CAA6BmF,IAA7B,GACAF,CAAC,CAAC5H,QAAF,CAAWyD,oBAAX,CAAgCqE,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWgE,WAAX,CAAuBzC,IAAvB,EACH,CA5bE,CA8bHkF,aAAa,CAAE,wBAAY,CACvB,GAAImB,CAAAA,CAAC,CAAG,IAAR,CACAA,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BkF,WAA5B,CAAwC,4CAAxC,EACAH,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BmF,QAA5B,CAAqC,aAArC,EACAJ,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BtB,IAA5B,GACAqG,CAAC,CAAC5H,QAAF,CAAWoD,0BAAX,CAAsC7B,IAAtC,GACAqG,CAAC,CAAC5H,QAAF,CAAWmD,4BAAX,CAAwC2E,IAAxC,GACAF,CAAC,CAAC5H,QAAF,CAAWyC,QAAX,CAAoBqF,IAApB,GACAF,CAAC,CAAC5H,QAAF,CAAW+D,gBAAX,CAA4BxC,IAA5B,GACAqG,CAAC,CAAC5H,QAAF,CAAW0D,gBAAX,CAA4BoE,IAA5B,GACAF,CAAC,CAAC5H,QAAF,CAAWiE,oBAAX,CAAgC6D,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWgE,WAAX,CAAuBzC,IAAvB,GACAqG,CAAC,CAAC5H,QAAF,CAAWiD,oBAAX,CAAgC6E,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWwC,KAAX,CAAiBsF,IAAjB,GACAF,CAAC,CAAC5H,QAAF,CAAW0C,iBAAX,CAA6BoF,IAA7B,GACAF,CAAC,CAAC5H,QAAF,CAAWkD,yBAAX,CAAqC4E,IAArC,GACAF,CAAC,CAAC5H,QAAF,CAAWqD,6BAAX,CAAyCyE,IAAzC,GACAF,CAAC,CAAC5H,QAAF,CAAW8C,kBAAX,CAA8BgF,IAA9B,GACAF,CAAC,CAAC5H,QAAF,CAAW2C,iBAAX,CAA6BmF,IAA7B,GACAF,CAAC,CAAC5H,QAAF,CAAWyD,oBAAX,CAAgCqE,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWgE,WAAX,CAAuBzC,IAAvB,GACA/B,CAAK,CAAC0I,QAAN,EACH,CApdE,CAsdHvD,eAAe,CAAE,0BAAY,CACzB,GAAIiD,CAAAA,CAAC,CAAG,IAAR,CACAA,CAAC,CAAC5H,QAAF,CAAWyC,QAAX,CAAoBqF,IAApB,EACH,CAzdE,CA2dH9C,cAAc,CAAE,yBAAY,CACxB,GAAI4C,CAAAA,CAAC,CAAG,IAAR,CACAA,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BmF,QAA5B,CAAqCJ,CAAC,CAACpH,eAAvC,EACAoH,CAAC,CAAC5H,QAAF,CAAWwC,KAAX,CAAiB2F,MAAjB,CAAwB,MAAxB,EACAP,CAAC,CAAC5H,QAAF,CAAW0C,iBAAX,CAA6ByF,MAA7B,CAAoC,MAApC,CACH,CAheE,CAkeHtC,gBAAgB,CAAE,2BAAY,CAC1B,GAAI+B,CAAAA,CAAC,CAAG,IAAR,CACAA,CAAC,CAAC5H,QAAF,CAAWwC,KAAX,CAAiBqF,OAAjB,CAAyB,MAAzB,EACAD,CAAC,CAAC5H,QAAF,CAAW0C,iBAAX,CAA6BmF,OAA7B,CAAqC,MAArC,EACAD,CAAC,CAAC5H,QAAF,CAAWiE,oBAAX,CAAgC6D,IAAhC,GACAF,CAAC,CAAC5H,QAAF,CAAWqD,6BAAX,CAAyCyE,IAAzC,GACAF,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BiF,IAA5B,GACAF,CAAC,CAAC5H,QAAF,CAAW8C,kBAAX,CAA8BgF,IAA9B,GACAF,CAAC,CAAC5H,QAAF,CAAW2C,iBAAX,CAA6BpB,IAA7B,GACAqG,CAAC,CAAC5H,QAAF,CAAWyD,oBAAX,CAAgClC,IAAhC,GACAqG,CAAC,CAAC5H,QAAF,CAAW+D,gBAAX,CAA4B+D,IAA5B,EAEH,CA9eE,CA+eHM,aAAa,CAAE,wBAAY,CACvB,GAAIR,CAAAA,CAAC,CAAG,IAAR,CACAA,CAAC,CAAC5H,QAAF,CAAWwC,KAAX,CAAiBqF,OAAjB,CAAyB,MAAzB,EACAD,CAAC,CAAC5H,QAAF,CAAW0C,iBAAX,CAA6BmF,OAA7B,CAAqC,MAArC,EACAD,CAAC,CAAC5H,QAAF,CAAW6C,gBAAX,CAA4BiF,IAA5B,GACAF,CAAC,CAAC5H,QAAF,CAAW8C,kBAAX,CAA8BgF,IAA9B,GACAF,CAAC,CAAC5H,QAAF,CAAW4C,cAAX,CAA0BrB,IAA1B,GACAqG,CAAC,CAAC5H,QAAF,CAAWyD,oBAAX,CAAgClC,IAAhC,EACH,CAvfE,CAwfHmF,SAAS,CAAE,oBAAW,CACd,GAAI,WAAW2B,IAAX,CAAgBnE,SAAS,CAACoE,SAA1B,CAAJ,CAA0C,CACtC,QACH,CAFD,IAEO,CACH,QACH,CACR,CA9fE,CAggBV,CAzgBK,CAAN","sourcesContent":["/* jshint ignore:start */\ndefine(['jquery', 'jqueryui', 'core/log', 'mod_readaloud/definitions',\n        'mod_readaloud/recorderhelper', 'mod_readaloud/modelaudiokaraoke',\n        'core/ajax','core/notification','mod_readaloud/smallreporthelper','mod_readaloud/listenandrepeat'],\n    function ($, jqui, log, def, recorderhelper, modelaudiokaraoke, Ajax, notification, smallreporthelper, landr) {\n\n    \"use strict\"; // jshint ;_;\n\n    log.debug('Activity controller: initialising');\n\n    return {\n\n        cmid: null,\n        activitydata: null,\n        holderid: null,\n        recorderid: null,\n        playerid: null,\n        sorryboxid: null,\n        controls: null,\n        ra_recorder: null,\n        rec_time_start: 0,\n        enableshadow: false,\n        enablepreview: false,\n        enablelandr: false,\n        letsshadow: false,\n        streamingresults: false,\n\n        //CSS in this file\n        passagefinished: def.passagefinished,\n\n        //for making multiple instances\n        clone: function () {\n            return $.extend(true, {}, this);\n        },\n\n        //pass in config, the jquery video/audio object, and a function to be called when conversion has finshed\n        init: function (props) {\n            var dd = this.clone();\n\n            //pick up opts from html\n            var theid = '#amdopts_' + props.widgetid;\n            var configcontrol = $(theid).get(0);\n            if (configcontrol) {\n                dd.activitydata = JSON.parse(configcontrol.value);\n                $(theid).remove();\n            } else {\n                //if there is no config we might as well give up\n                log.debug('Read Aloud Test Controller: No config found on page. Giving up.');\n                return;\n            }\n\n            dd.cmid = props.cmid;\n            dd.holderid = props.widgetid + '_holder';\n            dd.recorderid = props.widgetid + '_recorder';\n            dd.playerid = props.widgetid + '_player';\n            dd.sorryboxid = props.widgetid + '_sorrybox';\n\n            //if the browser doesn't support html5 recording.\n            //then warn and do not go any further\n            if (!dd.is_browser_ok()) {\n                $('#' + dd.sorryboxid).show();\n                return;\n            }\n\n            //set up model audio\n            dd.enableshadow =dd.activitydata.enableshadow;\n            dd.enablepreview =dd.activitydata.enablepreview;\n            dd.enablelandr =dd.activitydata.enablelandr;\n            dd.setupmodelaudio();\n\n            //set up listen an repeat\n            dd.setuplandr();\n\n\n            //init recorder and html and events\n            dd.setup_recorder();\n            dd.process_html(dd.activitydata);\n            dd.register_events();\n\n            //set initial mode\n            //we used to check the settings but now we just show the non-options greyed out\n            if(dd.enableshadow || dd.enablepreview || true){\n                dd.domenulayout();\n            }else{\n                dd.doreadinglayout();\n            }\n        },\n\n        setupmodelaudio: function(){\n            var karaoke_opts={breaks:this.activitydata.breaks, audioplayerclass:this.activitydata.audioplayerclass };\n            modelaudiokaraoke.init(karaoke_opts);\n        },\n\n        setuplandr: function(){\n            var landr_opts={modelaudiokaraoke: modelaudiokaraoke, cmid: this.cmid, language: this.activitydata.language,\n                region: this.activitydata.region, phonetics: this.activitydata.phonetics, ds_only: this.activitydata.ds_only};\n            landr.init(landr_opts);\n        },\n\n        process_html: function (opts) {\n\n            //these css classes/ids are all passed in from php in\n            //renderer.php::fetch_activity_amd should maybe just simplify and declare them in definitions.js\n            var controls = {\n                hider: $('.' + opts['hider']),\n                introbox: $('.' + 'mod_intro_box'),\n                progresscontainer: $('.' + opts['progresscontainer']),\n                feedbackcontainer: $('.' + opts['feedbackcontainer']),\n                errorcontainer: $('.' + opts['errorcontainer']),\n                passagecontainer: $('.' + opts['passagecontainer']),\n                recordingcontainer: $('.' + opts['recordingcontainer']),\n                dummyrecorder: $('.' + opts['dummyrecorder']),\n                recordercontainer: $('.' + opts['recordercontainer']),\n                menubuttonscontainer: $('.' + opts['menubuttonscontainer']),\n                menuinstructionscontainer: $('.' + opts['menuinstructionscontainer']),\n                previewinstructionscontainer: $('.' + opts['previewinstructionscontainer']),\n                landrinstructionscontainer: $('.' + opts['landrinstructionscontainer']),\n                activityinstructionscontainer: $('.' + opts['activityinstructionscontainer']),\n                recinstructionscontainerright: $('.' + opts['recinstructionscontainerright']),\n                recinstructionscontainerleft: $('.' + opts['recinstructionscontainerleft']),\n                allowearlyexit: $('.' + opts['allowearlyexit']),\n                wheretonextcontainer: $('.' + opts['wheretonextcontainer']),\n                modelaudioplayer: $('#' + opts['modelaudioplayer']),\n                startlandrbutton: $('#' + opts['startlandrbutton']),\n                startpreviewbutton: $('#' + opts['startpreviewbutton']),\n                startreadingbutton: $('#' + opts['startreadingbutton']),\n                startshadowbutton: $('#' + opts['startshadowbutton']),\n                returnmenubutton: $('#' + opts['returnmenubutton']),\n                stopandplay: $('#' + opts['stopandplay']),\n                smallreportcontainer: $('.' + opts['smallreportcontainer'])\n            };\n            this.controls = controls;\n        },\n\n        is_browser_ok: function () {\n            return (navigator && navigator.mediaDevices\n                && navigator.mediaDevices.getUserMedia);\n        },\n\n        setup_recorder: function () {\n            var dd = this;\n\n            //after the recorder reports that it has (really) started this functuon is called.\n            var beginall= function(){\n                dd.passagerecorded = true;\n                if(dd.enableshadow && dd.letsshadow){\n                    dd.controls.modelaudioplayer[0].play();\n                }\n            };\n\n            var on_speech = function (eventdata) {\n                var speech = eventdata.capturedspeech;\n                var speechresults = eventdata.speechresults;\n                if(dd.activitydata.transcriber == def.transcriber_amazonstreaming) {\n                    dd.streamingresults.push(speechresults);\n                    log.debug(dd.streamingresults);\n                }\n            };\n\n            //originates from the recording:started event\n            //contains no meaningful data\n            //See https://api.poodll.com\n            var on_recording_start = function (eventdata) {\n                dd.rec_time_start = new Date().getTime();\n                dd.dopassagelayout();\n                dd.controls.passagecontainer.show(1000, beginall);\n\n                //start streaming transcriber\n                if(dd.activitydata.transcriber == def.transcriber_amazonstreaming) {\n                    //init our streamingresults\n                    dd.streamingresults = [];\n                }//end of if amazonstreaming\n            };\n\n            //originates from the recording:ended event\n            //contains no meaningful data\n            //See https://api.poodll.com\n            var on_recording_end = function (eventdata) {\n                //its a bit hacky but the rec end event can arrive immed. somehow probably when the mic test ends\n                var now = new Date().getTime();\n                if ((now - dd.rec_time_start) < 3000) {\n                    return;\n                }\n                dd.douploadlayout();\n                //if we are shadowing we should stop the audio player.\n                if(dd.enableshadow && dd.letsshadow){\n                    dd.controls.modelaudioplayer[0].currentTime=0;\n                    dd.controls.modelaudioplayer[0].pause();\n                }\n            };\n\n            //data sent here originates from the awaiting_processing event\n            //See https://api.poodll.com\n            var on_audio_processing = function (eventdata) {\n                //at this point we know the submission has been uploaded and we know the fileURL\n                //so we send the submission\n                var now = new Date().getTime();\n                var rectime = now - dd.rec_time_start;\n                if (rectime > 0) {\n                    rectime = Math.ceil(rectime / 1000);\n                }\n\n                if(dd.activitydata.transcriber == def.transcriber_amazonstreaming &&\n                    dd.streamingresults &&\n                    dd.streamingresults.length > 0){\n                    //wait a few seconds for the final recognition to come back\n                    setTimeout(dd.send_streaming_submission,1500,dd, eventdata.mediaurl, rectime);\n                    //dd.send_streaming_submission(eventdata.mediaurl, rectime, dd.streamingresults);\n                }else {\n                    dd.send_submission(eventdata.mediaurl, rectime);\n                    //and let the user know that they are all done\n                    dd.dofinishedlayout();\n                }\n\n            };\n\n            //init the recorder\n            recorderhelper.init(dd.activitydata,\n                on_recording_start,\n                on_recording_end,\n                on_audio_processing,\n                on_speech);\n        },\n\n        register_events: function () {\n            var dd = this;\n          \n            \n            dd.controls.startpreviewbutton.click(function(e){\n                dd.dopreviewlayout();\n            });\n            dd.controls.startpreviewbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13 ) {\n                    dd.dopreviewlayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.startlandrbutton.click(function(e){\n                dd.dolandrlayout();\n            });\n            dd.controls.startlandrbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13 ) {\n                    dd.dolandrlayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.startreadingbutton.click(function(e){\n                dd.letsshadow=false;\n                dd.doreadinglayout();\n            });\n            dd.controls.startreadingbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13) {\n                    dd.letsshadow=false;\n                    dd.doreadinglayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.startshadowbutton.click(function(e){\n                dd.letsshadow=true;\n                dd.doreadinglayout();\n            });\n            dd.controls.startshadowbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13) {\n                    dd.letsshadow=true;\n                    dd.doreadinglayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.returnmenubutton.click(function(e){\n                //in most cases ajax hide show is ok, but L&R stuffs up android for normal readaloud so we reload\n                if(dd.isandroid() && dd.controls.landrinstructionscontainer.is(\":visible\")){\n                    location.reload();\n                }else {\n                    dd.controls.modelaudioplayer[0].currentTime = 0;\n                    dd.controls.modelaudioplayer[0].pause();\n                    dd.domenulayout();\n                }\n            });\n        },\n\n\n        send_streaming_submission: function (that, filename, rectime) {\n            //var that = this;\n            var streamingresults=that.streamingresults;\n            Ajax.call([{\n                methodname: 'mod_readaloud_submit_streaming_attempt',\n                args: {\n                    cmid: that.cmid,\n                    filename: filename,//encodeURIComponent(filename),\n                    rectime: rectime,\n                    awsresults: JSON.stringify(streamingresults)\n                },\n                done: function (ajaxresult) {\n                    var payloadobject = JSON.parse(ajaxresult);\n                    if (payloadobject) {\n                        switch (payloadobject.success) {\n                            case true:\n                                log.debug('attempted submission accepted');\n\n                                break;\n\n                            case false:\n                            default:\n                                log.debug('attempted item evaluation failure');\n                                if (payloadobject.message) {\n                                    log.debug('message: ' + payloadobject.message);\n                                }\n                        }\n                    }\n                    //and let the user know that they are all done\n                    that.dofinishedlayout();\n                },\n                fail: notification.exception\n            }]);\n        },\n\n        send_submission: function (filename, rectime) {\n            var that = this;\n            Ajax.call([{\n                methodname: 'mod_readaloud_submit_regular_attempt',\n                args: {\n                    cmid: that.cmid,\n                    filename:  filename,//encodeURIComponent(filename),\n                    rectime: rectime\n                },\n                done: function(ajaxresult){\n                    var payloadobject = JSON.parse(ajaxresult);\n                    if (payloadobject) {\n                        switch (payloadobject.success) {\n                            case true:\n                                log.debug('attempted submission accepted');\n\n                                break;\n\n                            case false:\n                            default:\n                                log.debug('attempted item evaluation failure');\n                                if (payloadobject.message) {\n                                    log.debug('message: ' + payloadobject.message);\n                                }\n                        }\n                    }\n                },\n                fail: notification.exception\n            }]);\n/*\n            return;\n\n            //set up our ajax request\n            var xhr = new XMLHttpRequest();\n            var that = this;\n\n            //set up our handler for the response\n            xhr.onreadystatechange = function (e) {\n                if (this.readyState === 4) {\n                    if (xhr.status === 200) {\n                        log.debug('ok we got an attempt submission response');\n                        //get a yes or forgetit or tryagain\n                        var payload = xhr.responseText;\n                        var payloadobject = JSON.parse(payload);\n                        if (payloadobject) {\n                            switch (payloadobject.success) {\n                                case true:\n                                    log.debug('attempted submission accepted');\n\n                                    break;\n\n                                case false:\n                                default:\n                                    log.debug('attempted item evaluation failure');\n                                    if (payloadobject.message) {\n                                        log.debug('message: ' + payloadobject.message);\n                                    }\n                            }\n                        }\n                    } else {\n                        log.debug('Not 200 response:' + xhr.status);\n                    }\n                }\n            };\n\n            //to get through mod_security environments\n            filename = filename.replace(/^https:\\/\\//i, 'https___');\n            var params = \"cmid=\" + that.cmid + \"&filename=\" + encodeURIComponent(filename) + \"&rectime=\" + rectime;\n            xhr.open(\"POST\", M.cfg.wwwroot + '/mod/readaloud/ajaxhelper.php', true);\n            xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n            xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n            xhr.send(params);\n*/\n        },\n\n        doreadinglayout: function () {\n            var m = this;\n            m.controls.hider.fadeOut('fast');\n            m.controls.activityinstructionscontainer.show();\n            m.controls.recordingcontainer.show();\n            m.controls.introbox.hide();\n            m.controls.menuinstructionscontainer.hide();\n            m.controls.menubuttonscontainer.hide();\n            m.controls.smallreportcontainer.hide();\n            m.controls.returnmenubutton.show();\n            m.controls.progresscontainer.hide();\n            m.controls.passagecontainer.removeClass('previewmode shadowmode reviewmode nothingmode');\n            m.controls.passagecontainer.addClass('readmode');\n            m.controls.passagecontainer.hide();\n            m.controls.feedbackcontainer.hide();\n            m.controls.wheretonextcontainer.hide();\n            m.controls.stopandplay.hide();\n        },\n\n        domenulayout: function () {\n            var m = this;\n            m.controls.introbox.show();\n            m.controls.menuinstructionscontainer.show();\n            m.controls.menubuttonscontainer.show();\n            m.controls.smallreportcontainer.show();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.returnmenubutton.hide();\n            m.controls.previewinstructionscontainer.hide();\n\n            m.controls.landrinstructionscontainer.hide();\n            landr.deactivate();\n\n            m.controls.progresscontainer.hide();\n            m.controls.passagecontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.feedbackcontainer.hide();\n            m.controls.wheretonextcontainer.hide();\n            m.controls.modelaudioplayer.hide();\n            m.controls.hider.hide();\n            m.controls.stopandplay.hide();\n        },\n\n        dopreviewlayout: function () {\n            var m = this;\n            m.controls.passagecontainer.removeClass('readmode shadowmode reviewmode nothingmode');\n            m.controls.passagecontainer.addClass('previewmode');\n            m.controls.passagecontainer.show();\n            m.controls.previewinstructionscontainer.show();\n            m.controls.landrinstructionscontainer.hide();\n            m.controls.introbox.hide();\n            m.controls.returnmenubutton.show();\n            m.controls.modelaudioplayer.hide();\n            m.controls.smallreportcontainer.hide();\n            m.controls.stopandplay.show();\n            m.controls.menubuttonscontainer.hide();\n            m.controls.hider.hide();\n            m.controls.progresscontainer.hide();\n            m.controls.menuinstructionscontainer.hide();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.feedbackcontainer.hide();\n            m.controls.wheretonextcontainer.hide();\n            m.controls.stopandplay.show();\n        },\n\n        dolandrlayout: function () {\n            var m = this;\n            m.controls.passagecontainer.removeClass('readmode shadowmode reviewmode nothingmode');\n            m.controls.passagecontainer.addClass('previewmode');\n            m.controls.passagecontainer.show();\n            m.controls.landrinstructionscontainer.show();\n            m.controls.previewinstructionscontainer.hide();\n            m.controls.introbox.hide();\n            m.controls.returnmenubutton.show();\n            m.controls.modelaudioplayer.hide();\n            m.controls.smallreportcontainer.hide();\n            m.controls.stopandplay.show();\n            m.controls.menubuttonscontainer.hide();\n            m.controls.hider.hide();\n            m.controls.progresscontainer.hide();\n            m.controls.menuinstructionscontainer.hide();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.feedbackcontainer.hide();\n            m.controls.wheretonextcontainer.hide();\n            m.controls.stopandplay.show();\n            landr.activate();\n        },\n\n        dopassagelayout: function () {\n            var m = this;\n            m.controls.introbox.hide();\n        },\n\n        douploadlayout: function () {\n            var m = this;\n            m.controls.passagecontainer.addClass(m.passagefinished);\n            m.controls.hider.fadeIn('fast');\n            m.controls.progresscontainer.fadeIn('fast');\n        },\n\n        dofinishedlayout: function () {\n            var m = this;\n            m.controls.hider.fadeOut('fast');\n            m.controls.progresscontainer.fadeOut('fast');\n            m.controls.smallreportcontainer.hide();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.passagecontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.feedbackcontainer.show();\n            m.controls.wheretonextcontainer.show();\n            m.controls.returnmenubutton.hide();\n\n        },\n        doerrorlayout: function () {\n            var m = this;\n            m.controls.hider.fadeOut('fast');\n            m.controls.progresscontainer.fadeOut('fast');\n            m.controls.passagecontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.errorcontainer.show();\n            m.controls.wheretonextcontainer.show();\n        },\n        isandroid: function() {\n                if (/Android/i.test(navigator.userAgent)) {\n                    return true;\n                } else {\n                    return false;\n                }\n        }\n    };//end of returned object\n});//total end\n"],"file":"activitycontroller.min.js"}