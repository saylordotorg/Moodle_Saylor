{"version":3,"sources":["../src/hiddenplayerhelper.js"],"names":["define","$","log","def","debug","controls","hiddenplayer","hiddenplayerbutton","hiddenplayerbuttonactive","hiddenplayerbuttonpaused","hiddenplayerbuttonplaying","init","register_controls","register_events","that","audioplayer","click","audiosrc","attr","prop","dohiddenstop","dohiddenplay","m","pause","load","pp","play","then","catch","dobuttonicons","theaudiosrc","each","addClass","activebutton","removeClass"],"mappings":"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","sourcesContent":["define(['jquery', 'core/log', 'mod_readaloud/definitions'], function ($, log, def) {\n    \"use strict\"; // jshint ;_;\n\n    log.debug('Readaloud hidden player helper: initialising');\n\n    return {\n\n        controls: {},\n        hiddenplayer: def.hiddenplayer,\n        hiddenplayerbutton: def.hiddenplayerbutton,\n        hiddenplayerbuttonactive: def.hiddenplayerbuttonactive,\n        hiddenplayerbuttonpaused: def.hiddenplayerbuttonpaused,\n        hiddenplayerbuttonplaying: def.hiddenplayerbuttonpaused,\n\n        init: function (opts) {\n            this.register_controls();\n            this.register_events();\n        },\n\n        register_controls: function () {\n            this.controls.hiddenplayer = $('.' + this.hiddenplayer);\n            this.controls.hiddenplayerbutton = $('.' + this.hiddenplayerbutton);\n        },\n\n        register_events: function () {\n            var that = this;\n            var audioplayer = this.controls.hiddenplayer;\n            //handle the button click\n            this.controls.hiddenplayerbutton.click(function (e) {\n                var audiosrc = $(this).attr('data-audiosource');\n                if (audiosrc === audioplayer.attr('src') && !(audioplayer.prop('paused'))) {\n                    that.dohiddenstop();\n                } else {\n                    that.dohiddenplay(audiosrc);\n                }\n            });\n\n        },\n\n\n        dohiddenplay: function (audiosrc) {\n            var m = this;\n            var audioplayer = m.controls.hiddenplayer;\n            audioplayer.attr('src', audiosrc);\n            audioplayer[0].pause();\n            audioplayer[0].load();\n            var pp = audioplayer[0].play();\n            if (pp !== undefined) {\n                pp.then(function () {\n                    // Yay we are playing\n                }).catch(function (error) {\n                    // somethings up ... but we can ignore it\n                });\n            }\n            m.dobuttonicons();\n        },\n        dohiddenstop: function () {\n            var m = this;\n            var audioplayer = m.controls.hiddenplayer;\n            audioplayer[0].pause();\n            m.dobuttonicons();\n        },\n\n        dobuttonicons: function (theaudiosrc) {\n            var m = this;\n            var audioplayer = m.controls.hiddenplayer;\n            if (!theaudiosrc) {\n                theaudiosrc = audioplayer.attr('src');\n            }\n            m.controls.hiddenplayerbutton.each(function (index) {\n                var audiosrc = $(this).attr('data-audiosource');\n                if (audiosrc === theaudiosrc) {\n                    $(this).addClass(m.activebutton);\n                    if (audioplayer.prop('paused')) {\n                        $(this).removeClass(m.hiddenplayerbuttonplaying);\n                        $(this).addClass(m.hiddenplayerbuttonpaused);\n                        //for now we make it look like no button is selected\n                        //later we can implement better controls\n                        $(this).removeClass(m.hiddenplayerbuttonactive);\n                    } else {\n                        $(this).removeClass(m.hiddenplayerbuttonpaused);\n                        $(this).addClass(m.hiddenplayerbuttonplaying);\n                    }\n                } else {\n                    $(this).removeClass(m.hiddenplayerbuttonactive);\n                    $(this).removeClass(m.hiddenplayerbuttonplaying);\n                    $(this).removeClass(m.hiddenplayerbuttonpaused);\n                }\n            });\n        }\n    };//end of return object\n\n});"],"file":"hiddenplayerhelper.min.js"}