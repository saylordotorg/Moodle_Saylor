{"version":3,"sources":["../src/popoverhelper.js"],"names":["define","$","log","def","debug","lastitem","okbuttonclass","ngbuttonclass","quickgradecontainerclass","quickgradetitle","M","util","get_string","component","transcripttitle","oklabel","nglabel","dispose","init","register_events","document","on","onAccept","onReject","disposeWord","version","fn","popover","Constructor","hasOwnProperty","VERSION","charAt","remove","item","addQuickGrader","that","title","content","thefunc","wordnumber","data","okbutton","ngbutton","container","trigger","placement","html","addTranscript","transcript","alert","attr"],"mappings":"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","sourcesContent":["define(['jquery', 'core/log', 'mod_readaloud/definitions', 'mod_readaloud/dependencyloader', 'theme_boost/popover'], function ($, log, def) {\n    \"use strict\"; // jshint ;_;\n\n    /*\n    This file is to\n     */\n\n    log.debug('Read Aloud Popover helper: initialising');\n\n    return {\n\n        lastitem: false,\n        okbuttonclass: def.okbuttonclass,\n        ngbuttonclass: def.ngbuttonclass,\n        quickgradecontainerclass: def.quickgradecontainerclass,\n        quickgradetitle: M.util.get_string('quickgrade', def.component),\n        transcripttitle: M.util.get_string('transcript', def.component),\n        oklabel: M.util.get_string('ok', def.component),\n        nglabel: M.util.get_string('ng', def.component),\n        dispose: false, //Bv4 = dispose  Bv3 = destroy\n\n        init: function () {\n            this.register_events();\n        },\n\n        register_events: function () {\n            $(document).on('click', '.' + this.okbuttonclass, this.onAccept);\n            $(document).on('click', '.' + this.ngbuttonclass, this.onReject);\n        },\n\n        //different bootstrap/popover versions have a different word for \"dispose\" so this method bridges that.\n        //we can not be sure what version is installed\n        disposeWord: function () {\n            if (this.dispose) {\n                return this.dispose;\n            }\n            var version = '3';\n            if ($.fn.popover.Constructor.hasOwnProperty('VERSION')) {\n                version = $.fn.popover.Constructor.VERSION.charAt(0);\n            }\n            switch (version) {\n                case '4':\n                    this.dispose = 'dispose';\n                    break;\n                case '3':\n                default:\n                    this.dispose = 'destroy';\n                    break;\n            }\n            return this.dispose;\n        },\n\n        remove: function (item) {\n            if (item) {\n                $(item).popover(this.disposeWord());\n            } else if (this.lastitem) {\n                $(this.lastitem).popover(this.disposeWord());\n                this.lastitem = false;\n            }\n        },\n\n        addQuickGrader: function (item) {\n\n            //dispose of previous popover, and remember this one\n            if (this.lastitem && this.lastitem !== item) {\n                $(this.lastitem).popover(this.disposeWord());\n                this.lastitem = false;\n            }\n            this.lastitem = item;\n            var that = this;\n\n            var thefunc = function () {\n                var wordnumber = $(this).data(\"wordnumber\");\n                var okbutton = \"<button type='button' class='btn \" + that.okbuttonclass + \"' data-wordnumber='\" + wordnumber + \"'><i class='fa fa-check'></i> \" + that.oklabel + \"</button>\";\n                var ngbutton = \"<button type='button' class='btn \" + that.ngbuttonclass + \"' data-wordnumber='\" + wordnumber + \"'><i class='fa fa-close'></i> \" + that.nglabel + \"</button>\";\n                var container = \"<div class='\" + that.quickgradecontainerclass + \"'>\" + okbutton + ngbutton + \"</div>\";\n                return $(container);\n            };\n\n            //lets add the popover\n            $(item).popover({\n                title: this.quickgradetitle,\n                content: thefunc,\n                trigger: 'manual',\n                placement: 'top',\n                html: true\n            });\n            $(item).popover('show');\n        },\n\n        addTranscript: function (item, transcript) {\n\n            //if we are already showing this item then dispose of it, set last item to null and go home\n            if (this.lastitem === item) {\n                $(this.lastitem).popover(this.disposeWord());\n                this.lastitem = false;\n                return;\n            }\n\n            //dispose of previous popover, and remember this one\n            if (this.lastitem) {\n                $(this.lastitem).popover(this.disposeWord());\n                this.lastitem = false;\n            }\n            this.lastitem = item;\n\n            //lets add the popover\n            $(item).popover({\n                title: this.transcripttitle,\n                content: transcript,\n                trigger: 'manual',\n                placement: 'top'\n            });\n            $(item).popover('show');\n        },\n\n        //these two functions are overridden by the calling class\n        onAccept: function () {\n            alert($(this).attr('data-wordnumber'));\n        },\n        onReject: function () {\n            alert($(this).attr('data-wordnumber'));\n        }\n\n    };//end of return value\n});"],"file":"popoverhelper.min.js"}