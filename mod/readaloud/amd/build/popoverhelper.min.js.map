{"version":3,"file":"popoverhelper.min.js","sources":["../src/popoverhelper.js"],"sourcesContent":["define(['jquery', 'core/log', 'mod_readaloud/definitions', 'mod_readaloud/dependencyloader', 'theme_boost/popover'], function ($, log, def) {\n    \"use strict\"; // jshint ;_;\n\n    /*\n    This file is to\n     */\n\n    log.debug('Read Aloud Popover helper: initialising');\n\n    return {\n\n        lastitem: false,\n        okbuttonclass: def.okbuttonclass,\n        ngbuttonclass: def.ngbuttonclass,\n        quickgradecontainerclass: def.quickgradecontainerclass,\n        quickgradetitle: M.util.get_string('quickgrade', def.component),\n        transcripttitle: M.util.get_string('transcript', def.component),\n        oklabel: M.util.get_string('ok', def.component),\n        nglabel: M.util.get_string('ng', def.component),\n        dispose: false, //Bv4 = dispose  Bv3 = destroy\n\n        init: function () {\n            this.register_events();\n        },\n\n        register_events: function () {\n            $(document).on('click', '.' + this.okbuttonclass, this.onAccept);\n            $(document).on('click', '.' + this.ngbuttonclass, this.onReject);\n        },\n\n        //different bootstrap/popover versions have a different word for \"dispose\" so this method bridges that.\n        //we can not be sure what version is installed\n        disposeWord: function () {\n            if (this.dispose) {\n                return this.dispose;\n            }\n            var version = '3';\n            if ($.fn.popover.Constructor.hasOwnProperty('VERSION')) {\n                version = $.fn.popover.Constructor.VERSION.charAt(0);\n            }\n            switch (version) {\n                case '4':\n                    this.dispose = 'dispose';\n                    break;\n                case '3':\n                default:\n                    this.dispose = 'destroy';\n                    break;\n            }\n            return this.dispose;\n        },\n\n        remove: function (item) {\n            if (item) {\n                $(item).popover(this.disposeWord());\n            } else if (this.lastitem) {\n                $(this.lastitem).popover(this.disposeWord());\n                this.lastitem = false;\n            }\n        },\n\n        addQuickGrader: function (item) {\n\n            //dispose of previous popover, and remember this one\n            if (this.lastitem && this.lastitem !== item) {\n                $(this.lastitem).popover(this.disposeWord());\n                this.lastitem = false;\n            }\n            this.lastitem = item;\n            var that = this;\n\n            var thefunc = function () {\n                var wordnumber = $(this).data(\"wordnumber\");\n                var okbutton = \"<button type='button' class='btn \" + that.okbuttonclass + \"' data-wordnumber='\" + wordnumber + \"'><i class='fa fa-check'></i> \" + that.oklabel + \"</button>\";\n                var ngbutton = \"<button type='button' class='btn \" + that.ngbuttonclass + \"' data-wordnumber='\" + wordnumber + \"'><i class='fa fa-close'></i> \" + that.nglabel + \"</button>\";\n                var container = \"<div class='\" + that.quickgradecontainerclass + \"'>\" + okbutton + ngbutton + \"</div>\";\n                return $(container);\n            };\n\n            //lets add the popover\n            $(item).popover({\n                title: this.quickgradetitle,\n                content: thefunc,\n                trigger: 'manual',\n                placement: 'top',\n                html: true\n            });\n            $(item).popover('show');\n        },\n\n        addTranscript: function (item, transcript) {\n\n            //if we are already showing this item then dispose of it, set last item to null and go home\n            if (this.lastitem === item) {\n                $(this.lastitem).popover(this.disposeWord());\n                this.lastitem = false;\n                return;\n            }\n\n            //dispose of previous popover, and remember this one\n            if (this.lastitem) {\n                $(this.lastitem).popover(this.disposeWord());\n                this.lastitem = false;\n            }\n            this.lastitem = item;\n\n            //lets add the popover\n            $(item).popover({\n                title: this.transcripttitle,\n                content: transcript,\n                trigger: 'manual',\n                placement: 'top'\n            });\n            $(item).popover('show');\n        },\n\n        //these two functions are overridden by the calling class\n        onAccept: function () {\n            alert($(this).attr('data-wordnumber'));\n        },\n        onReject: function () {\n            alert($(this).attr('data-wordnumber'));\n        }\n\n    };//end of return value\n});"],"names":["define","$","log","def","debug","lastitem","okbuttonclass","ngbuttonclass","quickgradecontainerclass","quickgradetitle","M","util","get_string","component","transcripttitle","oklabel","nglabel","dispose","init","register_events","document","on","this","onAccept","onReject","disposeWord","version","fn","popover","Constructor","hasOwnProperty","VERSION","charAt","remove","item","addQuickGrader","that","title","content","wordnumber","data","okbutton","ngbutton","container","trigger","placement","html","addTranscript","transcript","alert","attr"],"mappings":"AAAAA,qCAAO,CAAC,SAAU,WAAY,4BAA6B,iCAAkC,wBAAwB,SAAUC,EAAGC,IAAKC,YAOnID,IAAIE,MAAM,2CAEH,CAEHC,UAAU,EACVC,cAAeH,IAAIG,cACnBC,cAAeJ,IAAII,cACnBC,yBAA0BL,IAAIK,yBAC9BC,gBAAiBC,EAAEC,KAAKC,WAAW,aAAcT,IAAIU,WACrDC,gBAAiBJ,EAAEC,KAAKC,WAAW,aAAcT,IAAIU,WACrDE,QAASL,EAAEC,KAAKC,WAAW,KAAMT,IAAIU,WACrCG,QAASN,EAAEC,KAAKC,WAAW,KAAMT,IAAIU,WACrCI,SAAS,EAETC,KAAM,gBACGC,mBAGTA,gBAAiB,WACblB,EAAEmB,UAAUC,GAAG,QAAS,IAAMC,KAAKhB,cAAegB,KAAKC,UACvDtB,EAAEmB,UAAUC,GAAG,QAAS,IAAMC,KAAKf,cAAee,KAAKE,WAK3DC,YAAa,cACLH,KAAKL,eACEK,KAAKL,YAEZS,QAAU,OACVzB,EAAE0B,GAAGC,QAAQC,YAAYC,eAAe,aACxCJ,QAAUzB,EAAE0B,GAAGC,QAAQC,YAAYE,QAAQC,OAAO,IAG7C,MADDN,aAEKT,QAAU,oBAIVA,QAAU,iBAGhBK,KAAKL,SAGhBgB,OAAQ,SAAUC,MACVA,KACAjC,EAAEiC,MAAMN,QAAQN,KAAKG,eACdH,KAAKjB,WACZJ,EAAEqB,KAAKjB,UAAUuB,QAAQN,KAAKG,oBACzBpB,UAAW,IAIxB8B,eAAgB,SAAUD,MAGlBZ,KAAKjB,UAAYiB,KAAKjB,WAAa6B,OACnCjC,EAAEqB,KAAKjB,UAAUuB,QAAQN,KAAKG,oBACzBpB,UAAW,QAEfA,SAAW6B,SACZE,KAAOd,KAWXrB,EAAEiC,MAAMN,QAAQ,CACZS,MAAOf,KAAKb,gBACZ6B,QAXU,eACNC,WAAatC,EAAEqB,MAAMkB,KAAK,cAC1BC,SAAW,oCAAsCL,KAAK9B,cAAgB,sBAAwBiC,WAAa,iCAAmCH,KAAKrB,QAAU,YAC7J2B,SAAW,oCAAsCN,KAAK7B,cAAgB,sBAAwBgC,WAAa,iCAAmCH,KAAKpB,QAAU,YAC7J2B,UAAY,eAAiBP,KAAK5B,yBAA2B,KAAOiC,SAAWC,SAAW,gBACvFzC,EAAE0C,YAOTC,QAAS,SACTC,UAAW,MACXC,MAAM,IAEV7C,EAAEiC,MAAMN,QAAQ,SAGpBmB,cAAe,SAAUb,KAAMc,eAGvB1B,KAAKjB,WAAa6B,YAClBjC,EAAEqB,KAAKjB,UAAUuB,QAAQN,KAAKG,yBACzBpB,UAAW,GAKhBiB,KAAKjB,WACLJ,EAAEqB,KAAKjB,UAAUuB,QAAQN,KAAKG,oBACzBpB,UAAW,QAEfA,SAAW6B,KAGhBjC,EAAEiC,MAAMN,QAAQ,CACZS,MAAOf,KAAKR,gBACZwB,QAASU,WACTJ,QAAS,SACTC,UAAW,QAEf5C,EAAEiC,MAAMN,QAAQ,SAIpBL,SAAU,WACN0B,MAAMhD,EAAEqB,MAAM4B,KAAK,qBAEvB1B,SAAU,WACNyB,MAAMhD,EAAEqB,MAAM4B,KAAK"}