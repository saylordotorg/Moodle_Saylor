define(["jquery","core/log"],(function($,log){return log.debug("Polly helper: initialising"),{token:"",region:"",owner:"",init:function(token,region,owner){this.token=token,this.region=region,this.owner=owner},fetch_polly_url:function(speaktext,texttype,voice){var xhr=new XMLHttpRequest,that=this;xhr.onreadystatechange=function(e){if(4===this.readyState)if(200==xhr.status){var payload=xhr.responseText,payloadobject=JSON.parse(payload);if(payloadobject){if(payloadobject.returnCode>0)return log.debug(payloadobject.returnMessage),!1;if(0===payloadobject.returnCode){var pollyurl=payloadobject.returnMessage;that.onnewpollyurl(pollyurl)}else log.debug("Polly Signed URL Request failed:"),log.debug(payloadobject)}else log.debug("Polly Signed URL Request something bad happened")}else log.debug("Polly Signed URL Request Not 200 response:"+xhr.status)};var xhrparams="wstoken="+this.token+"&wsfunction=local_cpapi_fetch_polly_url&moodlewsrestformat=json&text="+encodeURIComponent(speaktext)+"&texttype="+texttype+"&voice="+voice+"&appid=mod_readaloud&owner="+this.owner+"&region="+this.region;xhr.open("POST","https://cloud.poodll.com/webservice/rest/server.php",!0),xhr.setRequestHeader("Cache-Control","no-cache"),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.send(xhrparams)},onnewpollyurl:function(pollyurl){log.debug(pollyurl)}}}));

//# sourceMappingURL=pollyhelper.min.js.map