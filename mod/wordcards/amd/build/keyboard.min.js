define ("mod_wordcards/keyboard",["jquery","core/templates"],function(a,b){var c={string:"",letters:[],qwerty:[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],mobile_user:function mobile_user(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return!0}else{return!1}},iphone_user:function iphone_user(){if(/iPhone|iPod/i.test(navigator.userAgent)){return!0}else{return!1}},shuffle:function shuffle(b){var a,c,d;for(d=b.length;d;d-=1){a=Math.floor(Math.random()*d);c=b[d-1];b[d-1]=b[a];b[a]=c}},flash:function flash(b,c){a(b).addClass(c);setTimeout(function(){a(b).removeClass(c)},100)},off:function off(){a("body").off(c.mobile_user()?"touchstart":"click",".chunk-key").off("click","#delete-chunk-input").off("click","#clear-chunk-input").off("click","#submit-chunk-input").off("keypress").off("keydown")},clear:function clear(){c.off();a("#chunk-input").remove()},disable:function disable(){c.off();a("#chunk-typed-inner").text("");a("#chunk-input").addClass("chunk-input-disabled")},create:function create(d,f,g,e,h){if(Array.isArray(e)&&3<e.length){var i=e}else{i=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]}c.string=f;c.off();c.letters=[];a.each(f.split(""),function(a,b){if(-1==c.letters.indexOf(b)){c.letters.push(b);i.splice(i.indexOf(b),1)}});c.shuffle(i);if(2<i.length){c.letters=c.letters.concat(i.slice(0,3))}c.letters.sort();var j=[];a.each(c.letters,function(a,b){var c={charcode:b.charCodeAt(0)};if(" "==b){c.letter="&nbsp;"}else{c.letter=b}j.push(c)});var k=[];k.letters=j;k.dataid=g;b.render("mod_wordcards/keyboard",k).then(function(b){a("#"+d).html(b)});var l=function(b){var d=a("#chunk-typed-inner").text();if(d.length<f.length){c.press(this,h)}else{c.flash("#chunk-typed-inner","a4e-incorrect")}b.preventDefault()};if(c.mobile_user()&&!c.iphone_user()){a("body").off("touchstart",".chunk-key");a("body").on("touchstart",".chunk-key",l)}else{a("body").off("click",".chunk-key");a("body").on("click",".chunk-key",l)}a("body").on("touchmove","#"+d,function(a){a.preventDefault()});a("body").on("click","#delete-chunk-input",function(){var b=a("#chunk-typed-inner").text(),c=b.slice(-1).charCodeAt(0);a("#chunk-typed-inner").text(b.substring(0,b.length-1))});a("body").on("click","#submit-chunk-input",function(){var b=a("#chunk-typed-inner").text();h(b)});a("body").on("keydown",function(b){var c=b.which;if(-1!=[0,8,46].indexOf(c)){a("#delete-chunk-input").trigger("click");b.preventDefault()}else if(13==b.which){a("#submit-chunk-input").trigger("click");b.preventDefault()}});a("body").on("keypress",function(b){var d=a("#chunk-typed-inner").text(),e=b.which,g=a(".chunk-key[data-val='"+e+"']");if(g.length&&d.length<f.length){c.press(g,h)}else{c.flash("#chunk-typed-inner","a4e-incorrect")}b.preventDefault()})},press:function press(b){var d=String.fromCharCode(a(b).data("val"));c.flash(b,"a4e-key-pressed");var e={old:a("#chunk-typed-inner").text()};e.new=e.old+d;if(e.new.length<=c.string.length){a("#chunk-typed-inner").text(e.new)}else{c.flash("#chunk-typed-inner","a4e-incorrect")}}};return c});
//# sourceMappingURL=keyboard.min.js.map
