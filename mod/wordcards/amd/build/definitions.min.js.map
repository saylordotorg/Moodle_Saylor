{"version":3,"sources":["../src/definitions.js"],"names":["define","$","Ajax","Notification","ModalFactory","str","ModalEvents","a4e","strings","init","opts","that","init_strings","theid","propscontrol","get","props","JSON","parse","value","remove","log","debug","ef","eg","on","hasClass","removeClass","addClass","index","i","find","slideUp","slideDown","check_prev_level","check_next_level","window","matchMedia","matches","definition_flashcards_ul","length","append","hide","$bar","children","click","d","preventDefault","show","attr","removeAttr","cr_index","curr_level_card","html","parseInt","next","first","prev","last","container","modid","canmanage","canattempt","btn","register_events","init_audio","token","region","owner","seenAll","e","termNode","parents","termId","data","call","then","result","Deferred","reject","fail","exception","always","prop","buttonhref","location","href","create","type","types","SAVE_CANCEL","title","reattempttitle","body","reattemptbody","modal","setSaveButtonText","reattempt","root","getRoot","save","get_strings","done","s"],"mappings":"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","sourcesContent":["define(['jquery', 'core/ajax', 'core/notification','core/modal_factory','core/str','core/modal_events', 'mod_wordcards/a4e'],\r\n    function($, Ajax, Notification,ModalFactory, str, ModalEvents, a4e) {\r\n  \"use strict\"; // jshint ;_;\r\n\r\n  return {\r\n\r\n    strings: {},\r\n\r\n    init: function(opts) {\r\n\r\n        var that = this;\r\n\r\n        //init strings\r\n        this.init_strings();\r\n\r\n        //pick up opts from html\r\n        var theid = '#' + opts['widgetid'];\r\n        var propscontrol = $(theid).get(0);\r\n        if (propscontrol) {\r\n            var props = JSON.parse(propscontrol.value);\r\n            this.props =props;\r\n            $(theid).remove();\r\n        } else {\r\n            //if there is no config we might as well give up\r\n            log.debug('No config found on page. Giving up.');\r\n            return;\r\n        }\r\n\r\n/* flashcards code start */\r\n\t\t\tvar ef = $(\".event_flashcards\");\r\n\t\t\tvar eg = $(\".event_grid\");\r\n\r\n\t\t\t$('.ProgressBar-step').on('click', function () {\r\n\t\t\t\tif ($(this).hasClass(\"is-current\")) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\t$('.ProgressBar-step').removeClass(\"is-current\").removeClass('is-complete');\r\n\t\t\t\t$(this).addClass(\"is-current\");\r\n\t\t\t\tvar str = $(this).index();\r\n\t\t\t\tif (str > 0) {\r\n\t\t\t\t\tfor (var i = 0; i <= str; i++) {\r\n\t\t\t\t\t\t$('.ProgressBar')\r\n\t\t\t\t\t\t\t.find('li:eq(' + i + ')')\r\n\t\t\t\t\t\t\t.addClass('is-complete');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t$('.definition_flashcards_ul li').slideUp(300);\r\n\t\t\t\t$('.definition_flashcards_ul')\r\n\t\t\t\t\t.find('li:eq(' + str + ')')\r\n\t\t\t\t\t.slideDown(300);\r\n\t\t\t\t$('.is-current').removeClass('is-complete');\r\n\t\t\t\tcheck_prev_level();\r\n\t\t\t\tcheck_next_level();\r\n\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif (window.matchMedia(\"(max-width: 767px)\").matches) {\r\n\r\n\t\t\t\tvar definition_flashcards_ul = $('.definition_flashcards_ul li').length;\r\n\t\t\t\t$('.wrapper_pr').append('<div class=\"mb_nav\"><span class=\"curr_level_card\">1</span> / <span class=\"tot_level_card\">' + definition_flashcards_ul + '</span></div>');\r\n\t\t\t\t$('.ProgressBar').hide();\r\n\t\t\t}\r\n\t\t\t$(\".definition_flashcards_ul li:gt(0)\").hide();\r\n\t\t\tvar $bar = $(\".ProgressBar\");\r\n\t\t\t$bar.children(\"li:first\").addClass('is-current');\r\n\t\t\tcheck_prev_level();\r\n\t\t\tcheck_next_level();\r\n\t\t\tef.click(function (d) {\r\n\t\t\t\td.preventDefault();\r\n\t\t\t\t$('.definition_flashcards').show();\r\n\t\t\t\t$('.definition_grid').hide();\r\n\t\t\t});\r\n\t\t\teg.click(function (d) {\r\n\t\t\t\td.preventDefault();\r\n\t\t\t\t$('.definition_flashcards').hide();\r\n\t\t\t\t$('.definition_grid').show();\r\n\t\t\t});\r\n\r\n\t\t\tfunction check_prev_level() {\r\n\r\n\t\t\t\tvar $bar = $(\".ProgressBar\");\r\n\t\t\t\tif ($bar.children(\"li:first\").hasClass('is-current') === true) {\r\n\t\t\t\t\t$('#Prev').attr('disabled', 'disabled').addClass('add_opacity_level');\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$('#Prev').removeAttr('disabled');\r\n\t\t\t\t$('#Prev').removeAttr('disabled').removeClass('add_opacity_level');\r\n\t\t\t}\r\n\r\n\t\t\t$('#Next').click(function () {\r\n\t\t\t\tvar cr_index = $(\".is-current\").index() + 1;\r\n\t\t\t\t$('.definition_flashcards_ul li').slideUp(300);\r\n\t\t\t\t$('.definition_flashcards_ul li:eq(' + cr_index + ')').slideDown(300);\r\n\t\t\t\tvar curr_level_card = $('.curr_level_card').html();\r\n\t\t\t\t$('.curr_level_card').html(parseInt(curr_level_card) + 1);\r\n\r\n\t\t\t\tvar $bar = $(\".ProgressBar\");\r\n\t\t\t\tif ($bar.children(\".is-current\").length > 0) {\r\n\t\t\t\t\t$bar.children(\".is-current\").removeClass(\"is-current\").addClass(\"is-complete\").next().addClass(\"is-current\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$bar.children().first().addClass(\"is-current\");\r\n\t\t\t\t}\r\n\t\t\t\tcheck_prev_level();\r\n\t\t\t\tcheck_next_level();\r\n\t\t\t});\r\n\r\n\t\t\t$('#Prev').click(function () {\r\n\t\t\t\tvar cr_index = $(\".is-current\").index() - 1;\r\n\t\t\t\t$('.definition_flashcards_ul li').slideUp(300);\r\n\t\t\t\t$('.definition_flashcards_ul li:eq(' + cr_index + ')').slideDown(300);\r\n\t\t\t\tvar curr_level_card = $('.curr_level_card').html();\r\n\t\t\t\t$('.curr_level_card').html(parseInt(curr_level_card) - 1);\r\n\t\t\t\tvar $bar = $(\".ProgressBar\");\r\n\t\t\t\tif ($bar.children(\".is-current\").length > 0) {\r\n\t\t\t\t\t$bar.children(\".is-current\").removeClass(\"is-current\").prev().removeClass(\"is-complete\").addClass(\"is-current\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$bar.children(\".is-complete\").last().removeClass(\"is-complete\").addClass(\"is-current\");\r\n\t\t\t\t}\r\n\t\t\t\tcheck_prev_level();\r\n\t\t\t\tcheck_next_level();\r\n\t\t\t});\r\n\r\n\t\t\tfunction check_next_level() {\r\n\t\t\t\tvar $bar = $(\".ProgressBar\");\r\n\t\t\t\tif ($bar.children(\"li:last\").hasClass('is-current') === true) {\r\n\t\t\t\t\t$('#Next').attr('disabled', 'disabled').addClass('add_opacity_level');\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\t$('#Next').removeAttr('disabled').removeClass('add_opacity_level');\r\n\t\t\t}\r\n\t\t\t/* flashcards code end */\r\n      var container = $('#definitions-page-' + opts['widgetid']),\r\n        modid = props.modid,\r\n        canmanage = props.canmanage,\r\n        canattempt = props.canattempt,\r\n        btn = container.find('.definitions-next');\r\n\r\n       //set up audio\r\n       a4e.register_events();\r\n       a4e.init_audio(props.token,props.region,props.owner);\r\n\r\n      function seenAll() {\r\n        return container.find('.term').length === container.find('.term.term-seen').length\r\n      }\r\n\r\n      container.on('click', '.term-seen-action', function(e) {\r\n        e.preventDefault();\r\n\r\n        var termNode = $(this).parents('.term').first();\r\n        var termId = termNode.data('termid');\r\n\r\n        //On the clicked (and visible) node add loading\r\n        termNode.addClass('term-loading');\r\n        Ajax.call([{\r\n            'methodname': 'mod_wordcards_mark_as_seen',\r\n            'args': {\r\n              'termid': termId\r\n            }\r\n          }])[0].then(function(result) {\r\n            if (!result) {\r\n              return $.Deferred().reject();\r\n            }\r\n\r\n          //since we have two nodes (grid and flashcards) for a single term,\r\n\t\t\t// and the user might toggle between the grid and flashcards view we need to update both\r\n\t\t\t//so the old termNode.addClass('term-seen') is no good. it would only update one\r\n          //  termNode.addClass('term-seen');\r\n\t\t\t$('.definition_flashcards [data-termid=\"' + termId + '\"]').addClass('term-seen')\r\n\t\t\t$('.definition_grid [data-termid=\"' + termId + '\"]').addClass('term-seen')\r\n          })\r\n          .fail(Notification.exception)\r\n          .always(function() {\r\n          \t//remove loading from  node which loading was applied to\r\n            termNode.removeClass('term-loading');\r\n            if (seenAll()) {\r\n              btn.prop('disabled', false);\r\n            }\r\n          });\r\n      });\r\n\r\n      // Teachers can jump to the next steps.\r\n      if (!seenAll() && !canmanage) {\r\n        btn.prop('disabled', true);\r\n      }\r\n\r\n      btn.click(function(e) {\r\n        e.preventDefault();\r\n        var buttonhref= $(this).data('href');\r\n\r\n        //f its not a reattempt ... proceed\r\n        if($(this).data('action')!=='reattempt') {\r\n            window.location.href = buttonhref;\r\n            return;\r\n        }\r\n\r\n        //if its a reattempt, confirm and proceed\r\n          ModalFactory.create({\r\n              type: ModalFactory.types.SAVE_CANCEL,\r\n              title: that.strings.reattempttitle,\r\n              body: that.strings.reattemptbody\r\n          })\r\n          .then(function(modal) {\r\n              modal.setSaveButtonText(that.strings.reattempt);\r\n              var root = modal.getRoot();\r\n              root.on(ModalEvents.save, function() {\r\n                  window.location.href = buttonhref;\r\n              });\r\n              modal.show();\r\n          });\r\n\r\n      });\r\n\r\n    },\r\n\r\n    init_strings: function(){\r\n        var that = this;\r\n        // set up strings\r\n        str.get_strings([\r\n            {\"key\": \"reattempttitle\",       \"component\": 'mod_wordcards'},\r\n            {\"key\": \"reattemptbody\",           \"component\": 'mod_wordcards'},\r\n            {\"key\": \"reattempt\",           \"component\": 'mod_wordcards'}\r\n\r\n        ]).done(function(s) {\r\n            var i = 0;\r\n            that.strings.reattempttitle = s[i++];\r\n            that.strings.reattemptbody = s[i++];\r\n            that.strings.reattempt = s[i++];\r\n        });\r\n    }\r\n\r\n  }\r\n\r\n});\r\n"],"file":"definitions.min.js"}