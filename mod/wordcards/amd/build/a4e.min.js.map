{"version":3,"sources":["../src/a4e.js"],"names":["define","$","log","Ajax","flip","textFit","templates","polly","a4e","face","register_events","console","init_audio","token","region","owner","init","onnewpollyurl","theurl","theplayer","attr","play","document","body","on","audiourl","indexOf","fetch_polly_url","progress_dots","results","terms","code","forEach","o","i","color","points","html","shuffle","a","j","x","length","Math","floor","random","pretty_print_secs","time","minutes","str_pad_left","list_vocab","target","tdata","render","then","cards","faces","setTimeout","axis","multiLine","maxFontSize","alignHoriz","alignVert","calc_total_points","total","each","basic_feedback","total_time","detailed_feedback","k","v","ucfirst","string","pad","Array","join","slice","str","f","charAt","toUpperCase","substr"],"mappings":"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","sourcesContent":["/**\n * Apps4EFL module.\n *\n * @package mod_wordcards\n * @author  Justin Hunt - poodll.com\n * (based on Paul Raine's APPs 4 EFL)\n */\n\ndefine([\n  'jquery',\n  'core/log',\n  'core/ajax',\n  'mod_wordcards/flip',\n  'mod_wordcards/textfit',\n  'core/templates',\n  'mod_wordcards/pollyhelper',\n], function($, log, Ajax, flip, textFit, templates, polly) {\n\n  var a4e = {\n\n    face: true,\n\n    register_events: function() {\n      console.log(\"register_events within a4e.js\");\n    },\n\n    init_audio: function(token, region, owner){\n\n        //Init Polly TTS\n        polly.init(token, region, owner);\n\n        //play what was returned in polly.fetch_polly_url (callback)\n        polly.onnewpollyurl = function(theurl) {\n            var theplayer = $(\"#poodll_vocabplayer\");\n            theplayer.attr('src', theurl);\n            theplayer[0].play();\n        };\n\n        //register button event handler to play audio\n        $(document.body).on('click','.a4e-flashcards-container .play-tts, span.model-sentence-play-tts,.definitions-container .definition-play-tts ',function() {\n            var theplayer = $(\"#poodll_vocabplayer\");\n\n            //if we have model audio use that, otherwise TTS\n            var audiourl=$(this).attr('data-modelaudio');\n            if(audiourl && (audiourl.indexOf('http:')===0 ||audiourl.indexOf('https:')===0)){\n                theplayer.attr('src', audiourl);\n                theplayer[0].play();\n            }else{\n                polly.fetch_polly_url($(this).attr('data-tts'), 'text', $(this).attr('data-ttsvoice'));\n            }\n        });\n    },\n\n    progress_dots: function(results, terms) {\n\n      var code = \"\",\n        color;\n      terms.forEach(function(o, i) {\n        var color = \"darkgray\";\n        if (results[i] !== undefined) {\n          if (results[i].points) {\n            color = \"green\";\n          } else {\n            color = \"red\";\n          }\n        }\n        code += '<i style=\"color:' + color + ';\" class=\"fa fa-circle\"></i>';\n      });\n\n      $(\"#wordcards-progress-dots\").html(code);\n\n    },\n\n    shuffle: function(a) {\n      var j, x, i;\n      for (i = a.length; i; i -= 1) {\n        j = Math.floor(Math.random() * i);\n        x = a[i - 1];\n        a[i - 1] = a[j];\n        a[j] = x;\n      }\n    },\n    pretty_print_secs: function(time) {\n      var minutes = Math.floor(time / 60);\n      var seconds = time - minutes * 60;\n      return a4e.str_pad_left(minutes, '0', 2) + ':' + a4e.str_pad_left(seconds, '0', 2);\n    },\n\n    list_vocab: function(target, terms) {\n\n      //template data\n      var tdata = [];\n      tdata['terms'] = terms;\n      templates.render('mod_wordcards/vocablist', tdata).then(\n        function(html, js) {\n          $(target).html(html);\n\n          var cards = $(\".a4e-flashcards-container .a4e-card\");\n          var faces = $(\".front,.back\");\n          setTimeout(function() {\n            cards.flip({axis:'x'});\n            textFit(faces, {\n              multiLine: true,\n              maxFontSize: 50,\n              alignHoriz: true,\n              alignVert: true\n            });\n          }, 100);\n\n          $('.a4e-flashcards-container .mod_wordcards_matching_frontbtn').on('click', function() {\n            $(\".a4e-flashcards-container .a4e-card\").flip(a4e.face);\n            a4e.face = !a4e.face;\n          });\n\n        }\n      );\n\n    },\n    calc_total_points: function(results) {\n      var total = 0;\n      $.each(results, function(i, o) {\n        if (o.points != undefined) {\n          total += o.points;\n        }\n      });\n      return total;\n    },\n    basic_feedback: function(results) {\n\n      var total = 0;\n      var total_time = 0;\n\n      $.each(results, function(i, o) {\n        if (o.time != null) {\n          total_time += o.time;\n        }\n        if (o.points != undefined) {\n          total += o.points;\n        }\n      });\n      var code = \"<div class='a4e-basic_feedback'><h2>\";\n      code += \"<i class='fa fa-trophy'></i> \" + total + \" points\";\n      if (total_time != 0) {\n        code += \"<hr/><i class='fa fa-clock-o'></i> \" + a4e.pretty_print_secs(total_time)\n      };\n      code += \"</h2></div>\";\n      return code;\n\n    },\n    detailed_feedback: function(results) {\n\n      var code = \"<div style='text-align:center;'>\",\n        color;\n\n      $.each(results, function(i, o) {\n\n        color = \"\";\n\n        if (o.points > 0) {\n          color = \"a4e-correct\";\n        } else {\n          color = \"a4e-incorrect\";\n        }\n\n        code += \"<div class='a4e-detailed_feedback_div \" + color + \"'>\";\n        code += \"<h3 style='margin-bottom:10px;margin-top:5px;'>\" + (i + 1) + \"</h3>\";\n        $.each(o, function(k, v) {\n          if (k == \"time\") {\n            code += \"<p><strong>\" + a4e.ucfirst(k) + \"</strong>:<br/>\" + a4e.pretty_print_secs(v) + \"</p>\";\n          } else {\n            code += \"<p><strong>\" + a4e.ucfirst(k) + \"</strong>:<br/>\" + (v == \"\" ? \"N/A\" : v) + \"</p>\";\n          }\n        });\n        code += \"</div>\";\n      });\n\n      code += \"</div>\";\n\n      return code;\n\n    },\n\n    str_pad_left: function(string, pad, length) {\n      return (new Array(length + 1).join(pad) + string).slice(-length);\n    },\n\n    ucfirst: function(str) {\n      str += ''\n      var f = str.charAt(0).toUpperCase()\n      return f + str.substr(1)\n    }\n\n  };\n\n  return a4e;\n\n});"],"file":"a4e.min.js"}