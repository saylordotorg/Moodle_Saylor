define ("mod_wordcards/definitions",["jquery","core/ajax","core/notification","core/modal_factory","core/str","core/modal_events","mod_wordcards/a4e"],function(a,b,c,d,e,f,g){"use strict";return{strings:{},init:function init(e){var h=this;this.init_strings();var i="#"+e.widgetid,j=a(i).get(0);if(j){var k=JSON.parse(j.value);this.props=k;a(i).remove()}else{log.debug("No config found on page. Giving up.");return}var l=a(".event_flashcards"),m=a(".event_grid"),n=a(".definition_flashcards_ul li").length;a(".definition_flashcards_ul li:gt(0)").hide();a(".definition_flashcards_ul li:first").addClass("is-current");o(1,n);l.click(function(b){b.preventDefault();a(".definition_flashcards").fadeIn();a(".definition_grid").fadeOut();l.addClass("btn-primary").removeClass("btn-outline-primary");m.removeClass("btn-primary").addClass("btn-outline-primary")});m.click(function(b){b.preventDefault();a(".definition_flashcards").fadeOut();a(".definition_grid").fadeIn();m.addClass("btn-primary").removeClass("btn-outline-primary");l.removeClass("btn-primary").addClass("btn-outline-primary")});a("#Next").click(function(){var b=a(".is-current").index()+1;if(b>n-1){b=0}a(".definition_flashcards_ul li").slideUp(300);a(".definition_flashcards_ul li").removeClass("is-current");a(".definition_flashcards_ul li:eq("+b+")").addClass("is-current");a(".definition_flashcards_ul li:eq("+b+")").slideDown(300);o(b+1,n)});a("#Prev").click(function(){var b=a(".is-current").index()-1;if(0>b){b=n-1}a(".definition_flashcards_ul li").slideUp(300);a(".definition_flashcards_ul li").removeClass("is-current");a(".definition_flashcards_ul li:eq("+b+")").addClass("is-current");a(".definition_flashcards_ul li:eq("+b+")").slideDown(300);var c=a(".curr_level_card").html();a(".curr_level_card").html(parseInt(c)-1);o(b+1,n)});function o(b,c){a(".definition_flashcards .wc_cardsprogress").text(b+" / "+c)}var p=a("#definitions-page-"+e.widgetid),q=k.modid,r=k.canmanage,s=k.canattempt,t=p.find(".definitions-next");g.register_events();g.init_audio(k.token,k.region,k.owner);p.on("click",".term-seen-action",function(d){d.preventDefault();var e=a(this).parents(".term").first(),f=e.data("termid");e.addClass("term-loading");b.call([{methodname:"mod_wordcards_mark_as_seen",args:{termid:f}}])[0].then(function(b){if(!b){return a.Deferred().reject()}a(".definition_flashcards [data-termid=\""+f+"\"]").addClass("term-seen");a(".definition_grid [data-termid=\""+f+"\"]").addClass("term-seen")}).fail(c.exception).always(function(){e.removeClass("term-loading")})});t.click(function(b){b.preventDefault();var c=a(this).data("href");if("reattempt"!==a(this).data("action")){window.location.href=c;return}d.create({type:d.types.SAVE_CANCEL,title:h.strings.reattempttitle,body:h.strings.reattemptbody}).then(function(a){a.setSaveButtonText(h.strings.reattempt);var b=a.getRoot();b.on(f.save,function(){window.location.href=c});a.show()})})},init_strings:function init_strings(){var a=this;e.get_strings([{key:"reattempttitle",component:"mod_wordcards"},{key:"reattemptbody",component:"mod_wordcards"},{key:"reattempt",component:"mod_wordcards"}]).done(function(b){var c=0;a.strings.reattempttitle=b[c++];a.strings.reattemptbody=b[c++];a.strings.reattempt=b[c++]})}}});
//# sourceMappingURL=definitions.min.js.map
