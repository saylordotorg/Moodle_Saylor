define ("mod_wordcards/definitions",["jquery","core/ajax","core/notification","core/modal_factory","core/str","core/modal_events","mod_wordcards/a4e"],function(a,b,c,d,e,f,g){"use strict";return{strings:{},init:function init(e){var h=this;this.init_strings();var i="#"+e.widgetid,j=a(i).get(0);if(j){var k=JSON.parse(j.value);this.props=k;a(i).remove()}else{log.debug("No config found on page. Giving up.");return}var l=a(".event_flashcards"),m=a(".event_grid");a(".ProgressBar-step").on("click",function(){if(a(this).hasClass("is-current")){return!1}a(".ProgressBar-step").removeClass("is-current").removeClass("is-complete");a(this).addClass("is-current");var b=a(this).index();if(0<b){for(var c=0;c<=b;c++){a(".ProgressBar").find("li:eq("+c+")").addClass("is-complete")}}a(".definition_flashcards_ul li").slideUp(300);a(".definition_flashcards_ul").find("li:eq("+b+")").slideDown(300);a(".is-current").removeClass("is-complete");p();q()});if(window.matchMedia("(max-width: 767px)").matches){var n=a(".definition_flashcards_ul li").length;a(".wrapper_pr").append("<div class=\"mb_nav\"><span class=\"curr_level_card\">1</span> / <span class=\"tot_level_card\">"+n+"</span></div>");a(".ProgressBar").hide()}a(".definition_flashcards_ul li:gt(0)").hide();var o=a(".ProgressBar");o.children("li:first").addClass("is-current");p();q();l.click(function(b){b.preventDefault();a(".definition_flashcards").show();a(".definition_grid").hide()});m.click(function(b){b.preventDefault();a(".definition_flashcards").hide();a(".definition_grid").show()});function p(){var b=a(".ProgressBar");if(!0===b.children("li:first").hasClass("is-current")){a("#Prev").attr("disabled","disabled").addClass("add_opacity_level");return!0}a("#Prev").removeAttr("disabled");a("#Prev").removeAttr("disabled").removeClass("add_opacity_level")}a("#Next").click(function(){var b=a(".is-current").index()+1;a(".definition_flashcards_ul li").slideUp(300);a(".definition_flashcards_ul li:eq("+b+")").slideDown(300);var c=a(".curr_level_card").html();a(".curr_level_card").html(parseInt(c)+1);var d=a(".ProgressBar");if(0<d.children(".is-current").length){d.children(".is-current").removeClass("is-current").addClass("is-complete").next().addClass("is-current")}else{d.children().first().addClass("is-current")}p();q()});a("#Prev").click(function(){var b=a(".is-current").index()-1;a(".definition_flashcards_ul li").slideUp(300);a(".definition_flashcards_ul li:eq("+b+")").slideDown(300);var c=a(".curr_level_card").html();a(".curr_level_card").html(parseInt(c)-1);var d=a(".ProgressBar");if(0<d.children(".is-current").length){d.children(".is-current").removeClass("is-current").prev().removeClass("is-complete").addClass("is-current")}else{d.children(".is-complete").last().removeClass("is-complete").addClass("is-current")}p();q()});function q(){var b=a(".ProgressBar");if(!0===b.children("li:last").hasClass("is-current")){a("#Next").attr("disabled","disabled").addClass("add_opacity_level");return!0}a("#Next").removeAttr("disabled").removeClass("add_opacity_level")}var r=a("#definitions-page-"+e.widgetid),s=k.modid,t=k.canmanage,u=k.canattempt,v=r.find(".definitions-next");g.register_events();g.init_audio(k.token,k.region,k.owner);function w(){return r.find(".term").length===r.find(".term.term-seen").length}r.on("click",".term-seen-action",function(d){d.preventDefault();var e=a(this).parents(".term").first(),f=e.data("termid");e.addClass("term-loading");b.call([{methodname:"mod_wordcards_mark_as_seen",args:{termid:f}}])[0].then(function(b){if(!b){return a.Deferred().reject()}a(".definition_flashcards [data-termid=\""+f+"\"]").addClass("term-seen");a(".definition_grid [data-termid=\""+f+"\"]").addClass("term-seen")}).fail(c.exception).always(function(){e.removeClass("term-loading");if(w()){v.prop("disabled",!1)}})});if(!w()&&!t){v.prop("disabled",!0)}v.click(function(b){b.preventDefault();var c=a(this).data("href");if("reattempt"!==a(this).data("action")){window.location.href=c;return}d.create({type:d.types.SAVE_CANCEL,title:h.strings.reattempttitle,body:h.strings.reattemptbody}).then(function(a){a.setSaveButtonText(h.strings.reattempt);var b=a.getRoot();b.on(f.save,function(){window.location.href=c});a.show()})})},init_strings:function init_strings(){var a=this;e.get_strings([{key:"reattempttitle",component:"mod_wordcards"},{key:"reattemptbody",component:"mod_wordcards"},{key:"reattempt",component:"mod_wordcards"}]).done(function(b){var c=0;a.strings.reattempttitle=b[c++];a.strings.reattemptbody=b[c++];a.strings.reattempt=b[c++]})}}});
//# sourceMappingURL=definitions.min.js.map
