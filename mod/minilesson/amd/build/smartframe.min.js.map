{"version":3,"file":"smartframe.min.js","sources":["../src/smartframe.js"],"sourcesContent":["define(['jquery', 'core/log', 'mod_minilesson/definitions'], function($, log, def) {\n  \"use strict\"; // jshint ;_;\n\n  /*\n  This file is to manage the quiz stage\n   */\n\n  log.debug('MiniLesson SmartFrame: initialising');\n\n  return {\n\n    //for making multiple instances\n      clone: function () {\n          return $.extend(true, {}, this);\n     },\n\n    init: function(index, itemdata, quizhelper) {\n      this.register_events(index, itemdata, quizhelper);\n    },\n    next_question: function(percent) {\n      var self = this;\n      var stepdata = {};\n      stepdata.index = self.index;\n      stepdata.hasgrade = true;\n      stepdata.totalitems = 10;\n      stepdata.correctitems = percent / 10;\n      stepdata.grade = percent;\n      self.quizhelper.do_next(stepdata);\n    },\n    register_events: function(index, itemdata, quizhelper) {\n      \n      var self = this;\n      self.index = index;\n      self.quizhelper = quizhelper;\n      \n      $(\"#\" + itemdata.uniqueid + \"_container .minilesson_nextbutton\").on('click', function(e) {\n        self.next_question(0);\n      });\n\n      //listen for the grades\n      window.addEventListener(\"message\", function(event) {\n        log.debug('messageevent',event);\n\n            //if its not really our smartframe host get out of here\n            if (event.origin !== itemdata.smartframehost) {\n                return;\n            }\n            //pass back results and transition\n            var gradesdata = event.data;\n            //each instance of teacher tools itemtype will catch this event, so we need to filter the ones we handle to just this instanc\n           //thats why we pass the itemdata around\n            if(typeof gradesdata != 'undefined' && gradesdata.itemid == itemdata.id) {\n                var thepercent = gradesdata.percent;\n\n                $(\".minilesson_nextbutton\").prop(\"disabled\", true);\n                setTimeout(function () {\n                    $(\".minilesson_nextbutton\").prop(\"disabled\", false);\n                    self.next_question(gradesdata.percent);\n                }, 500);\n            }\n          }, false\n      );\n      \n    }\n  };\n});"],"names":["define","$","log","def","debug","clone","extend","this","init","index","itemdata","quizhelper","register_events","next_question","percent","stepdata","hasgrade","totalitems","correctitems","grade","do_next","self","uniqueid","on","e","window","addEventListener","event","origin","smartframehost","gradesdata","data","itemid","id","prop","setTimeout"],"mappings":"AAAAA,mCAAO,CAAC,SAAU,WAAY,+BAA+B,SAASC,EAAGC,IAAKC,YAO5ED,IAAIE,MAAM,uCAEH,CAGHC,MAAO,kBACIJ,EAAEK,QAAO,EAAM,GAAIC,OAGhCC,KAAM,SAASC,MAAOC,SAAUC,iBACzBC,gBAAgBH,MAAOC,SAAUC,aAExCE,cAAe,SAASC,aAElBC,SAAW,GACfA,SAASN,MAFEF,KAEWE,MACtBM,SAASC,UAAW,EACpBD,SAASE,WAAa,GACtBF,SAASG,aAAeJ,QAAU,GAClCC,SAASI,MAAQL,QANNP,KAONI,WAAWS,QAAQL,WAE1BH,gBAAiB,SAASH,MAAOC,SAAUC,gBAErCU,KAAOd,KACXc,KAAKZ,MAAQA,MACbY,KAAKV,WAAaA,WAElBV,EAAE,IAAMS,SAASY,SAAW,qCAAqCC,GAAG,SAAS,SAASC,GACpFH,KAAKR,cAAc,MAIrBY,OAAOC,iBAAiB,WAAW,SAASC,UAC1CzB,IAAIE,MAAM,eAAeuB,OAGjBA,MAAMC,SAAWlB,SAASmB,oBAI1BC,WAAaH,MAAMI,aAGC,IAAdD,YAA6BA,WAAWE,QAAUtB,SAASuB,GAAI,CACpDH,WAAWhB,QAE5Bb,EAAE,0BAA0BiC,KAAK,YAAY,GAC7CC,YAAW,WACPlC,EAAE,0BAA0BiC,KAAK,YAAY,GAC7Cb,KAAKR,cAAciB,WAAWhB,WAC/B,UAEN"}