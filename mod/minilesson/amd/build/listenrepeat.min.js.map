{"version":3,"file":"listenrepeat.min.js","sources":["../src/listenrepeat.js"],"sourcesContent":["define(['jquery', 'core/log', 'core/ajax', 'mod_minilesson/definitions', 'mod_minilesson/pollyhelper', 'mod_minilesson/cloudpoodllloader','mod_minilesson/ttrecorder'],\n    function($, log, ajax, def, polly, cloudpoodll, ttrecorder) {\n  \"use strict\"; // jshint ;_;\n\n  log.debug('MiniLesson listen and repeat: initialising');\n\n  return {\n\n      //for making multiple instances\n      clone: function () {\n          return $.extend(true, {}, this);\n      },\n\n      init: function(index, itemdata, quizhelper) {\n        var self = this;\n        var theCallback = function(message) {\n\n            switch (message.type) {\n                case 'recording':\n                    break;\n\n                case 'speech':\n                    log.debug(\"speech at listen_repeat\");\n                    self.getComparison(\n                        self.items[self.game.pointer].target,\n                        message.capturedspeech,\n                        self.items[self.game.pointer].phonetic,\n                        function(comparison) {\n                            self.gotComparison(comparison, message);\n                        }\n                    );\n                    break;\n\n            }\n\n        };\n\n        if(quizhelper.use_ttrecorder()) {\n            var opts = {};\n            opts.uniqueid = itemdata.uniqueid;\n            opts.callback = theCallback;\n            opts.stt_guided=quizhelper.is_stt_guided();\n            opts.wwwroot=quizhelper.is_stt_guided();\n            ttrecorder.clone().init(opts);\n        }else{\n            //init cloudpoodll push recorder\n            cloudpoodll.init('minilesson-recorder-listenrepeat-' + itemdata.id, theCallback);\n        }\n\n        self.itemdata = itemdata;\n        self.quizhelper = quizhelper;\n        self.index = index;\n        self.register_events();\n        self.setvoice();\n        self.getItems();\n    },\n\n    next_question:function(percent){\n      var self=this;\n      var stepdata = {};\n      stepdata.index = self.index;\n      stepdata.hasgrade = true;\n      stepdata.totalitems=self.items.length;\n      stepdata.correctitems=self.items.filter(function(e) {return e.correct;}).length;\n      stepdata.grade = Math.round((stepdata.correctitems/stepdata.totalitems)*100);\n      self.quizhelper.do_next(stepdata);\n    },\n    register_events: function() {\n\n      var self = this;\n      //on next button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .minilesson_nextbutton\").on('click', function(e) {\n        self.next_question();\n      });\n      //on start button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").on(\"click\", function() {\n        self.start();\n      });\n      //on listen button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_listen_btn\").on(\"click\", function() {\n        self.items[self.game.pointer].audio.load();\n        self.items[self.game.pointer].audio.play();\n      });\n      //on skip button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_skip_btn\").on(\"click\", function() {\n        //disable the buttons\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n        //reveal the prompt\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speech.landr_teacher_left\").text(self.items[self.game.pointer].prompt + \"\");\n        //reveal the answer\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord\").each(function() {\n          var realidx = $(this).data(\"realidx\");\n          var landr_targetWord = self.items[self.game.pointer].landr_targetWords[realidx];\n          $(this).val(landr_targetWord);\n        });\n\n        //move on after 3s\n        setTimeout(function() {\n          if (self.game.pointer < self.items.length - 1) {\n            self.items[self.game.pointer].answered = true;\n            self.items[self.game.pointer].correct = false;\n            self.game.pointer++;\n            self.nextPrompt();\n          } else {\n            self.end();\n          }\n        }, 3000);\n      });\n      \n    },\n    \n\n    game: {\n      pointer: 0\n    },\n    usevoice: '',\n    setvoice: function() {\n            var self = this;\n            self.usevoice = self.itemdata.usevoice;\n            self.voiceoption=self.itemdata.voiceoption;\n            return;\n    },\n    getItems: function() {\n      var self = this;\n      var text_items = self.itemdata.sentences;\n\n      self.items = text_items.map(function(target) {\n        return {\n          landr_targetWords: target.sentence.trim().split(self.quizhelper.spliton_regexp).filter(function(e) {\n            return e !== \"\";\n          }),\n          target: target.sentence,\n          prompt: target.prompt,\n          displayprompt: target.displayprompt,\n          phonetic: target.phonetic,\n          typed: \"\",\n          answered: false,\n          correct: false,\n          audio: null\n        };\n      }).filter(function(e) {\n        return e.target !== \"\";\n      });\n\n\n      $.each(self.items, function(index, item) {\n        polly.fetch_polly_url(item.prompt,  self.voiceoption, self.usevoice).then(function(audiourl) {\n          item.audio = new Audio();\n          item.audio.src = audiourl;\n          if (self.items.filter(function(e) {\n              return e.audio === null\n            }).length === 0) {\n            self.appReady();\n          }\n        });\n      });\n\n\n\n    },\n    appReady: function() {\n      var self = this;\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_not_loaded\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_loaded\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").prop(\"disabled\", false);\n    },\n    gotComparison: function(comparison, typed) {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord\").removeClass(\"landr_correct landr_incorrect\");\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_feedback\").removeClass(\"fa fa-check fa-times\");\n\n      var allCorrect = comparison.filter(function(e){return !e.matched;}).length==0;\n      \n      if (allCorrect && comparison && comparison.length>0) {\n        \n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord\").addClass(\"landr_correct\");\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_feedback\").addClass(\"fa fa-check\");\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speech.landr_teacher_left\").text(self.items[self.game.pointer].target + \"\");\n\n        self.items[self.game.pointer].answered = true;\n        self.items[self.game.pointer].correct = true;\n        self.items[self.game.pointer].typed = typed;\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n        if (self.game.pointer < self.items.length - 1) {\n          setTimeout(function() {\n            self.game.pointer++;\n            self.nextPrompt();\n          }, 3000);\n        } else {\n          setTimeout(function() {\n            self.end();\n          }, 3000);\n        }\n\n      } else {\n        //mark up the words as correct or not\n        comparison.forEach(function(obj) {\n          if(!obj.matched){\n            $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"landr_incorrect\");\n            $(\"#\" + self.itemdata.uniqueid + \"_container .landr_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-times\");\n          } else {\n            $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"landr_correct\");\n            $(\"#\" + self.itemdata.uniqueid + \"_container .landr_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-check\");\n          }\n        });\n        //shake the screen\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_reply_\" + self.game.pointer).effect(\"shake\", function() {\n          $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", false);\n        });\n\n      }\n      //show all the correct words\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord.landr_correct\").each(function() {\n        var realidx = $(this).data(\"realidx\");\n        var landr_targetWord = self.items[self.game.pointer].landr_targetWords[realidx];\n        $(this).val(landr_targetWord);\n      });\n\n    },\n    getWords: function(thetext) {\n      var self = this;\n      var checkcase = false;\n      if (checkcase == 'false') {\n        thetext = thetext.toLowerCase();\n      }\n      var chunks = thetext.split(self.quizhelper.spliton_regexp).filter(function(e) {\n        return e !== \"\";\n      });\n      var words = [];\n      for (var i = 0; i < chunks.length; i++) {\n        if (!chunks[i].match(self.quizhelper.spliton_regexp)) {\n          words.push(chunks[i]);\n        }\n      }\n      return words;\n    },\n    getComparison: function(passage, transcript, phonetic, callback) {\n      var self = this;\n      \n      $(\".landr_ctrl-btn\").prop(\"disabled\", true);\n      self.quizhelper.comparePassageToTranscript(passage,transcript,phonetic,self.itemdata.language).then(function(ajaxresult) {\n            var payloadobject = JSON.parse(ajaxresult);\n            if (payloadobject) {\n                callback(payloadobject);\n            } else {\n                callback(false);\n            }\n       });\n\n    },\n    end: function() {\n      var self = this;\n\n      var numCorrect = self.items.filter(function(e) {\n        return e.correct;\n      }).length;\n\n      var totalNum = self.items.length;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_results\").html(\"TOTAL<br/>\" + numCorrect + \"/\" + totalNum).show();\n      \n      $(\".minilesson_nextbutton\").prop(\"disabled\",true);\n      setTimeout(function() {\n        \n        $(\".minilesson_nextbutton\").prop(\"disabled\",false);\n        self.next_question();\n        \n      }, 2000);\n\n    },\n    start: function() {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speakbtncontainer\").show();\n\n      self.items.forEach(function(item) {\n        item.spoken = \"\";\n        item.answered = false;\n        item.correct = false;\n      });\n\n      self.game.pointer = 0;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_mainmenu\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_controls\").show();\n\n      self.nextPrompt();\n\n    },\n    nextPrompt: function() {\n      var showText = parseInt(this.itemdata.show_text);\n      var self = this;\n\n      var target = self.items[self.game.pointer].target;\n      var displayprompt = self.items[self.game.pointer].displayprompt;\n      var code = \"<div class='landr_prompt landr_prompt_\" + self.game.pointer + \"' style='display:none;'>\";\n\n      code += \"<i class='fa fa-graduation-cap landr_speech-icon-left'></i>\";\n      code += \"<div style='margin-left:90px;' class='landr_speech landr_teacher_left'>\";\n      if(!showText){\n        var nopunc = displayprompt.replace(self.quizhelper.nopunc_regexp,\"\");\n        var dots = nopunc.replace(self.quizhelper.nonspaces_regexp, '•');\n        code += dots;\n      } else{\n        code += displayprompt;\n      }\n      code += \"</div>\";\n      code += \"</div>\";\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").html(code);\n      $(\".landr_ctrl-btn\").prop(\"disabled\", false);\n\n      var color;\n\n      var progress = self.items.map(function(item, idx) {\n        color = \"gray\";\n        if (self.items[idx].answered && self.items[idx].correct) {\n          color = \"green\";\n        } else if (self.items[idx].answered && !self.items[idx].correct) {\n          color = \"red\";\n        }\n        return \"<i style='color:\" + color + \"' class='fa fa-circle'></i>\";\n      }).join(\" \");\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_title\").html(progress);\n      $(\".landr_prompt_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'left'\n      });\n\n      self.nextReply();\n\n    },\n    nextReply: function() {\n      var self = this;\n      var target = self.items[self.game.pointer].target;\n      var code = \"<div class='landr_reply landr_reply_\" + self.game.pointer + \"' style='display:none;'>\";\n      code += \"<i class='fa fa-user landr_speech-icon-right'></i>\";\n      var landr_targetWordsCode = \"\";\n      var idx = 1;\n      self.items[self.game.pointer].landr_targetWords.forEach(function(word, realidx) {\n        if (!word.match(self.quizhelper.spliton_regexp)) {\n          landr_targetWordsCode += \"<ruby><input disabled type='text' maxlength='\" + word.length + \"' size='\" + (word.length + 1) + \"' class='landr_targetWord' data-realidx='\" + realidx + \"' data-idx='\" + idx + \"'><rt><i data-idx='\" + idx + \"' class='landr_feedback'></i></rt></ruby>\";\n          idx++;\n\n        } else {\n          landr_targetWordsCode += word;\n        }\n      });\n      code += \"<div style='margin-right:90px;' class='landr_speech landr_right'>\" + landr_targetWordsCode + \"</div>\";\n      code += \"</div>\";\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").append(code);\n      $(\".landr_reply_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'right'\n      });\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", false);\n      if(!self.quizhelper.mobile_user()){\n        setTimeout(function(){\n          $(\"#\" + self.itemdata.uniqueid + \"_container .landr_listen_btn\").trigger('click');\n        },1000);\n      }\n    }\n\n  };\n});"],"names":["define","$","log","ajax","def","polly","cloudpoodll","ttrecorder","debug","clone","extend","this","init","index","itemdata","quizhelper","self","theCallback","message","type","getComparison","items","game","pointer","target","capturedspeech","phonetic","comparison","gotComparison","use_ttrecorder","opts","uniqueid","callback","stt_guided","is_stt_guided","wwwroot","id","register_events","setvoice","getItems","next_question","percent","stepdata","hasgrade","totalitems","length","correctitems","filter","e","correct","grade","Math","round","do_next","on","start","audio","load","play","prop","text","prompt","each","realidx","data","landr_targetWord","landr_targetWords","val","setTimeout","answered","nextPrompt","end","usevoice","voiceoption","text_items","sentences","map","sentence","trim","split","spliton_regexp","displayprompt","typed","item","fetch_polly_url","then","audiourl","Audio","src","appReady","hide","show","removeClass","matched","addClass","forEach","obj","wordnumber","effect","getWords","thetext","chunks","words","i","match","push","passage","transcript","comparePassageToTranscript","language","ajaxresult","payloadobject","JSON","parse","numCorrect","totalNum","html","spoken","color","showText","parseInt","show_text","code","replace","nopunc_regexp","nonspaces_regexp","progress","idx","join","toggle","direction","nextReply","landr_targetWordsCode","word","append","mobile_user","trigger"],"mappings":"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"}