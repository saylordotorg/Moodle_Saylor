{"version":3,"sources":["../src/activitycontroller.js"],"names":["define","$","jqui","log","def","quizhelper","polly","debug","cmid","activitydata","sorryboxid","controls","init","props","dd","theid","widgetid","configcontrol","get","JSON","parse","value","remove","attemptid","token","region","owner","register_events","process_html","doquizlayout","opts","introbox","quizcontainer","feedbackcontainer","errorcontainer","instructionscontainer","wheretonextcontainer","hide","show","doerrorlayout"],"mappings":"AACAA,OAAM,qCAAC,CAAC,QAAD,CAAU,UAAV,CAAsB,UAAtB,CAAiC,4BAAjC,CAA8D,2BAA9D,CAA0F,4BAA1F,CAAD,CAA0H,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAuBC,CAAvB,CAA6BC,CAA7B,CAAwCC,CAAxC,CAA+C,CAE3K,aAEAH,CAAG,CAACI,KAAJ,CAAU,mCAAV,EAEA,MAAO,CAEHC,IAAI,CAAE,IAFH,CAGHC,YAAY,CAAE,IAHX,CAIHC,UAAU,CAAE,IAJT,CAKHC,QAAQ,CAAE,IALP,CAQHC,IAAI,CAAE,cAASC,CAAT,CAAe,IACbC,CAAAA,CAAE,CAAG,IADQ,CAIbC,CAAK,CAAC,YAAcF,CAAK,CAACG,QAJb,CAKbC,CAAa,CAAGhB,CAAC,CAACc,CAAD,CAAD,CAASG,GAAT,CAAa,CAAb,CALH,CAMjB,GAAGD,CAAH,CAAiB,CACbH,CAAE,CAACL,YAAH,CAAkBU,IAAI,CAACC,KAAL,CAAWH,CAAa,CAACI,KAAzB,CAAlB,CACApB,CAAC,CAACc,CAAD,CAAD,CAASO,MAAT,EACH,CAHD,IAGK,CAEDnB,CAAG,CAACI,KAAJ,CAAU,qEAAV,EACA,MACH,CAEDO,CAAE,CAACN,IAAH,CAAUK,CAAK,CAACL,IAAhB,CACAM,CAAE,CAACS,SAAH,CAAe,CAAf,CACAT,CAAE,CAACJ,UAAH,CAAgBG,CAAK,CAACG,QAAN,CAAiB,WAAjC,CAEAV,CAAK,CAACM,IAAN,CAAWE,CAAE,CAACL,YAAH,CAAgBe,KAA3B,CAAiCV,CAAE,CAACL,YAAH,CAAgBgB,MAAjD,CAAwDX,CAAE,CAACL,YAAH,CAAgBiB,KAAxE,EAEAZ,CAAE,CAACa,eAAH,GACAb,CAAE,CAACc,YAAH,GAEAd,CAAE,CAACe,YAAH,EACH,CAjCE,CAmCHD,YAAY,CAAE,uBAAU,IAChBE,CAAAA,CAAI,CAAG,KAAKrB,YADI,CAIhBE,CAAQ,CAAE,CACVoB,QAAQ,CAAE9B,CAAC,kBADD,CAEV+B,aAAa,CAAE/B,CAAC,CAAC,IAAO6B,CAAI,cAAZ,CAFN,CAGVG,iBAAiB,CAAEhC,CAAC,CAAC,IAAO6B,CAAI,kBAAZ,CAHV,CAIVI,cAAc,CAAEjC,CAAC,CAAC,IAAO6B,CAAI,eAAZ,CAJP,CAKVK,qBAAqB,CAAElC,CAAC,CAAC,IAAO6B,CAAI,sBAAZ,CALd,CAMVM,oBAAoB,CAAEnC,CAAC,CAAC,IAAO6B,CAAI,qBAAZ,CANb,CAJM,CAYpB,KAAKnB,QAAL,CAAgBA,CACnB,CAhDE,CAkDHgB,eAAe,CAAE,0BAAW,CAG3B,CArDE,CAuDHE,YAAY,CAAE,uBAAU,CACpB,GAAIf,CAAAA,CAAE,CAAG,IAAT,CACAA,CAAE,CAACH,QAAH,CAAYwB,qBAAZ,CAAkCE,IAAlC,GAIAhC,CAAU,CAACO,IAAX,CAAgBE,CAAE,CAACH,QAAH,CAAYqB,aAA5B,CACI,KAAKvB,YADT,CAEI,KAAKD,IAFT,CAGI,KAAKe,SAHT,CAIIjB,CAJJ,EAOAQ,CAAE,CAACH,QAAH,CAAYqB,aAAZ,CAA0BM,IAA1B,EAEH,CAtEE,CAwEHC,aAAa,CAAE,wBAAU,CACrB,KAAK5B,QAAL,CAAcuB,cAAd,CAA6BI,IAA7B,GACA,KAAK3B,QAAL,CAAcyB,oBAAd,CAAmCE,IAAnC,EACH,CA3EE,CA6EV,CAnFK,CAAN","sourcesContent":["/* jshint ignore:start */\ndefine(['jquery','jqueryui', 'core/log','mod_minilesson/definitions','mod_minilesson/quizhelper','mod_minilesson/pollyhelper'], function($, jqui, log, def,  quizhelper,polly) {\n\n    \"use strict\"; // jshint ;_;\n\n    log.debug('Activity controller: initialising');\n\n    return {\n\n        cmid: null,\n        activitydata: null,\n        sorryboxid: null,\n        controls: null,\n\n        //pass in config, the jquery video/audio object, and a function to be called when conversion has finshed\n        init: function(props){\n            var dd = this;\n\n            //pick up opts from html\n            var theid='#amdopts_' + props.widgetid;\n            var configcontrol = $(theid).get(0);\n            if(configcontrol){\n                dd.activitydata = JSON.parse(configcontrol.value);\n                $(theid).remove();\n            }else{\n                //if there is no config we might as well give up\n                log.debug('MiniLesson activity Controller: No config found on page. Giving up.');\n                return;\n            }\n\n            dd.cmid = props.cmid;\n            dd.attemptid = 1;\n            dd.sorryboxid = props.widgetid + '_sorrybox';\n\n            polly.init(dd.activitydata.token,dd.activitydata.region,dd.activitydata.owner);\n\n            dd.register_events();\n            dd.process_html();\n            //OR to show quiz and no recorder do dd.doquizlayout\n            dd.doquizlayout();\n        },\n\n        process_html: function(){\n            var opts = this.activitydata;\n            //these css classes/ids are all passed in from php in\n            //renderer.php::fetch_activity_amd\n            var controls ={\n                introbox: $('.' + 'mod_intro_box'),\n                quizcontainer: $('.' +  opts['quizcontainer']),\n                feedbackcontainer: $('.' +  opts['feedbackcontainer']),\n                errorcontainer: $('.' +  opts['errorcontainer']),\n                instructionscontainer: $('.' +  opts['instructionscontainer']),\n                wheretonextcontainer: $('.' +  opts['wheretonextcontainer'])\n            };\n            this.controls = controls;\n        },\n\n        register_events: function() {\n           //do something\n\n        },\n\n        doquizlayout: function(){\n            var dd = this;\n            dd.controls.instructionscontainer.hide();\n\n            //set up the quiz\n           // quizhelper.onSubmit = function(returndata){dd.dofinishedreadinglayout(returndata);};\n            quizhelper.init(dd.controls.quizcontainer,\n                this.activitydata,\n                this.cmid,\n                this.attemptid,\n                polly);\n\n            //show the quiz\n            dd.controls.quizcontainer.show();\n\n        },\n\n        doerrorlayout: function(){\n            this.controls.errorcontainer.show();\n            this.controls.wheretonextcontainer.show();\n        }\n    };//end of returned object\n});//total end\n"],"file":"activitycontroller.min.js"}