{"version":3,"file":"dictationchat.min.js","sources":["../src/dictationchat.js"],"sourcesContent":["define(['jquery', 'core/log', 'core/ajax', 'mod_minilesson/definitions', 'mod_minilesson/pollyhelper'], function($, log, ajax, def, polly) {\n  \"use strict\"; // jshint ;_;\n\n  log.debug('MiniLesson dictation chat: initialising');\n\n  return {\n\n      //for making multiple instances\n      clone: function () {\n          return $.extend(true, {}, this);\n      },\n\n      usevoice: 'Amy',\n\n      init: function(index, itemdata, quizhelper) {\n      var self = this;\n      self.itemdata = itemdata;\n      self.quizhelper = quizhelper;\n      self.index = index;\n      self.register_events();\n      self.setvoice();\n      self.getItems();\n\n    },\n    next_question:function(){\n      var self=this;\n      var stepdata = {};\n      stepdata.index = self.index;\n      stepdata.hasgrade = true;\n      stepdata.totalitems=self.items.length;\n      stepdata.correctitems=self.items.filter(function(e) {return e.correct;}).length;\n      stepdata.grade = Math.round((stepdata.correctitems/stepdata.totalitems)*100);\n      self.quizhelper.do_next(stepdata);\n    },\n\n    register_events: function() {\n\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .minilesson_nextbutton\").on('click', function(e) {\n        self.next_question();\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").on(\"click\", function() {\n        self.start();\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_btn\").on(\"click\", function() {\n        self.items[self.game.pointer].audio.load();\n        self.items[self.game.pointer].audio.play();\n      });\n\n      //on skip button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_skip_btn\").on(\"click\", function() {\n        //disable buttons\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n        //reveal prompt\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speech.dictate_teacher_left\").text(self.items[self.game.pointer].prompt + \"\");\n        //reveal answers\n        //reveal the answer\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").each(function() {\n          var realidx = $(this).data(\"realidx\");\n          var dictate_targetWord = self.items[self.game.pointer].dictate_targetWords[realidx];\n          $(this).val(dictate_targetWord);\n        });\n\n\n        //move on after 3s\n        setTimeout(function() {\n          if (self.game.pointer < self.items.length - 1) {\n            self.items[self.game.pointer].answered = true;\n            self.items[self.game.pointer].correct = false;\n            self.game.pointer++;\n            self.nextPrompt();\n          } else {\n            self.end();\n          }\n        }, 3000);\n      });\n\n      \n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_check_btn\").on(\"click\", function() {\n        self.check_answer();\n      });\n\n      //listen for enter key\n      $(\"#\" + self.itemdata.uniqueid + \"_container\").on(\"keydown\",\".dictate_targetWord\", function(e) {\n        if (e.which == 13) {\n          self.check_answer();\n        }\n      });\n\n      //auto nav between inputs\n      $(\"#\" + self.itemdata.uniqueid + \"_container\").on(\"keyup\",\".dictate_targetWord\", function(e) {\n\n        //move focus between textboxes\n        //log.debug(e);\n        var target = e.srcElement || e.target;\n        var maxLength = parseInt(target.attributes[\"maxlength\"].value, 10);\n        var myLength = target.value.length;\n        var key = e.which;\n        if (myLength >= maxLength) {\n          var next = $(this);\n          while (next = next.parent().next().children('input.dictate_targetWord')) {\n            if (next.length === 1){\n              next.focus();\n              break;\n            }else{\n              break;\n\n            }\n          }\n          // Move to previous field if empty (user pressed backspace or delete)\n        } else if (( key == 8 || key == 46 ) && myLength === 0) {\n          var previous = $(this);\n          while (previous = previous.parent().prev().children('input.dictate_targetWord')) {\n            if (previous.length === 1) {\n              previous.focus();\n              break;\n            }else{\n              break;\n            }\n          }\n        }\n      });\n      \n    },\n\n    game: {\n      pointer: 0\n    },\n\n    check_answer: function(){\n      var self = this;\n      var passage = self.items[self.game.pointer].target;\n      var transcriptArray = [];\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").each(function() {\n        transcriptArray.push($(this).val().trim() == \"\" ? \"|\" : $(this).val().trim());\n      });\n\n      var transcript = transcriptArray.join(\" \");\n\n      self.getComparison(passage, transcript, function(comparison) {\n        self.gotComparison(comparison, transcript);\n      });\n    },\n    setvoice: function() {\n        var self = this;\n        self.usevoice = self.itemdata.usevoice;\n        self.voiceoption=self.itemdata.voiceoption;\n        return;\n    },\n    getItems: function() {\n      var self = this;\n      var text_items = self.itemdata.sentences;\n\n      self.items = text_items.map(function(target) {\n        return {\n          dictate_targetWords: target.sentence.trim().split(self.quizhelper.spliton_regexp).filter(function(e) {\n            return e !== \"\";\n          }),\n          target: target.sentence,\n          prompt: target.prompt,\n          displayprompt: target.displayprompt,\n          typed: \"\",\n          answered: false,\n          correct: false,\n          audio: null\n        };\n      }).filter(function(e) {\n        return e.target !== \"\";\n      });\n\n      $.each(self.items, function(index, item) {\n        polly.fetch_polly_url(item.prompt,  self.voiceoption, self.usevoice).then(function(audiourl) {\n          item.audio = new Audio();\n          item.audio.src = audiourl;\n          if (self.items.filter(function(e) {\n              return e.audio == null\n            }).length == 0) {\n            self.appReady();\n          } else {\n            console.log(self.items);\n          }\n        });\n\n      });\n\n    },\n    appReady: function() {\n      var self = this;\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_not_loaded\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_loaded\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").prop(\"disabled\", false);\n    },\n    gotComparison: function(comparison, typed) {\n\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").removeClass(\"dictate_correct dictate_incorrect\");\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback\").removeClass(\"fa fa-check fa-times\");\n\n      var allCorrect = comparison.filter(function(e) {\n        return !e.matched;\n      }).length == 0;\n\n      if (allCorrect) {\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").addClass(\"dictate_correct\").prop(\"disabled\",true);\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback\").addClass(\"fa fa-check\");\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speech.dictate_teacher_left\").text(self.items[self.game.pointer].target + \"\");\n\n        self.items[self.game.pointer].answered = true;\n        self.items[self.game.pointer].correct = true;\n        self.items[self.game.pointer].typed = typed;\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n        if (self.game.pointer < self.items.length - 1) {\n          setTimeout(function() {\n            self.game.pointer++;\n            self.nextPrompt();\n          }, 3000);\n        } else {\n          setTimeout(function() {\n            self.end();\n          }, 3000);\n        }\n\n      } else {\n\n        comparison.forEach(function(obj) {\n          if (!obj.matched) {\n            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"dictate_incorrect\");\n            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-times\");\n          } else {\n            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"dictate_correct\").prop(\"disabled\",true);\n            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-check\");\n          }\n        });\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_reply_\" + self.game.pointer).effect(\"shake\", function() {\n          $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);\n        });\n\n      }\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord.dictate_correct\").each(function() {\n        var realidx = $(this).data(\"realidx\");\n        var dictate_targetWord = self.items[self.game.pointer].dictate_targetWords[realidx];\n        $(this).val(dictate_targetWord);\n      });\n\n    },\n    getWords: function(thetext) {\n      var self = this;\n      var checkcase = false;\n      if (checkcase == 'false') {\n        thetext = thetext.toLowerCase();\n      }\n      var chunks = thetext.split(self.quizhelper.spliton_regexp).filter(function(e) {\n        return e !== \"\";\n      });\n      var words = [];\n      for (var i = 0; i < chunks.length; i++) {\n        if (!chunks[i].match(self.quizhelper.spliton_regexp)) {\n          words.push(chunks[i]);\n        }\n      }\n      return words;\n    },\n    getComparison: function(passage, transcript, callback) {\n        var self = this;\n\n        $(\".dictate_ctrl-btn\").prop(\"disabled\", true);\n        var phonetic ='';//we do not want a phonetic match in dictation.\n        self.quizhelper.comparePassageToTranscript(passage,transcript,phonetic,self.itemdata.language).then(function(ajaxresult) {\n            var payloadobject = JSON.parse(ajaxresult);\n            if (payloadobject) {\n                callback(payloadobject);\n            } else {\n                callback(false);\n            }\n        });\n\n    },\n\n    end: function() {\n      var self = this;\n\n      var numCorrect = self.items.filter(function(e) {\n        return e.correct;\n      }).length;\n\n      var totalNum = self.items.length;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_results\").html(\"TOTAL<br/>\" + numCorrect + \"/\" + totalNum).show();\n      \n      $(\".minilesson_nextbutton\").prop(\"disabled\",true);\n      setTimeout(function() {\n        $(\".minilesson_nextbutton\").prop(\"disabled\",false);\n        self.next_question();\n      }, 2000);\n      \n\n    },\n    start: function() {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n\n      self.items.forEach(function(item) {\n        item.spoken = \"\";\n        item.answered = false;\n        item.correct = false;\n      });\n\n      self.game.pointer = 0;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_mainmenu\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_controls\").show();\n\n      self.nextPrompt();\n\n    },\n    nextPrompt: function() {\n\n      var self = this;\n      var target = self.items[self.game.pointer].target;\n      var prompt = self.items[self.game.pointer].prompt;\n      var displayprompt = self.items[self.game.pointer].displayprompt;\n\n      var nopunc = prompt.replace(self.quizhelper.nopunc_regexp,\"\");\n      var dots = nopunc.replace(self.quizhelper.nonspaces_regexp, 'â€¢');\n      var code = \"<div class='dictate_prompt dictate_prompt_\" + self.game.pointer + \"' style='display:none;'>\";\n\n      code += \"<i class='fa fa-graduation-cap dictate_speech-icon-left'></i>\";\n      code += \"<div style='margin-left:90px;' class='dictate_speech dictate_teacher_left'>\";\n      code += dots;\n      code += \"</div>\";\n      code += \"</div>\";\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").html(code);\n      $(\".dictate_ctrl-btn\").prop(\"disabled\", false);\n\n      var color;\n\n      var progress = self.items.map(function(item, idx) {\n        color = \"gray\";\n        if (self.items[idx].answered && self.items[idx].correct) {\n          color = \"green\";\n        } else if (self.items[idx].answered && !self.items[idx].correct) {\n          color = \"red\";\n        }\n        return \"<i style='color:\" + color + \"' class='fa fa-circle'></i>\";\n      }).join(\" \");\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_title\").html(progress);\n      $(\".dictate_prompt_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'left'\n      });\n\n      self.nextReply();\n\n    },\n    nextReply: function() {\n      var self = this;\n      var target = self.items[self.game.pointer].target;\n      var code = \"<div class='dictate_reply dictate_reply_\" + self.game.pointer + \"' style='display:none;'>\";\n      code += \"<i class='fa fa-user dictate_speech-icon-right'></i>\";\n      var dictate_targetWordsCode = \"\";\n      var idx = 1;\n      self.items[self.game.pointer].dictate_targetWords.forEach(function(word, realidx) {\n        if (!word.match(self.quizhelper.spliton_regexp)) {\n          dictate_targetWordsCode += \"<ruby><input type='text' maxlength='\" + word.length + \"' size='\" + (word.length + 1) + \"' class='dictate_targetWord' data-realidx='\" + realidx + \"' data-idx='\" + idx + \"'><rt><i data-idx='\" + idx + \"' class='dictate_feedback'></i></rt></ruby>\";\n          idx++;\n        } else {\n          dictate_targetWordsCode += word;\n        }\n      });\n      code += \"<div style='margin-right:90px;' class='dictate_speech dictate_right'>\" + dictate_targetWordsCode + \"</div>\";\n      code += \"</div>\";\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").append(code);\n      $(\".dictate_reply_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'right'\n      });\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);\n      setTimeout(function() {\n        $(\".dictate_targetWord\").first().focus();\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_btn\").trigger('click');\n      }, 500);\n    }\n\n  };\n});"],"names":["define","$","log","ajax","def","polly","debug","clone","extend","this","usevoice","init","index","itemdata","quizhelper","register_events","setvoice","getItems","next_question","stepdata","hasgrade","totalitems","items","length","correctitems","filter","e","correct","grade","Math","round","do_next","self","uniqueid","on","start","game","pointer","audio","load","play","prop","text","prompt","each","realidx","data","dictate_targetWord","dictate_targetWords","val","setTimeout","answered","nextPrompt","end","check_answer","which","target","srcElement","maxLength","parseInt","attributes","value","myLength","key","next","parent","children","focus","previous","prev","passage","transcriptArray","push","trim","transcript","join","getComparison","comparison","gotComparison","voiceoption","text_items","sentences","map","sentence","split","spliton_regexp","displayprompt","typed","item","fetch_polly_url","then","audiourl","Audio","src","appReady","console","hide","show","removeClass","matched","addClass","forEach","obj","wordnumber","effect","getWords","thetext","chunks","words","i","match","callback","comparePassageToTranscript","language","ajaxresult","payloadobject","JSON","parse","numCorrect","totalNum","html","spoken","color","dots","replace","nopunc_regexp","nonspaces_regexp","code","progress","idx","toggle","direction","nextReply","dictate_targetWordsCode","word","append","first","trigger"],"mappings":"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"}