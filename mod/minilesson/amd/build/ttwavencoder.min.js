define(["jquery","core/log"],function(a,b){"use strict";b.debug("TT Wav Encoder initialising");return{clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.sampleRate=a;this.numChannels=b;this.numSamples=0;this.dataViews=[]},encode:function encode(a){if(this.dataViews===void 0){return}for(var b=a[0].length,c=this.numChannels,d=new DataView(new ArrayBuffer(2*(b*c))),e=0,f=0;f<b;++f){for(var g=0,h;g<c;++g){h=32767*a[g][f];d.setInt16(e,0>h?Math.max(h,-32768):Math.min(h,32767),!0);e+=2}}this.dataViews.push(d);this.numSamples+=b},setString:function setString(a,b,c){for(var d=c.length,e=0;e<d;++e){a.setUint8(b+e,c.charCodeAt(e))}},finish:function finish(){var a=2*(this.numChannels*this.numSamples),b=new DataView(new ArrayBuffer(44));this.setString(b,0,"RIFF");b.setUint32(4,36+a,!0);this.setString(b,8,"WAVE");this.setString(b,12,"fmt ");b.setUint32(16,16,!0);b.setUint16(20,1,!0);b.setUint16(22,this.numChannels,!0);b.setUint32(24,this.sampleRate,!0);b.setUint32(28,4*this.sampleRate,!0);b.setUint16(32,2*this.numChannels,!0);b.setUint16(34,16,!0);this.setString(b,36,"data");b.setUint32(40,a,!0);this.dataViews.unshift(b);var c=new Blob(this.dataViews,{type:"audio/wav"});this.cleanup();return c},cancel:function cancel(){delete this.dataViews},cleanup:function cleanup(){this.cancel()}}});
//# sourceMappingURL=ttwavencoder.min.js.map
