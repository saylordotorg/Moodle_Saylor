/**
 * Add a create new group modal to the page.
 *
 * @module     mod_minilesson/modaldeletehelper
 * @class      modaldeletehelper
 * @package    mod_minilesson
 * @copyright  2020 Justin Hunt <poodllsupport@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["jquery","core/log","core/str","core/modal_factory","core/modal_events","core/ajax","core/notification"],(function($,log,Str,ModalFactory,ModalEvents,Ajax,Notification){var TheForm=function(selector,contextid,formname,callback){this.contextid=contextid,this.formname=formname,this.callback=callback,this.preinit(selector)};return TheForm.prototype.modal=null,TheForm.prototype.contextid=-1,TheForm.prototype.itemname="",TheForm.prototype.itemid=-1,TheForm.prototype.formname="",TheForm.prototype.formmessage="Really delete:",TheForm.prototype.preinit=function(selector){$(selector);var dd=this;Str.get_string(this.formname,"mod_minilesson").then((function(title){dd.formtitle=title})),Str.get_string(this.formname+"_message","mod_minilesson").then((function(message){dd.formmessage=message})),Str.get_string("deletebuttonlabel","mod_minilesson").then((function(deletebuttonlabel){dd.deletebuttonlabel=deletebuttonlabel})),$("body").on("click",selector,(function(e){e.preventDefault();var clickedLink=$(e.currentTarget),itemid=clickedLink.data("id");dd.itemid=itemid;var itemname=clickedLink.data("name");ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:dd.formtitle,body:dd.formmessage+"<i>"+itemname+"</i>"}).then((function(modal){return dd.modal=modal,dd.modal.setSaveButtonText(dd.deletebuttonlabel),dd.modal.getRoot().on(ModalEvents.save,dd.submitForm.bind(dd)),dd.modal.show(),dd.modal}))}))},TheForm.prototype.submitForm=function(e){e.preventDefault();var dd=this;log.debug("deleting:"+dd.formname),Ajax.call([{methodname:"mod_minilesson_delete_item",args:{itemid:dd.itemid,contextid:dd.contextid,formname:dd.formname},done:function(ajaxresult){var payloadobject=JSON.parse(ajaxresult);if(payloadobject)if(log.debug(payloadobject),!1===payloadobject.error)dd.callback(dd.itemid);else log.debug("that was an error: ");dd.modal.hide()},fail:Notification.exception}])},{init:function(selector,contextid,formname,callback){return new TheForm(selector,contextid,formname,callback)}}}));

//# sourceMappingURL=modaldeletehelper.min.js.map