{"name":"Login Failure Logging","description":"{\"text\":\"<p>This workflow sends details of failed login attempts to an external system via HTTP Post.<br><\\\/p>\",\"format\":\"1\"}","event":"\\core\\event\\user_login_failed","steps":{"96":{"id":"96","name":"User Lookup","description":"Lookup the details of the user who failed to login.","type":"lookups","stepclass":"\\tool_trigger\\steps\\lookups\\user_lookup_step","data":"{\"useridfield\":\"userid\",\"outputprefix\":\"user_\",\"nodeleted\":\"1\",\"stepdesc\":\"User lookup\",\"typedesc\":\"Lookup\"}","steporder":"0"},"98":{"id":"98","name":"HTTP Post","description":"Let an external system know about the failed login for this user.\r\nYou will need to update the URL to the correct one for your setup.","type":"actions","stepclass":"\\tool_trigger\\steps\\actions\\http_post_action_step","data":"{\"url\":\"http:\\\/\\\/localhost:8000\\\/yj323byj\",\"httpheaders\":\"Content-Type: application\\\/json\\r\\nAccept: application\\\/json\",\"httpparams\":\"user[0]={user_id}&user[1]={user_username}&user[2]={user_firstname}&user[3]={user_lastname}\",\"jsonencode\":\"1\",\"stepdesc\":\"HTTP Post\",\"typedesc\":\"Action\"}","steporder":"1"}},"moodleversion":"2018083100","pluginversion":"2018082401"}