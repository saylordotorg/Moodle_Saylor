{"version":3,"file":"overview.min.js","sources":["../src/overview.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nrequire.config({\n    paths: {\n        'datatables.net': M.cfg.wwwroot + '/report/myfeedback/vendor/js/jquery.dataTables.min',\n        'datatables.net-buttons': M.cfg.wwwroot + '/report/myfeedback/vendor/js/dataTables.buttons.min',\n        'datatables.net-colreorder': M.cfg.wwwroot + '/report/myfeedback/vendor/js/dataTables.colReorder.min',\n        'datatables.net-fixedheader': M.cfg.wwwroot + '/report/myfeedback/vendor/js/dataTables.fixedHeader.min',\n        'datatables.net-responsive': M.cfg.wwwroot + '/report/myfeedback/vendor/js/dataTables.responsive.min',\n    },\n});\n\ndefine([\n    'jquery',\n    'datatables.net',\n    'datatables.net-buttons',\n    'datatables.net-colreorder',\n    'datatables.net-fixedheader',\n    'datatables.net-responsive',\n], function($) {\n\n    return {\n        init: function() {\n            /* Plugin API method to determine is a column is sortable */\n            $.fn.dataTable.Api.register( 'column().searchable()', function () {\n                var ctx = this.context[0];\n                return ctx.aoColumns[this[0]].bSearchable;\n            } );\n\n            $(document).ready( function () {\n\n                // Before initializing Datatables get the cells in the second row of the header so you can reference them later on\n                var filterCells = $('thead tr:eq(1) td');\n\n                // Initialize the DataTable.\n                var table = $('#grades').DataTable( {\n                    dom: 'RlfBrtip',\n                    fixedHeader: true,\n                    pageLength: 25,\n                    orderCellsTop: true,\n                    columnDefs: [\n                        { targets: [ 5, 8 ],\n                            searchable: false,\n                            orderable:  false\n                        }\n                    ],\n                    order: [[4, 'desc']],\n                    buttons: ['colvis'],\n                    stateSave: true,\n                    stateSaveCallback: function(settings,data) {\n                        localStorage.setItem( 'Overview', JSON.stringify(data) );\n                    },\n                    stateLoadCallback: function() {\n                        return JSON.parse( localStorage.getItem( 'Overview' ) );\n                    },\n                    responsive: true\n                } );\n\n                // Add filtering.\n                table.columns().every( function () {\n                    if ( this.searchable() ) {\n                        var that = this;\n\n                        // Create the `select` element\n                        var select = $('<select><option value=\\\"\\\"></option></select>')\n                            .appendTo(\n                                filterCells.eq( table.colReorder.transpose( this.index(), 'toOriginal' ) )\n                            )\n                            .on( 'change', function() {\n                                that\n                                    .search($(this).val())\n                                    .draw();\n                            } );\n\n                        // Add data.\n                        this\n                            .data()\n                            .sort()\n                            .unique()\n                            .each( function(d) {\n                                select.append($('<option>' + d + '</option>'));\n                            } );\n\n                        // Restore state saved values.\n                        var state = this.state.loaded();\n                        if ( state ) {\n                            var val = state.columns[this.index()];\n                            select.val( val.search.search );\n                        }\n                    }\n                });\n\n                // When button is clicked to reset table.\n                $('#tableDestroy').on('click', function () {\n                    table.colReorder.reset();\n                    table.destroy(false);\n                    $('thead select').val('').change();\n                    table.state.clear();\n                    location.reload();\n                } );\n\n                $('#exportexcel').on('click', function() {\n                    window.location.href= 'export.php';\n                });\n\n                $('#reportPrint').on('click', function () {\n                    print();\n                });\n\n                $('#toggle-grade').on('click', function () {\n                    $('.t-rel').toggleClass('off');\n                });\n\n            });\n        }\n    };\n});\n"],"names":["require","config","paths","M","cfg","wwwroot","define","$","init","fn","dataTable","Api","register","this","context","aoColumns","bSearchable","document","ready","filterCells","table","DataTable","dom","fixedHeader","pageLength","orderCellsTop","columnDefs","targets","searchable","orderable","order","buttons","stateSave","stateSaveCallback","settings","data","localStorage","setItem","JSON","stringify","stateLoadCallback","parse","getItem","responsive","columns","every","that","select","appendTo","eq","colReorder","transpose","index","on","search","val","draw","sort","unique","each","d","append","state","loaded","reset","destroy","change","clear","location","reload","window","href","print","toggleClass"],"mappings":"AAeAA,QAAQC,OAAO,CACXC,MAAO,kBACeC,EAAEC,IAAIC,QAAU,8EACRF,EAAEC,IAAIC,QAAU,kFACbF,EAAEC,IAAIC,QAAU,sFACfF,EAAEC,IAAIC,QAAU,sFACjBF,EAAEC,IAAIC,QAAU,4DAIrDC,oCAAO,CACH,SACA,iBACA,yBACA,4BACA,6BACA,8BACD,SAASC,SAED,CACHC,KAAM,WAEFD,EAAEE,GAAGC,UAAUC,IAAIC,SAAU,yBAAyB,kBACxCC,KAAKC,QAAQ,GACZC,UAAUF,KAAK,IAAIG,eAGlCT,EAAEU,UAAUC,OAAO,eAGXC,YAAcZ,EAAE,qBAGhBa,MAAQb,EAAE,WAAWc,UAAW,CAChCC,IAAK,WACLC,aAAa,EACbC,WAAY,GACZC,eAAe,EACfC,WAAY,CACR,CAAEC,QAAS,CAAE,EAAG,GACZC,YAAY,EACZC,WAAY,IAGpBC,MAAO,CAAC,CAAC,EAAG,SACZC,QAAS,CAAC,UACVC,WAAW,EACXC,kBAAmB,SAASC,SAASC,MACjCC,aAAaC,QAAS,WAAYC,KAAKC,UAAUJ,QAErDK,kBAAmB,kBACRF,KAAKG,MAAOL,aAAaM,QAAS,cAE7CC,YAAY,IAIhBvB,MAAMwB,UAAUC,OAAO,cACdhC,KAAKe,aAAe,KACjBkB,KAAOjC,KAGPkC,OAASxC,EAAE,+CACVyC,SACG7B,YAAY8B,GAAI7B,MAAM8B,WAAWC,UAAWtC,KAAKuC,QAAS,gBAE7DC,GAAI,UAAU,WACXP,KACKQ,OAAO/C,EAAEM,MAAM0C,OACfC,eAKRrB,OACAsB,OACAC,SACAC,MAAM,SAASC,GACZb,OAAOc,OAAOtD,EAAE,WAAaqD,EAAI,qBAIrCE,MAAQjD,KAAKiD,MAAMC,YAClBD,MAAQ,KACLP,IAAMO,MAAMlB,QAAQ/B,KAAKuC,SAC7BL,OAAOQ,IAAKA,IAAID,OAAOA,aAMnC/C,EAAE,iBAAiB8C,GAAG,SAAS,WAC3BjC,MAAM8B,WAAWc,QACjB5C,MAAM6C,SAAQ,GACd1D,EAAE,gBAAgBgD,IAAI,IAAIW,SAC1B9C,MAAM0C,MAAMK,QACZC,SAASC,YAGb9D,EAAE,gBAAgB8C,GAAG,SAAS,WAC1BiB,OAAOF,SAASG,KAAM,gBAG1BhE,EAAE,gBAAgB8C,GAAG,SAAS,WAC1BmB,WAGJjE,EAAE,iBAAiB8C,GAAG,SAAS,WAC3B9C,EAAE,UAAUkE,YAAY"}