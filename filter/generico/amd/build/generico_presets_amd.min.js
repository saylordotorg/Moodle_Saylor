define ("filter_generico/generico_presets_amd",["jquery","core/log"],function(a,b){"use strict";b.debug("Filter Generico Presets initialising");return{presetdata:!1,dataitems:["key","name","instructions","requirecss","requirejs","shim","defaults","amd","body","bodyend","script","style","dataset","datasetvars","alternate","alternateend","version"],fetchcontrols:function fetchcontrols(a){var b={key:document.getElementById("id_s_filter_generico_templatekey_"+a),name:document.getElementById("id_s_filter_generico_templatename_"+a),instructions:document.getElementById("id_s_filter_generico_templateinstructions_"+a),requirecss:document.getElementById("id_s_filter_generico_templaterequire_css_"+a),requirejs:document.getElementById("id_s_filter_generico_templaterequire_js_"+a),shim:document.getElementById("id_s_filter_generico_templaterequire_js_shim_"+a),defaults:document.getElementById("id_s_filter_generico_templatedefaults_"+a),amd:document.getElementById("id_s_filter_generico_template_amd_"+a),body:document.getElementById("id_s_filter_generico_template_"+a),bodyend:document.getElementById("id_s_filter_generico_templateend_"+a),script:document.getElementById("id_s_filter_generico_templatescript_"+a),style:document.getElementById("id_s_filter_generico_templatestyle_"+a),dataset:document.getElementById("id_s_filter_generico_dataset_"+a),datasetvars:document.getElementById("id_s_filter_generico_datasetvars_"+a),alternate:document.getElementById("id_s_filter_generico_templatealternate_"+a),alternateend:document.getElementById("id_s_filter_generico_templatealternate_end_"+a),presetdata:document.getElementById("id_s_filter_generico_presetdata_"+a),version:document.getElementById("id_s_filter_generico_templateversion_"+a)};return b},fetchjsonbundle:function fetchjsonbundle(b,c){var d={};a.each(this.dataitems,function(a,b){d[b]=c[b].value});var e=JSON.stringify(d);return e},exportbundle:function exportbundle(a){var b=this.fetchcontrols(a);if(""==b.key.value){return}var c=this.fetchjsonbundle(a,b),d=document.createElement("a");d.setAttribute("href","data:text/json;charset=utf-8,"+encodeURIComponent(c));d.setAttribute("download",b.key.value+".txt");if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0);d.dispatchEvent(e)}else{d.click()}},populateform:function populateform(b,c,d){var e=this.fetchcontrols(b);if(!c&&!d){return}if(!(0==c&&d)){d=this.presetdata}a.each(this.dataitems,function(a,b){if(d[c].hasOwnProperty(b)){e[b].value=d[c][b]}else{switch(b){case"amd":e[b].value=0;break;default:e[b].value="";}}})},dopopulate:function dopopulate(a,b){this.populateform(a,0,Array(b))},init:function init(b){if(!this.presetdata){var c="#id_s_filter_generico_presetdata_"+b.templateindex,d=a(c).get(0);this.presetdata=JSON.parse(d.value);a(c).remove()}var e=this;a("select[name='filter_generico/presets']").change(function(){e.populateform(b.templateindex,a(this).val())});var f="#id_s_filter_generico_dragdropsquare_"+b.templateindex;a(f).on("click",function(){e.exportbundle(b.templateindex)});a(f).on("dragover",function(b){b.preventDefault();b.stopPropagation();a(this).addClass("filter_generico_dragging")});a(f).on("dragleave",function(b){b.preventDefault();b.stopPropagation();a(this).removeClass("filter_generico_dragging")});a(f).on("drop",function(c){c.preventDefault();var d=c.originalEvent.dataTransfer.files;if(d.length){var g=d[0];if(g){var f=new FileReader;f.onload=function(a){var c=a.target.result,d=JSON.parse(c);if(d.key){e.dopopulate(b.templateindex,d)}};f.readAsText(g)}else{alert("Failed to load file")}}a(this).removeClass("filter_generico_dragging")})}}});
//# sourceMappingURL=generico_presets_amd.min.js.map
