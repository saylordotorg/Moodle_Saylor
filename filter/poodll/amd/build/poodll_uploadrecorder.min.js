define ("filter_poodll/poodll_uploadrecorder",["jquery","core/log","filter_poodll/uploader"],function(a,b,c){"use strict";b.debug("PoodLL Upload Recorder: initialising");return{config:null,instanceprops:[],fetch_instance_props:function fetch_instance_props(a){return this.instanceprops[a]},init_instance_props:function init_instance_props(a){this.instanceprops[a]={config:null,uploader:null}},supports_current_browser:function supports_current_browser(){return!0},embed:function embed(a,b){this.init_instance_props(b.widgetid);var d=this.fetch_instance_props(b.widgetid);d.config=b;d.uploader=c.clone();d.uploader.init(a,b);this.insert_controls(a,b.widgetid);this.register_events(b.widgetid)},insert_controls:function insert_controls(b,c){var d=this.fetch_instance_props(c),e="",f=d.config;switch(f.mediatype){case"video":e="video/*";break;case"snapshot":case"image":e="image/*";case"audio":var g=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(g){e="video/*"}else{e="audio/*"}default:e="";}var h="<div class=\"p_btn_wrapper\">";h+="<input type=\"file\" id=\""+f.widgetid+"_poodllfileselect\" name=\"poodllfileselect[]\" accept=\""+e+"\"/>";h+="<button type=\"button\" class=\"p_btn\">"+M.util.get_string("recui_recordorchoose","filter_poodll")+"</button>";h+="</div>";a(b).prepend(h)},register_events:function register_events(b){var c=this;a("#"+b+"_poodllfileselect").on("change",function(a){c.FileSelectHandler(a,b)})},FileSelectHandler:function FileSelectHandler(a,c){for(var d=this.fetch_instance_props(c),e=a.target.files||a.dataTransfer.files,f=0,g;g=e[f];f++){b.debug("filetype:"+g.type);d.uploader.uploadBlob(g,g.type)}},ParseFile:function ParseFile(a,c){var d=this.fetch_instance_props(c),f="",g=new FileReader;g.onloadend=function(b){f=b.target.result;d.uploader.uploadFile(f,a.type)};b.debug("filetype:"+a.type);g.readAsDataURL(a)}}});
//# sourceMappingURL=poodll_uploadrecorder.min.js.map
