define(["jquery","core/log"],function(a,b){"use strict";return b.debug("Poodll util drag drop: initialising"),{theelement:!1,uploadfunction:!1,uploader:!1,started:!1,filebutton:!1,init:function(a,c,d){this.theelement=a,this.uploadfunction=c,this.uploader=d.uploader,this.filebutton=d.controlbar.filebutton,this.supports_dragdrop(a)?(b.debug("registering drag drop"),this.register_dragdrop(),this.do_visuals()):b.debug("drag drop not supported")},clone:function(){return a.extend(!0,{},this)},supports_dragdrop:function(a){return"draggable"in a||"ondragstart"in a&&"ondrop"in a},do_visuals:function(){this.theelement.addClass("poodll-can-do-drag-drop")},turnoff_dragdrop:function(){this.theelement&&(this.theelement.removeClass("poodll-can-do-drag-drop"),this.theelement.removeClass("is-poodll-drag-over"),this.theelement.off("drag dragstart dragend dragover dragenter dragleave drop"),this.theelement.on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault(),a.stopPropagation()}))},register_dragdrop:function(){var a=this;this.theelement.on("drag dragstart dragend dragover dragenter dragleave drop",function(b){b.preventDefault(),b.stopPropagation(),a.started}).on("dragover dragenter",function(){a.theelement.addClass("is-poodll-drag-over")}).on("dragleave dragend drop",function(){a.theelement.removeClass("is-poodll-drag-over")}).on("drop",function(b){if(!a.started){var c=b.originalEvent.dataTransfer.files;a.uploadfunction(c,a.uploader),a.turnoff_dragdrop(),a.filebutton.off("change"),a.filebutton.attr("disabled",!0),a.started=!0}})}}});