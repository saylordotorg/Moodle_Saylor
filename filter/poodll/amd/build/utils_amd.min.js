define(["jquery","core/log"],(function($,log){return log.debug("Filter PoodLL: utils initialising"),{timeouthandles:[],WhiteboardUploadHandler:function(recid,wboard,opts,theuploader){$("#"+recid+"_btn_upload_whiteboard")[0].disabled=!0,clearTimeout(this.timeouthandles[recid]);var cvs=this.getCvs(recid,wboard,opts);this.pokeVectorData(recid,wboard,opts),theuploader.uploadFile(cvs.toDataURL(),"image/png")},getCvs:function(recid,wboard){if(0==recid.indexOf("drawingboard_"))var cvs=wboard.canvas;else cvs=wboard.canvasForExport();return cvs},escapeColon:function(thestring){return thestring.replace(/:/,"\\:")},pokeVectorData:function(recid,wboard,opts){var vectordata="";vectordata=0==recid.indexOf("drawingboard_")?JSON.stringify(wboard.history,null,2):JSON.stringify(wboard.getSnapshot()),void 0!==opts.vectorcontrol&&""!==opts.vectorcontrol&&($("#"+this.escapeColon(opts.vectorcontrol)).val(vectordata),log.debug("Vectorcontrol:"+opts.vectorcontrol))},_concatenateWavBlobs:function(blobs,callback){for(var allbytes=[],loadedblobs=0,totalbytes=0,lng=blobs.length,i=0;i<lng;i++)!function(index){var fileReader=new FileReader;fileReader.onload=function(){var ab=this.result,audiodata=ab.slice(44);if(totalbytes+=audiodata.byteLength,allbytes[index]=audiodata,++loadedblobs==lng){var header=ab.slice(0,44);new DataView(header).setUint32(40,totalbytes,!0),allbytes.unshift(header);var wavblob=new Blob(allbytes,{type:"audio/wav"});log.debug(totalbytes),log.debug(allbytes),callback(wavblob)}},fileReader.readAsArrayBuffer(blobs[i])}(i)},_simpleConcatenateBlobs:function(blobs,type){return new Blob(blobs,{type:type})},doConcatenateBlobs:function(theblobs,thecallback){var mimetype=theblobs[0].type;switch(mimetype){case"audio/wav":case"audio/pcm":this._concatenateWavBlobs(theblobs,thecallback);break;default:thecallback(this._simpleConcatenateBlobs(theblobs,mimetype))}},bytesToSize:function(bytes){if(0===bytes)return"0 Bytes";var i=parseInt(Math.floor(Math.log(bytes)/Math.log(1e3)),10);return(bytes/Math.pow(1e3,i)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][i]},getTimeLength:function(milliseconds){var data=new Date(milliseconds);return data.getUTCHours()+" hours, "+data.getUTCMinutes()+" minutes and "+data.getUTCSeconds()+" second(s)"},has_mediarecorder:function(){return"undefined"!=typeof MediaRecorder},can_html5_record:function(mediatype){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)&&("audio"==mediatype||this.has_mediarecorder())},is_edge:function(){return navigator.userAgent.indexOf("Edge")>-1},is_chrome:function(){var isChromium=window.chrome,winNav=window.navigator,vendorName=winNav.vendor,isOpera=winNav.userAgent.indexOf("OPR")>-1,isIEedge=winNav.userAgent.indexOf("Edge")>-1;return!!winNav.userAgent.match("CriOS")||null!=isChromium&&"Google Inc."===vendorName&&!1===isOpera&&!1===isIEedge},is_safari:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},is_ios:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},is_opera:function(){return"undefined"!=typeof opera&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("OPR/")},is_android:function(){var ua=window.navigator.userAgent;return ua.indexOf("android")>-1||ua.indexOf("Android")>-1},is_ie:function(){var ms_ie=!1,ua=window.navigator.userAgent,old_ie=ua.indexOf("MSIE "),new_ie=ua.indexOf("Trident/"),edge=ua.indexOf("Edge/");return(old_ie>-1||new_ie>-1||edge>-1)&&(ms_ie=!0),ms_ie},parseQueryString:function(url){var urlParams={};return url.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),(function($0,$1,$2,$3){urlParams[$1]=$3})),urlParams}}}));

//# sourceMappingURL=utils_amd.min.js.map