!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.WaveSurfer=b():a.WaveSurfer=b()}(window,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},b.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},b.t=function(a,c){if(1&c&&(a=b(a)),8&c)return a;if(4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(b.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var e in a)b.d(d,e,function(b){return a[b]}.bind(null,e));return d},b.n=function(a){var c=a&&a.__esModule?function(){return a["default"]}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s="./src/wavesurfer.js")}({"./node_modules/debounce/index.js":function(a,b){function c(a,b,c){function d(){var j=Date.now()-h;j<b&&j>=0?e=setTimeout(d,b-j):(e=null,c||(i=a.apply(g,f),g=f=null))}var e,f,g,h,i;null==b&&(b=100);var j=function(){g=this,f=arguments,h=Date.now();var j=c&&!e;return e||(e=setTimeout(d,b)),j&&(i=a.apply(g,f),g=f=null),i};return j.clear=function(){e&&(clearTimeout(e),e=null)},j.flush=function(){e&&(i=a.apply(g,f),g=f=null,clearTimeout(e),e=null)},j}c.debounce=c,a.exports=c},"./src/drawer.canvasentry.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),a}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var h=d(c("./src/util/style.js")),i=d(c("./src/util/get-id.js")),j=function(){function a(){e(this,a),this.wave=null,this.waveCtx=null,this.progress=null,this.progressCtx=null,this.start=0,this.end=1,this.id=(0,i["default"])("undefined"!=typeof this.constructor.name?this.constructor.name.toLowerCase()+"_":"canvasentry_"),this.canvasContextAttributes={}}return g(a,[{key:"initWave",value:function(a){this.wave=a,this.waveCtx=this.wave.getContext("2d",this.canvasContextAttributes)}},{key:"initProgress",value:function(a){this.progress=a,this.progressCtx=this.progress.getContext("2d",this.canvasContextAttributes)}},{key:"updateDimensions",value:function(a,b,c,d){this.start=this.wave.offsetLeft/b||0,this.end=this.start+a/b,this.wave.width=c,this.wave.height=d;var e={width:a+"px"};(0,h["default"])(this.wave,e),this.hasProgressCanvas&&(this.progress.width=c,this.progress.height=d,(0,h["default"])(this.progress,e))}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height),this.hasProgressCanvas&&this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}},{key:"setFillStyles",value:function(a,b){this.waveCtx.fillStyle=a,this.hasProgressCanvas&&(this.progressCtx.fillStyle=b)}},{key:"fillRects",value:function(a,b,c,d,e){this.fillRectToContext(this.waveCtx,a,b,c,d,e),this.hasProgressCanvas&&this.fillRectToContext(this.progressCtx,a,b,c,d,e)}},{key:"fillRectToContext",value:function(a,b,c,d,e,f){a&&(f?this.drawRoundedRect(a,b,c,d,e,f):a.fillRect(b,c,d,e))}},{key:"drawRoundedRect",value:function(a,b,c,d,e,f){0!==e&&(e<0&&(e*=-1,c-=e),a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath(),a.fill())}},{key:"drawLines",value:function(a,b,c,d,e,f){this.drawLineToContext(this.waveCtx,a,b,c,d,e,f),this.hasProgressCanvas&&this.drawLineToContext(this.progressCtx,a,b,c,d,e,f)}},{key:"drawLineToContext",value:function(a,b,c,d,e,f,g){if(a){var h=b.length/2,i=Math.round(h*this.start),j=Math.round(h*this.end)+1,k=i,l=j,m=this.wave.width/(l-k-1),n=d+e,o=c/d;a.beginPath(),a.moveTo((k-i)*m,n),a.lineTo((k-i)*m,n-Math.round((b[2*k]||0)/o));var p,q,r;for(p=k;p<l;p++)q=b[2*p]||0,r=Math.round(q/o),a.lineTo((p-i)*m+this.halfPixel,n-r);var s=l-1;for(s;s>=k;s--)q=b[2*s+1]||0,r=Math.round(q/o),a.lineTo((s-i)*m+this.halfPixel,n-r);a.lineTo((k-i)*m,n-Math.round((b[2*k+1]||0)/o)),a.closePath(),a.fill()}}},{key:"destroy",value:function(){this.waveCtx=null,this.wave=null,this.progressCtx=null,this.progress=null}},{key:"getImage",value:function(a,b,c){var d=this;return"blob"===c?new Promise(function(c){d.wave.toBlob(c,a,b)}):"dataURL"===c?this.wave.toDataURL(a,b):void 0}}]),a}();b["default"]=j,a.exports=b["default"]},"./src/drawer.js":function(a,b,c){"use strict";function d(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return d=function(){return a},a}function e(a){if(a&&a.__esModule)return a;if(null===a||"object"!==f(a)&&"function"!=typeof a)return{"default":a};var b=d();if(b&&b.has(a))return b.get(a);var c={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if(Object.prototype.hasOwnProperty.call(a,g)){var h=e?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(c,g,h):c[g]=a[g]}return c["default"]=a,b&&b.set(a,c),c}function f(a){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function i(a,b,c){return b&&h(a.prototype,b),c&&h(a,c),a}function j(a,b){return!b||"object"!==f(b)&&"function"!=typeof b?k(a):b}function k(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function l(a){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function m(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&n(a,b)}function n(a,b){return(n=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var o=e(c("./src/util/index.js")),p=function(a){function b(a,c){var d;return g(this,b),d=j(this,l(b).call(this)),d.container=a,d.params=c,d.width=0,d.height=c.height*d.params.pixelRatio,d.lastPos=0,d.wrapper=null,d}return m(b,a),i(b,[{key:"style",value:function(a,b){return o.style(a,b)}},{key:"createWrapper",value:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(a,b){!b&&a.preventDefault();var c,d=a.targetTouches?a.targetTouches[0].clientX:a.clientX,e=this.wrapper.getBoundingClientRect(),f=this.width,g=this.getWidth();return!this.params.fillParent&&f<g?(c=(this.params.rtl?e.right-d:d-e.left)*(this.params.pixelRatio/f)||0,c>1&&(c=1)):c=((this.params.rtl?e.right-d:d-e.left)+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,c}},{key:"setupWrapperEvents",value:function(){var a=this;this.wrapper.addEventListener("click",function(b){var c=a.wrapper.offsetHeight-a.wrapper.clientHeight;if(0!==c){var d=a.wrapper.getBoundingClientRect();if(b.clientY>=d.bottom-c)return}a.params.interact&&a.fireEvent("click",b,a.handleEvent(b))}),this.wrapper.addEventListener("dblclick",function(b){a.params.interact&&a.fireEvent("dblclick",b,a.handleEvent(b))}),this.wrapper.addEventListener("scroll",function(b){return a.fireEvent("scroll",b)})}},{key:"drawPeaks",value:function(a,b,c,d){this.setWidth(b)||this.clearWave(),this.params.barWidth?this.drawBars(a,0,c,d):this.drawWave(a,0,c,d)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(a){var b=this.wrapper.scrollWidth*a;this.recenterOnPosition(b,!0)}},{key:"recenterOnPosition",value:function(a,b){var c=this.wrapper.scrollLeft,d=~~(this.wrapper.clientWidth/2),e=this.wrapper.scrollWidth-this.wrapper.clientWidth,f=a-d,g=f-c;if(0!=e){if(!b&&-d<=g&&g<d){var h=this.params.autoCenterRate;h/=d,h*=e,g=Math.max(-h,Math.min(h,g)),f=c+g}f=Math.max(0,Math.min(e,f)),f!=c&&(this.wrapper.scrollLeft=f)}}},{key:"getScrollX",value:function(){var a=0;if(this.wrapper){var b=this.params.pixelRatio;if(a=Math.round(this.wrapper.scrollLeft*b),this.params.scrollParent){var c=~~(this.wrapper.scrollWidth*b-this.getWidth());a=Math.min(c,Math.max(0,a))}}return a}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(a){return this.width!=a&&(this.width=a,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"setHeight",value:function(a){return a!=this.height&&(this.height=a,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(a){var b=1/this.params.pixelRatio,c=Math.round(a*this.width)*b;if(c<this.lastPos||c-this.lastPos>=b){if(this.lastPos=c,this.params.scrollParent&&this.params.autoCenter){var d=~~(this.wrapper.scrollWidth*a);this.recenterOnPosition(d,this.params.autoCenterImmediately)}this.updateProgress(c)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container&&this.container.removeChild(this.wrapper),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(a,b,c,d){}},{key:"drawWave",value:function(a,b,c,d){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(a){}}]),b}(o.Observer);b["default"]=p,a.exports=b["default"]},"./src/drawer.multicanvas.js":function(a,b,c){"use strict";function d(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return d=function(){return a},a}function e(a){if(a&&a.__esModule)return a;if(null===a||"object"!==g(a)&&"function"!=typeof a)return{"default":a};var b=d();if(b&&b.has(a))return b.get(a);var c={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)){var h=e?Object.getOwnPropertyDescriptor(a,f):null;h&&(h.get||h.set)?Object.defineProperty(c,f,h):c[f]=a[f]}return c["default"]=a,b&&b.set(a,c),c}function f(a){return a&&a.__esModule?a:{"default":a}}function g(a){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function j(a,b,c){return b&&i(a.prototype,b),c&&i(a,c),a}function k(a,b){return!b||"object"!==g(b)&&"function"!=typeof b?l(a):b}function l(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(a){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function n(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&o(a,b)}function o(a,b){return(o=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var p=f(c("./src/drawer.js")),q=e(c("./src/util/index.js")),r=f(c("./src/drawer.canvasentry.js")),s=function(a){function b(a,c){var d;return h(this,b),d=k(this,m(b).call(this,a,c)),d.maxCanvasWidth=c.maxCanvasWidth,d.maxCanvasElementWidth=Math.round(c.maxCanvasWidth/c.pixelRatio),d.hasProgressCanvas=c.waveColor!=c.progressColor,d.halfPixel=.5/c.pixelRatio,d.canvases=[],d.progressWave=null,d.EntryClass=r["default"],d.canvasContextAttributes=c.drawingContextAttributes,d.overlap=2*Math.ceil(c.pixelRatio/2),d.barRadius=c.barRadius||0,d}return n(b,a),j(b,[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"})),this.addCanvas(),this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){for(var a=this,b=Math.round(this.width/this.params.pixelRatio),c=Math.ceil(b/(this.maxCanvasElementWidth+this.overlap));this.canvases.length<c;)this.addCanvas();for(;this.canvases.length>c;)this.removeCanvas();var d=this.maxCanvasWidth+this.overlap,e=this.canvases.length-1;this.canvases.forEach(function(b,c){c==e&&(d=a.width-a.maxCanvasWidth*e),a.updateDimensions(b,d,a.height),b.clearWave()})}},{key:"addCanvas",value:function(){var a=new this.EntryClass;a.canvasContextAttributes=this.canvasContextAttributes,a.hasProgressCanvas=this.hasProgressCanvas,a.halfPixel=this.halfPixel;var b=this.maxCanvasElementWidth*this.canvases.length;a.initWave(this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:2,left:b+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}))),this.hasProgressCanvas&&a.initProgress(this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:b+"px",top:0,bottom:0,height:"100%"}))),this.canvases.push(a)}},{key:"removeCanvas",value:function(){var a=this.canvases[this.canvases.length-1];a.wave.parentElement.removeChild(a.wave),this.hasProgressCanvas&&a.progress.parentElement.removeChild(a.progress),a&&(a.destroy(),a=null),this.canvases.pop()}},{key:"updateDimensions",value:function(a,b,c){var d=Math.round(b/this.params.pixelRatio),e=Math.round(this.width/this.params.pixelRatio);a.updateDimensions(d,e,b,c),this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){var a=this;q.frame(function(){a.canvases.forEach(function(a){return a.clearWave()})})()}},{key:"drawBars",value:function(a,b,c,d){var e=this;return this.prepareDraw(a,b,c,d,function(a){var b=a.absmax,f=a.hasMinVals,g=(a.height,a.offsetY),h=a.halfH,i=a.peaks;if(void 0!==c){var j=f?2:1,k=i.length/j,l=e.params.barWidth*e.params.pixelRatio,m=null===e.params.barGap?Math.max(e.params.pixelRatio,~~(l/2)):Math.max(e.params.pixelRatio,e.params.barGap*e.params.pixelRatio),n=l+m,o=k/e.width,p=c,q=d,r=p;for(r;r<q;r+=n){var s=i[Math.floor(r*o*j)]||0,t=Math.round(s/b*h);0==t&&e.params.barMinHeight&&(t=e.params.barMinHeight),e.fillRect(r+e.halfPixel,h-t+g,l+e.halfPixel,2*t,e.barRadius)}}})}},{key:"drawWave",value:function(a,b,c,d){var e=this;return this.prepareDraw(a,b,c,d,function(a){var b=a.absmax,f=a.hasMinVals,g=(a.height,a.offsetY),h=a.halfH,i=a.peaks;if(!f){var j=[],k=i.length,l=0;for(l;l<k;l++)j[2*l]=i[l],j[2*l+1]=-i[l];i=j}void 0!==c&&e.drawLine(i,b,h,g,c,d),e.fillRect(0,h+g-e.halfPixel,e.width,e.halfPixel,e.barRadius)})}},{key:"drawLine",value:function(a,b,c,d,e,f){var g=this;this.canvases.forEach(function(h){g.setFillStyles(h),h.drawLines(a,b,c,d,e,f)})}},{key:"fillRect",value:function(a,b,c,d,e){var f=Math.floor(a/this.maxCanvasWidth),g=Math.min(Math.ceil((a+c)/this.maxCanvasWidth)+1,this.canvases.length),h=f;for(h;h<g;h++){var i=this.canvases[h],j=h*this.maxCanvasWidth,k={x1:Math.max(a,h*this.maxCanvasWidth),y1:b,x2:Math.min(a+c,h*this.maxCanvasWidth+i.wave.width),y2:b+d};k.x1<k.x2&&(this.setFillStyles(i),i.fillRects(k.x1-j,k.y1,k.x2-k.x1,k.y2-k.y1,e))}}},{key:"prepareDraw",value:function(a,b,c,d,e){var f=this;return q.frame(function(){if(a[0]instanceof Array){var g=a;if(f.params.splitChannels)return f.setHeight(g.length*f.params.height*f.params.pixelRatio),g.forEach(function(a,b){return f.prepareDraw(a,b,c,d,e)});a=g[0]}var h=1/f.params.barHeight;if(f.params.normalize){var i=q.max(a),j=q.min(a);h=-j>i?-j:i}var k=[].some.call(a,function(a){return a<0}),l=f.params.height*f.params.pixelRatio,m=l*b||0,n=l/2;return e({absmax:h,hasMinVals:k,height:l,offsetY:m,halfH:n,peaks:a})})()}},{key:"setFillStyles",value:function(a){a.setFillStyles(this.params.waveColor,this.params.progressColor)}},{key:"getImage",value:function(a,b,c){if("blob"===c)return Promise.all(this.canvases.map(function(d){return d.getImage(a,b,c)}));if("dataURL"===c){var d=this.canvases.map(function(d){return d.getImage(a,b,c)});return d.length>1?d:d[0]}}},{key:"updateProgress",value:function(a){this.style(this.progressWave,{width:a+"px"})}}]),b}(p["default"]);b["default"]=s,a.exports=b["default"]},"./src/mediaelement-webaudio.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function h(a,b,c){return b&&g(a.prototype,b),c&&g(a,c),a}function i(a,b){return!b||"object"!==e(b)&&"function"!=typeof b?j(a):b}function j(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function k(a,b,c){return(k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=l(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}})(a,b,c||a)}function l(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=m(a),null!==a););return a}function m(a){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function n(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&o(a,b)}function o(a,b){return(o=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var p=d(c("./src/mediaelement.js")),q=function(a){function b(a){var c;return f(this,b),c=i(this,m(b).call(this,a)),c.params=a,c.sourceMediaElement=null,c}return n(b,a),h(b,[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer(),this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode()}},{key:"_load",value:function(a,c){k(m(b.prototype),"_load",this).call(this,a,c),this.createMediaElementSource(a)}},{key:"createMediaElementSource",value:function(a){this.sourceMediaElement=this.ac.createMediaElementSource(a),this.sourceMediaElement.connect(this.analyser)}}]),b}(p["default"]);b["default"]=q,a.exports=b["default"]},"./src/mediaelement.js":function(a,b,c){"use strict";function d(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return d=function(){return a},a}function e(a){if(a&&a.__esModule)return a;if(null===a||"object"!==g(a)&&"function"!=typeof a)return{"default":a};var b=d();if(b&&b.has(a))return b.get(a);var c={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)){var h=e?Object.getOwnPropertyDescriptor(a,f):null;h&&(h.get||h.set)?Object.defineProperty(c,f,h):c[f]=a[f]}return c["default"]=a,b&&b.set(a,c),c}function f(a){return a&&a.__esModule?a:{"default":a}}function g(a){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function j(a,b,c){return b&&i(a.prototype,b),c&&i(a,c),a}function k(a,b){return!b||"object"!==g(b)&&"function"!=typeof b?l(a):b}function l(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(a,b,c){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=n(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}})(a,b,c||a)}function n(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=o(a),null!==a););return a}function o(a){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function p(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&q(a,b)}function q(a,b){return(q=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var r=f(c("./src/webaudio.js")),s=e(c("./src/util/index.js")),t=function(a){function b(a){var c;return h(this,b),c=k(this,o(b).call(this,a)),c.params=a,c.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0},c.mediaType=a.mediaType.toLowerCase(),c.elementPosition=a.elementPosition,c.peaks=null,c.playbackRate=1,c.volume=1,c.isMuted=!1,c.buffer=null,c.onPlayEnd=null,c.mediaListeners={},c}return p(b,a),j(b,[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:"_setupMediaListeners",value:function(){var a=this;this.mediaListeners.error=function(){a.fireEvent("error","Error loading media element")},this.mediaListeners.canplay=function(){a.fireEvent("canplay")},this.mediaListeners.ended=function(){a.fireEvent("finish")},this.mediaListeners.play=function(){a.fireEvent("play")},this.mediaListeners.pause=function(){a.fireEvent("pause")},this.mediaListeners.seeked=function(b){a.fireEvent("seek")},this.mediaListeners.volumechange=function(b){a.isMuted=a.media.muted,a.isMuted?a.volume=0:a.volume=a.media.volume,a.fireEvent("volume")},Object.keys(this.mediaListeners).forEach(function(b){a.media.removeEventListener(b,a.mediaListeners[b]),a.media.addEventListener(b,a.mediaListeners[b])})}},{key:"createTimer",value:function(){var a=this,b=function c(){a.isPaused()||(a.fireEvent("audioprocess",a.getCurrentTime()),s.frame(c)())};this.on("play",b),this.on("pause",function(){a.fireEvent("audioprocess",a.getCurrentTime())})}},{key:"load",value:function(a,b,c,d){var e=document.createElement(this.mediaType);e.controls=this.params.mediaControls,e.autoplay=this.params.autoplay||!1,e.preload=null==d?"auto":d,e.src=a,e.style.width="100%";var f=b.querySelector(this.mediaType);f&&b.removeChild(f),b.appendChild(e),this._load(e,c)}},{key:"loadElt",value:function(a,b){a.controls=this.params.mediaControls,a.autoplay=this.params.autoplay||!1,this._load(a,b)}},{key:"_load",value:function(a,b){if(!(a instanceof HTMLMediaElement)||"undefined"==typeof a.addEventListener)throw new Error("media parameter is not a valid media element");"function"==typeof a.load&&a.load(),this.media=a,this._setupMediaListeners(),this.peaks=b,this.onPlayEnd=null,this.buffer=null,this.isMuted=a.muted,this.setPlaybackRate(this.playbackRate),this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var a=(this.buffer||this.media).duration;return a>=1/0&&(a=this.media.seekable.end(0)),a}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(a){this.playbackRate=a||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(a){null!=a&&(this.media.currentTime=a),this.clearPlayEnd()}},{key:"play",value:function(a,b){this.seekTo(a);var c=this.media.play();return b&&this.setPlayEnd(b),c}},{key:"pause",value:function(){var a;return this.media&&(a=this.media.pause()),this.clearPlayEnd(),a}},{key:"setPlayEnd",value:function(a){var b=this;this.clearPlayEnd(),this._onPlayEnd=function(c){c>=a&&(b.pause(),b.seekTo(a))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(a,c,d){return this.buffer?m(o(b.prototype),"getPeaks",this).call(this,a,c,d):this.peaks||[]}},{key:"setSinkId",value:function(a){return a?this.media.setSinkId?this.media.setSinkId(a):Promise.reject(new Error("setSinkId is not supported in your browser")):Promise.reject(new Error("Invalid deviceId: "+a))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(a){this.volume=a,this.media.volume!==this.volume&&(this.media.volume=this.volume)}},{key:"destroy",value:function(){var a=this;this.pause(),this.unAll(),this.destroyed=!0,Object.keys(this.mediaListeners).forEach(function(b){a.media&&a.media.removeEventListener(b,a.mediaListeners[b])}),this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}]),b}(r["default"]);b["default"]=t,a.exports=b["default"]},"./src/peakcache.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var g=function(){function a(){d(this,a),this.clearPeakCache()}return f(a,[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(a,b,c){a!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=a);for(var d=[],e=0;e<this.peakCacheRanges.length&&this.peakCacheRanges[e]<b;)e++;for(e%2==0&&d.push(b);e<this.peakCacheRanges.length&&this.peakCacheRanges[e]<=c;)d.push(this.peakCacheRanges[e]),e++;e%2==0&&d.push(c),d=d.filter(function(a,b,c){return 0==b?a!=c[b+1]:b==c.length-1?a!=c[b-1]:a!=c[b-1]&&a!=c[b+1]}),this.peakCacheRanges=this.peakCacheRanges.concat(d),this.peakCacheRanges=this.peakCacheRanges.sort(function(a,b){return a-b}).filter(function(a,b,c){return 0==b?a!=c[b+1]:b==c.length-1?a!=c[b-1]:a!=c[b-1]&&a!=c[b+1]});var f=[];for(e=0;e<d.length;e+=2)f.push([d[e],d[e+1]]);return f}},{key:"getCacheRanges",value:function(){var a,b=[];for(a=0;a<this.peakCacheRanges.length;a+=2)b.push([this.peakCacheRanges[a],this.peakCacheRanges[a+1]]);return b}}]),a}();b["default"]=g,a.exports=b["default"]},"./src/util/ajax.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=new f["default"],c=new XMLHttpRequest,d=!1;return c.open(a.method||"GET",a.url,!0),c.responseType=a.responseType||"json",a.xhr&&(a.xhr.requestHeaders&&a.xhr.requestHeaders.forEach(function(a){c.setRequestHeader(a.key,a.value)}),a.xhr.withCredentials&&(c.withCredentials=!0)),c.addEventListener("progress",function(a){b.fireEvent("progress",a),a.lengthComputable&&a.loaded==a.total&&(d=!0)}),c.addEventListener("load",function(a){d||b.fireEvent("progress",a),b.fireEvent("load",a),200==c.status||206==c.status?b.fireEvent("success",c.response,a):b.fireEvent("error",a)}),c.addEventListener("error",function(a){return b.fireEvent("error",a)}),c.send(),b.xhr=c,b}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=d(c("./src/util/observer.js"));a.exports=b["default"]},"./src/util/extend.js":function(a,b,c){"use strict";function d(a){console.warn("util.extend is deprecated; use Object.assign instead");for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return c.forEach(function(b){Object.keys(b).forEach(function(c){a[c]=b[c]})}),a}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d,a.exports=b["default"]},"./src/util/fetch.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),a}function h(a){if(!a)throw new Error("fetch options missing");if(!a.url)throw new Error("fetch url missing");var b=new i["default"],c=new Headers,d=new Request(a.url);b.controller=new AbortController,a&&a.requestHeaders&&a.requestHeaders.forEach(function(a){c.append(a.key,a.value)});var e=a.responseType||"json",f={method:a.method||"GET",headers:c,mode:a.mode||"cors",credentials:a.credentials||"same-origin",cache:a.cache||"default",redirect:a.redirect||"follow",referrer:a.referrer||"client",signal:b.controller.signal};return fetch(d,f).then(function(a){b.response=a;var c=!0;a.body||(c=!1);var d=a.headers.get("content-length");return null===d&&(c=!1),c?(b.onProgress=function(a){b.fireEvent("progress",a)},new Response(new ReadableStream(new j(b,d,a)),f)):a}).then(function(a){var b;if(a.ok)switch(e){case"arraybuffer":return a.arrayBuffer();case"json":return a.json();case"blob":return a.blob();case"text":return a.text();default:b="Unknown responseType: "+e}throw b||(b="HTTP error status: "+a.status),new Error(b)}).then(function(a){b.fireEvent("success",a)})["catch"](function(a){b.fireEvent("error",a)}),b.fetchRequest=d,b}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=h;var i=d(c("./src/util/observer.js")),j=function(){function a(b,c,d){e(this,a),this.instance=b,this.instance._reader=d.body.getReader(),this.total=parseInt(c,10),this.loaded=0}return g(a,[{key:"start",value:function(a){var b=this,c=function d(){b.instance._reader.read().then(function(c){var e=c.done,f=c.value;return e?(0===b.total&&b.instance.onProgress.call(b.instance,{loaded:b.loaded,total:b.total,lengthComputable:!1}),void a.close()):(b.loaded+=f.byteLength,b.instance.onProgress.call(b.instance,{loaded:b.loaded,total:b.total,lengthComputable:!(0===b.total)}),a.enqueue(f),void d())})["catch"](function(b){a.error(b)})};c();
}}]),a}();a.exports=b["default"]},"./src/util/frame.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return(0,f["default"])(function(){return a.apply(void 0,c)})}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=d(c("./src/util/request-animation-frame.js"));a.exports=b["default"]},"./src/util/get-id.js":function(a,b,c){"use strict";function d(a){return void 0===a&&(a="wavesurfer_"),a+Math.random().toString(32).substring(2)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d,a.exports=b["default"]},"./src/util/index.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"ajax",{enumerable:!0,get:function(){return e["default"]}}),Object.defineProperty(b,"getId",{enumerable:!0,get:function(){return f["default"]}}),Object.defineProperty(b,"max",{enumerable:!0,get:function(){return g["default"]}}),Object.defineProperty(b,"min",{enumerable:!0,get:function(){return h["default"]}}),Object.defineProperty(b,"Observer",{enumerable:!0,get:function(){return i["default"]}}),Object.defineProperty(b,"extend",{enumerable:!0,get:function(){return j["default"]}}),Object.defineProperty(b,"style",{enumerable:!0,get:function(){return k["default"]}}),Object.defineProperty(b,"requestAnimationFrame",{enumerable:!0,get:function(){return l["default"]}}),Object.defineProperty(b,"frame",{enumerable:!0,get:function(){return m["default"]}}),Object.defineProperty(b,"debounce",{enumerable:!0,get:function(){return n["default"]}}),Object.defineProperty(b,"preventClick",{enumerable:!0,get:function(){return o["default"]}}),Object.defineProperty(b,"fetchFile",{enumerable:!0,get:function(){return p["default"]}});var e=d(c("./src/util/ajax.js")),f=d(c("./src/util/get-id.js")),g=d(c("./src/util/max.js")),h=d(c("./src/util/min.js")),i=d(c("./src/util/observer.js")),j=d(c("./src/util/extend.js")),k=d(c("./src/util/style.js")),l=d(c("./src/util/request-animation-frame.js")),m=d(c("./src/util/frame.js")),n=d(c("./node_modules/debounce/index.js")),o=d(c("./src/util/prevent-click.js")),p=d(c("./src/util/fetch.js"))},"./src/util/max.js":function(a,b,c){"use strict";function d(a){var b=-(1/0);return Object.keys(a).forEach(function(c){a[c]>b&&(b=a[c])}),b}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d,a.exports=b["default"]},"./src/util/min.js":function(a,b,c){"use strict";function d(a){var b=Number(1/0);return Object.keys(a).forEach(function(c){a[c]<b&&(b=a[c])}),b}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d,a.exports=b["default"]},"./src/util/observer.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var g=function(){function a(){d(this,a),this.handlers=null}return f(a,[{key:"on",value:function(a,b){var c=this;this.handlers||(this.handlers={});var d=this.handlers[a];return d||(d=this.handlers[a]=[]),d.push(b),{name:a,callback:b,un:function(a,b){return c.un(a,b)}}}},{key:"un",value:function(a,b){if(this.handlers){var c,d=this.handlers[a];if(d)if(b)for(c=d.length-1;c>=0;c--)d[c]==b&&d.splice(c,1);else d.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(a,b){var c=this,d=function e(){for(var d=arguments.length,f=new Array(d),g=0;g<d;g++)f[g]=arguments[g];b.apply(c,f),setTimeout(function(){c.un(a,e)},0)};return this.on(a,d)}},{key:"fireEvent",value:function(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(this.handlers){var e=this.handlers[a];e&&e.forEach(function(a){a.apply(void 0,c)})}}}]),a}();b["default"]=g,a.exports=b["default"]},"./src/util/prevent-click.js":function(a,b,c){"use strict";function d(a){a.stopPropagation(),document.body.removeEventListener("click",d,!0)}function e(a){document.body.addEventListener("click",d,!0)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e,a.exports=b["default"]},"./src/util/request-animation-frame.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var d=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){return setTimeout(a,1e3/60)}).bind(window);b["default"]=d,a.exports=b["default"]},"./src/util/style.js":function(a,b,c){"use strict";function d(a,b){return Object.keys(b).forEach(function(c){a.style[c]!==b[c]&&(a.style[c]=b[c])}),a}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d,a.exports=b["default"]},"./src/wavesurfer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return e=function(){return a},a}function f(a){if(a&&a.__esModule)return a;if(null===a||"object"!==g(a)&&"function"!=typeof a)return{"default":a};var b=e();if(b&&b.has(a))return b.get(a);var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)){var h=d?Object.getOwnPropertyDescriptor(a,f):null;h&&(h.get||h.set)?Object.defineProperty(c,f,h):c[f]=a[f]}return c["default"]=a,b&&b.set(a,c),c}function g(a){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function h(a,b){return!b||"object"!==g(b)&&"function"!=typeof b?j(a):b}function i(a){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function j(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function k(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&l(a,b)}function l(a,b){return(l=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function n(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function o(a,b,c){return b&&n(a.prototype,b),c&&n(a,c),a}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var p=f(c("./src/util/index.js")),q=d(c("./src/drawer.multicanvas.js")),r=d(c("./src/webaudio.js")),s=d(c("./src/mediaelement.js")),t=d(c("./src/peakcache.js")),u=d(c("./src/mediaelement-webaudio.js")),v=(function(){function a(b,c){m(this,a)}return o(a,[{key:"create",value:function(a){}}]),o(a,[{key:"init",value:function(){}},{key:"destroy",value:function(){}}]),a}(),function(a){function b(a){var c;if(m(this,b),c=h(this,i(b).call(this)),c.defaultParams={audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,barMinHeight:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,drawingContextAttributes:{desynchronized:!1},duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:q["default"],responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,waveColor:"#999",xhr:{}},c.backends={MediaElement:s["default"],WebAudio:r["default"],MediaElementWebAudio:u["default"]},c.util=p,c.params=Object.assign({},c.defaultParams,a),c.container="string"==typeof a.container?document.querySelector(c.params.container):c.params.container,!c.container)throw new Error("Container element not found");if(null==c.params.mediaContainer?c.mediaContainer=c.container:"string"==typeof c.params.mediaContainer?c.mediaContainer=document.querySelector(c.params.mediaContainer):c.mediaContainer=c.params.mediaContainer,!c.mediaContainer)throw new Error("Media Container element not found");if(c.params.maxCanvasWidth<=1)throw new Error("maxCanvasWidth must be greater than 1");if(c.params.maxCanvasWidth%2==1)throw new Error("maxCanvasWidth must be an even number");if(c.params.rtl===!0&&p.style(c.container,{transform:"rotateY(180deg)"}),c.params.backgroundColor&&c.setBackgroundColor(c.params.backgroundColor),c.savedVolume=0,c.isMuted=!1,c.tmpEvents=[],c.currentRequest=null,c.arraybuffer=null,c.drawer=null,c.backend=null,c.peakCache=null,"function"!=typeof c.params.renderer)throw new Error("Renderer parameter is invalid");c.Drawer=c.params.renderer,"AudioElement"==c.params.backend&&(c.params.backend="MediaElement"),"WebAudio"!=c.params.backend&&"MediaElementWebAudio"!==c.params.backend||r["default"].prototype.supportsWebAudio.call(null)||(c.params.backend="MediaElement"),c.Backend=c.backends[c.params.backend],c.initialisedPluginList={},c.isDestroyed=!1,c.isReady=!1;var d=0;return c._onResize=p.debounce(function(){d==c.drawer.wrapper.clientWidth||c.params.scrollParent||(d=c.drawer.wrapper.clientWidth,c.drawer.fireEvent("redraw"))},"number"==typeof c.params.responsive?c.params.responsive:100),h(c,j(c))}return k(b,a),o(b,null,[{key:"create",value:function(a){var c=new b(a);return c.init()}}]),o(b,[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:"registerPlugins",value:function(a){var b=this;return a.forEach(function(a){return b.addPlugin(a)}),a.forEach(function(a){a.deferInit||b.initPlugin(a.name)}),this.fireEvent("plugins-registered",a),this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(a){var b=this;if(!a.name)throw new Error("Plugin does not have a name!");if(!a.instance)throw new Error("Plugin ".concat(a.name," does not have an instance property!"));a.staticProps&&Object.keys(a.staticProps).forEach(function(c){b[c]=a.staticProps[c]});var c=a.instance,d=Object.getOwnPropertyNames(p.Observer.prototype);return d.forEach(function(a){c.prototype[a]=p.Observer.prototype[a]}),this[a.name]=new c(a.params||{},this),this.fireEvent("plugin-added",a.name),this}},{key:"initPlugin",value:function(a){if(!this[a])throw new Error("Plugin ".concat(a," has not been added yet!"));return this.initialisedPluginList[a]&&this.destroyPlugin(a),this[a].init(),this.initialisedPluginList[a]=!0,this.fireEvent("plugin-initialised",a),this}},{key:"destroyPlugin",value:function(a){if(!this[a])throw new Error("Plugin ".concat(a," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[a])throw new Error("Plugin ".concat(a," is not active and cannot be destroyed!"));if("function"!=typeof this[a].destroy)throw new Error("Plugin ".concat(a," does not have a destroy function!"));return this[a].destroy(),delete this.initialisedPluginList[a],this.fireEvent("plugin-destroyed",a),this}},{key:"destroyAllPlugins",value:function(){var a=this;Object.keys(this.initialisedPluginList).forEach(function(b){return a.destroyPlugin(b)})}},{key:"createDrawer",value:function(){var a=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),this.params.responsive!==!1&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0)),this.drawer.on("redraw",function(){a.drawBuffer(),a.drawer.progress(a.backend.getPlayedPercents())}),this.drawer.on("click",function(b,c){setTimeout(function(){return a.seekTo(c)},0)}),this.drawer.on("scroll",function(b){a.params.partialRender&&a.drawBuffer(),a.fireEvent("scroll",b)})}},{key:"createBackend",value:function(){var a=this;this.backend&&this.backend.destroy(),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",function(){a.drawer.progress(a.backend.getPlayedPercents()),a.fireEvent("finish")}),this.backend.on("play",function(){return a.fireEvent("play")}),this.backend.on("pause",function(){return a.fireEvent("pause")}),this.backend.on("audioprocess",function(b){a.drawer.progress(a.backend.getPlayedPercents()),a.fireEvent("audioprocess",b)}),"MediaElement"!==this.params.backend&&"MediaElementWebAudio"!==this.params.backend||(this.backend.on("seek",function(){a.drawer.progress(a.backend.getPlayedPercents())}),this.backend.on("volume",function(){var b=a.getVolume();a.fireEvent("volume",b),a.backend.isMuted!==a.isMuted&&(a.isMuted=a.backend.isMuted,a.fireEvent("mute",a.isMuted))}))}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new t["default"])}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(a){a>=this.getDuration()?this.seekTo(1):this.seekTo(a/this.getDuration())}},{key:"play",value:function(a,b){var c=this;return this.fireEvent("interaction",function(){return c.play(a,b)}),this.backend.play(a,b)}},{key:"setPlayEnd",value:function(a){this.backend.setPlayEnd(a)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(a){this.skip(-a||-this.params.skipLength)}},{key:"skipForward",value:function(a){this.skip(a||this.params.skipLength)}},{key:"skip",value:function(a){var b=this.getDuration()||1,c=this.getCurrentTime()||0;c=Math.max(0,Math.min(b,c+(a||0))),this.seekAndCenter(c/b)}},{key:"seekAndCenter",value:function(a){this.seekTo(a),this.drawer.recenter(a)}},{key:"seekTo",value:function(a){var b=this;if("number"!=typeof a||!isFinite(a)||a<0||a>1)throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.fireEvent("interaction",function(){return b.seekTo(a)});var c=this.backend.isPaused();c||this.backend.pause();var d=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(a*this.getDuration()),this.drawer.progress(a),c||this.backend.play(),this.params.scrollParent=d,this.fireEvent("seek",a)}},{key:"stop",value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:"setSinkId",value:function(a){return this.backend.setSinkId(a)}},{key:"setVolume",value:function(a){this.backend.setVolume(a),this.fireEvent("volume",a)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(a){this.backend.setPlaybackRate(a)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(a){return a===this.isMuted?void this.fireEvent("mute",this.isMuted):(a?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)),void this.fireEvent("mute",this.isMuted))}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){return this.params.waveColor}},{key:"setWaveColor",value:function(a){this.params.waveColor=a,this.drawBuffer()}},{key:"getProgressColor",value:function(){return this.params.progressColor}},{key:"setProgressColor",value:function(a){this.params.progressColor=a,this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(a){this.params.backgroundColor=a,p.style(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(a){this.params.cursorColor=a,this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(a){this.params.height=a,this.drawer.setHeight(a*this.params.pixelRatio),this.drawBuffer()}},{key:"drawBuffer",value:function(){var a=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),b=this.drawer.getWidth(),c=a,d=0,e=Math.max(d+b,c);this.params.fillParent&&(!this.params.scrollParent||a<b)&&(c=b,d=0,e=c);var f;if(this.params.partialRender){var g,h=this.peakCache.addRangeToPeakCache(c,d,e);for(g=0;g<h.length;g++)f=this.backend.getPeaks(c,h[g][0],h[g][1]),this.drawer.drawPeaks(f,c,h[g][0],h[g][1])}else f=this.backend.getPeaks(c,d,e),this.drawer.drawPeaks(f,c,d,e);this.fireEvent("redraw",f,c)}},{key:"zoom",value:function(a){a?(this.params.minPxPerSec=a,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",a)}},{key:"loadArrayBuffer",value:function(a){var b=this;this.decodeArrayBuffer(a,function(a){b.isDestroyed||b.loadDecodedBuffer(a)})}},{key:"loadDecodedBuffer",value:function(a){this.backend.load(a),this.drawBuffer(),this.isReady=!0,this.fireEvent("ready")}},{key:"loadBlob",value:function(a){var b=this,c=new FileReader;c.addEventListener("progress",function(a){return b.onProgress(a)}),c.addEventListener("load",function(a){return b.loadArrayBuffer(a.target.result)}),c.addEventListener("error",function(){return b.fireEvent("error","Error reading file")}),c.readAsArrayBuffer(a),this.empty()}},{key:"load",value:function(a,b,c,d){if(!a)throw new Error("url parameter cannot be empty");if(this.empty(),c){var e={"Preload is not 'auto', 'none' or 'metadata'":["auto","metadata","none"].indexOf(c)===-1,"Peaks are not provided":!b,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend)===-1,"Url is not of type string":"string"!=typeof a},f=Object.keys(e).filter(function(a){return e[a]});f.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+f.join("\n\t- ")),c=null)}switch(this.params.backend){case"WebAudio":return this.loadBuffer(a,b,d);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(a,b,c,d)}}},{key:"loadBuffer",value:function(a,b,c){var d=this,e=function(b){return b&&d.tmpEvents.push(d.once("ready",b)),d.getArrayBuffer(a,function(a){return d.loadArrayBuffer(a)})};return b?(this.backend.setPeaks(b,c),this.drawBuffer(),this.tmpEvents.push(this.once("interaction",e)),void 0):e()}},{key:"loadMediaElement",value:function(a,b,c,d){var e=this,f=a;if("string"==typeof a)this.backend.load(f,this.mediaContainer,b,c);else{var g=a;this.backend.loadElt(g,b),f=g.src}this.tmpEvents.push(this.backend.once("canplay",function(){e.backend.destroyed||(e.drawBuffer(),e.isReady=!0,e.fireEvent("ready"))}),this.backend.once("error",function(a){return e.fireEvent("error",a)})),b&&this.backend.setPeaks(b,d),b&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(f,function(a){e.decodeArrayBuffer(a,function(a){e.backend.buffer=a,e.backend.setPeaks(null),e.drawBuffer(),e.fireEvent("waveform-ready")})})}},{key:"decodeArrayBuffer",value:function(a,b){var c=this;this.arraybuffer=a,this.backend.decodeArrayBuffer(a,function(d){c.isDestroyed||c.arraybuffer!=a||(b(d),c.arraybuffer=null)},function(){return c.fireEvent("error","Error decoding audiobuffer")})}},{key:"getArrayBuffer",value:function(a,b){var c=this,d=Object.assign({url:a,responseType:"arraybuffer"},this.params.xhr),e=p.fetchFile(d);return this.currentRequest=e,this.tmpEvents.push(e.on("progress",function(a){c.onProgress(a)}),e.on("success",function(a){b(a),c.currentRequest=null}),e.on("error",function(a){c.fireEvent("error",a),c.currentRequest=null})),e}},{key:"onProgress",value:function(a){var b;b=a.lengthComputable?a.loaded/a.total:a.loaded/(a.loaded+1e6),this.fireEvent("loading",Math.round(100*b),a.target)}},{key:"exportPCM",value:function(a,b,c,d,e){a=a||1024,d=d||0,b=b||1e4,c=c||!1;var f=this.backend.getPeaks(a,d,e),g=[].map.call(f,function(a){return Math.round(a*b)/b});return new Promise(function(a,b){var d=JSON.stringify(g);c||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(d)),a(d)})}},{key:"exportImage",value:function(a,b,c){return a||(a="image/png"),b||(b=1),c||(c="dataURL"),this.drawer.getImage(a,b,c)}},{key:"cancelAjax",value:function(){this.currentRequest&&this.currentRequest.controller&&(this.currentRequest.controller.abort(),this.currentRequest=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach(function(a){return a.un()})}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.isReady=!1,this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),this.params.responsive!==!1&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0)),this.backend&&this.backend.destroy(),this.drawer&&this.drawer.destroy(),this.isDestroyed=!0,this.isReady=!1,this.arraybuffer=null}}]),b}(p.Observer));b["default"]=v,v.VERSION="3.3.3",v.util=p,a.exports=b["default"]},"./src/webaudio.js":function(a,b,c){"use strict";function d(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;return d=function(){return a},a}function e(a){if(a&&a.__esModule)return a;if(null===a||"object"!==f(a)&&"function"!=typeof a)return{"default":a};var b=d();if(b&&b.has(a))return b.get(a);var c={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if(Object.prototype.hasOwnProperty.call(a,g)){var h=e?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(c,g,h):c[g]=a[g]}return c["default"]=a,b&&b.set(a,c),c}function f(a){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function g(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){return!b||"object"!==f(b)&&"function"!=typeof b?j(a):b}function j(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function k(a){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function l(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function m(a,b,c){return b&&l(a.prototype,b),c&&l(a,c),a}function n(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&o(a,b)}function o(a,b){return(o=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;var p=e(c("./src/util/index.js")),q="playing",r="paused",s="finished",t=function(a){function b(a){var c,d,e;return h(this,b),e=i(this,k(b).call(this)),e.audioContext=null,e.offlineAudioContext=null,e.stateBehaviors=(c={},g(c,q,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var a=this.getDuration();return this.getCurrentTime()/a||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),g(c,r,{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var a=this.getDuration();return this.getCurrentTime()/a||0},getCurrentTime:function(){return this.startPosition}}),g(c,s,{init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),c),e.params=a,e.ac=a.audioContext||(e.supportsWebAudio()?e.getAudioContext():{}),e.lastPlay=e.ac.currentTime,e.startPosition=0,e.scheduledPause=null,e.states=(d={},g(d,q,Object.create(e.stateBehaviors[q])),g(d,r,Object.create(e.stateBehaviors[r])),g(d,s,Object.create(e.stateBehaviors[s])),d),e.buffer=null,e.filters=[],e.gainNode=null,e.mergedPeaks=null,e.offlineAc=null,e.peaks=null,e.playbackRate=1,e.analyser=null,e.scriptNode=null,e.source=null,e.splitPeaks=[],e.state=null,e.explicitDuration=a.duration,e.destroyed=!1,e}return n(b,a),m(b,[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(a){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,a)),window.WaveSurferOfflineAudioContext}}]),m(b,[{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(r),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach(function(a){a&&a.disconnect()}),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(a){this.state!==this.states[a]&&(this.state=this.states[a],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];this.setFilters(b)}},{key:"setFilters",value:function(a){this.disconnectFilters(),a&&a.length&&(this.filters=a,this.analyser.disconnect(),a.reduce(function(a,b){return a.connect(b),b},this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.params.audioScriptProcessor?this.scriptNode=this.params.audioScriptProcessor:this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(b.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(b.scriptBufferSize),this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var a=this;this.scriptNode.onaudioprocess=function(){var b=a.getCurrentTime();b>=a.getDuration()?(a.setState(s),a.fireEvent("pause")):b>=a.scheduledPause?a.pause():a.state===a.states[q]&&a.fireEvent("audioprocess",b)}}},{key:"removeOnAudioProcess",value:function(){this.scriptNode.onaudioprocess=function(){}}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(a){if(a){var b=new window.Audio;if(!b.setSinkId)return Promise.reject(new Error("setSinkId is not supported in your browser"));b.autoplay=!0;var c=this.ac.createMediaStreamDestination();return this.gainNode.disconnect(),this.gainNode.connect(c),b.srcObject=c.stream,b.setSinkId(a)}return Promise.reject(new Error("Invalid deviceId: "+a))}},{key:"setVolume",value:function(a){this.gainNode.gain.setValueAtTime(a,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(a,b,c){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(a,function(a){return b(a)},c)}},{key:"setPeaks",value:function(a,b){null!=b&&(this.explicitDuration=b),this.peaks=a}},{key:"setLength",value:function(a){if(!this.mergedPeaks||a!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];var b,c=this.buffer?this.buffer.numberOfChannels:1;for(b=0;b<c;b++)this.splitPeaks[b]=[],this.splitPeaks[b][2*(a-1)]=0,this.splitPeaks[b][2*(a-1)+1]=0;this.mergedPeaks[2*(a-1)]=0,this.mergedPeaks[2*(a-1)+1]=0}}},{key:"getPeaks",value:function(a,b,c){if(this.peaks)return this.peaks;if(!this.buffer)return[];if(b=b||0,c=c||a-1,this.setLength(a),!this.buffer)return this.params.splitChannels?this.splitPeaks:this.mergedPeaks;if(!this.buffer.length){var d=this.createBuffer(1,4096,this.sampleRate);this.buffer=d.buffer}var e,f=this.buffer.length/a,g=~~(f/10)||1,h=this.buffer.numberOfChannels;for(e=0;e<h;e++){var i=this.splitPeaks[e],j=this.buffer.getChannelData(e),k=void 0;for(k=b;k<=c;k++){var l=~~(k*f),m=~~(l+f),n=0,o=0,p=void 0;for(p=l;p<m;p+=g){var q=j[p];q>o&&(o=q),q<n&&(n=q)}i[2*k]=o,i[2*k+1]=n,(0==e||o>this.mergedPeaks[2*k])&&(this.mergedPeaks[2*k]=o),(0==e||n<this.mergedPeaks[2*k+1])&&(this.mergedPeaks[2*k+1]=n)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.destroyed=!0,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"==typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null)}},{key:"load",value:function(a){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=a,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime),this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"isPaused",value:function(){return this.state!==this.states[q]}},{key:"getDuration",value:function(){return this.explicitDuration?this.explicitDuration:this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(a,b){if(this.buffer)return this.scheduledPause=null,null==a&&(a=this.getCurrentTime(),a>=this.getDuration()&&(a=0)),null==b&&(b=this.getDuration()),this.startPosition=a,this.lastPlay=this.ac.currentTime,this.state===this.states[s]&&this.setState(r),{start:a,end:b}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(a,b){if(this.buffer){this.createSource();var c=this.seekTo(a,b);a=c.start,b=c.end,this.scheduledPause=b,this.source.start(0,a),"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume(),
this.setState(q),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState(r),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(a){a=a||1,this.isPaused()?this.playbackRate=a:(this.pause(),this.playbackRate=a,this.play())}},{key:"setPlayEnd",value:function(a){this.scheduledPause=a}}]),b}(p.Observer);b["default"]=t,t.scriptBufferSize=256,a.exports=b["default"]}})});