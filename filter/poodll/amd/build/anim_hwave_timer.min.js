define(["jquery","core/log"],function(a,b){"use strict";return b.debug("anim_horizontal_wave_ra: initialising"),{analyser:null,cvs:null,cvsctx:null,sounddetected:!1,displaytime:"00:00:00",drawparams:{wavColor:"#CCCCCC",textColor:"#000000",lineWidth:2,font:"30px Georgia",textAlign:"center"},clone:function(){return a.extend(!0,{},this)},init:function(a,b){this.cvs=b,this.cvsctx=b.getContext("2d"),this.cvsctx.textAlign=this.drawparams.textAlign,this.analyser=a},setDrawParam:function(a,b){this.drawparams[a]=b},clear:function(){this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height),this.cvsctx.lineWidth=2,this.cvsctx.strokeStyle=this.drawparams.textColor,this.cvsctx.beginPath(),this.drawTime(this.cvsctx,this.displaytime,this.cvs.width,this.cvs.height),this.cvsctx.stroke()},drawTime:function(a,b,c,d){a.fillStyle=this.drawparams.textColor,a.font=this.drawparams.font,a.fillText(b,c/2,d/4*3)},start:function(){this.analyser.core.fftSize=2048;var a=this.analyser.core.fftSize,b=new Uint8Array(a),c=this.cvs.width,d=this.cvs.height,e=this.cvsctx,f=this.analyser,g=this;this.clear();var h=function(){requestAnimationFrame(h);if(f.theinterval){f.core.getByteTimeDomainData(b),e.clearRect(0,0,c,d),e.lineWidth=g.drawparams.lineWidth,e.strokeStyle=g.drawparams.wavColor,e.beginPath();var i=d/4*3,j=2*c/a,k=0,l=0;if(a>0){var m=b[a-1];128!=m&&(g.sounddetected=!0)}for(var n=0;n<a;n++){var o=b[n]/128,p=o*i/2;0===n?e.moveTo(k,p):e.lineTo(k,p),l=p,k+=j}e.lineTo(c,i/2),g.drawTime(e,g.displaytime,c,d),e.stroke()}};h()}}});