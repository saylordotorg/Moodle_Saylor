define(["jquery","core/log"],(function($,log){return log.debug("anim_horizontal_wave_ra: initialising"),{analyser:null,cvs:null,cvsctx:null,sounddetected:!1,displaytime:"00:00:00",drawparams:{wavColor:"#CCCCCC",textColor:"#000000",lineWidth:2,font:"30px Georgia",textAlign:"center"},clone:function(){return $.extend(!0,{},this)},init:function(analyser,cvs){this.cvs=cvs,this.cvsctx=cvs.getContext("2d"),this.cvsctx.textAlign=this.drawparams.textAlign,this.analyser=analyser},setDrawParam:function(paramkey,paramvalue){this.drawparams[paramkey]=paramvalue},clear:function(){this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height),this.cvsctx.lineWidth=2,this.cvsctx.strokeStyle=this.drawparams.textColor,this.cvsctx.beginPath(),this.drawTime(this.cvsctx,this.displaytime,this.cvs.width,this.cvs.height),this.cvsctx.stroke()},drawTime:function(ctx,displaytime,cwidth,cheight){ctx.fillStyle=this.drawparams.textColor,ctx.font=this.drawparams.font,ctx.fillText(displaytime,cwidth/2,cheight/4*3)},start:function(){this.analyser.core.fftSize=2048;var bufferLength=this.analyser.core.fftSize,dataArray=new Uint8Array(bufferLength),cwidth=this.cvs.width,cheight=this.cvs.height,canvasCtx=this.cvsctx,analyser=this.analyser,that=this;this.clear();!function draw(){requestAnimationFrame(draw);if(analyser.theinterval){analyser.core.getByteTimeDomainData(dataArray),canvasCtx.clearRect(0,0,cwidth,cheight),canvasCtx.lineWidth=that.drawparams.lineWidth,canvasCtx.strokeStyle=that.drawparams.wavColor,canvasCtx.beginPath();var lineheight=cheight/4*3,sliceWidth=2*cwidth/bufferLength,x=0;if(bufferLength>0)128!=dataArray[bufferLength-1]&&(that.sounddetected=!0);for(var i=0;i<bufferLength;i++){var y=dataArray[i]/128*lineheight/2;0===i?canvasCtx.moveTo(x,y):canvasCtx.lineTo(x,y),y,x+=sliceWidth}canvasCtx.lineTo(cwidth,lineheight/2),that.drawTime(canvasCtx,that.displaytime,cwidth,cheight),canvasCtx.stroke()}}()}}}));

//# sourceMappingURL=anim_hwave_timer.min.js.map