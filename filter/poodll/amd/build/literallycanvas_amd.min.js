define(["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/react_amd","filter_poodll/literallycanvas"],(function($,log,utils,uploader,React,LC){return log.debug("Filter PoodLL: literallycanvas.js initialising"),{instanceprops:[],loadliterallycanvas:function(opts){var theid="#amdopts_"+opts.recorderid,optscontrol=$(theid).get(0);optscontrol&&(opts=JSON.parse(optscontrol.value),this.config=opts,$(theid).remove());var element="#"+opts.recorderid+"_literally",lc_element=$(element)[0],zoomMax=4,zoomMin=.2;if(opts.whiteboardnozoom>0&&(zoomMax=1,zoomMin=1),opts.backgroundimage){var backimagebuffer=$("#"+opts.recorderid+"_separate-background-image")[0],backgroundimage=new Image;backgroundimage.src=backimagebuffer.src,backgroundimage.crossOrigin="Anonymous";var backgroundshape=LC.createShape("Image",{x:0,y:0,image:backgroundimage,scale:1}),lc=LC.init(lc_element,{imageURLPrefix:opts.imageurlprefix,backgroundColor:opts.backgroundcolor,backgroundShapes:[backgroundshape],recorderid:opts.recorderid,zoomMax:zoomMax,zoomMin:zoomMin})}else lc=LC.init(lc_element,{imageURLPrefix:opts.imageurlprefix,backgroundColor:opts.backgroundcolor,recorderid:opts.recorderid,zoomMax:zoomMax,zoomMin:zoomMin});opts.lc=lc;var vectordata=opts.vectordata;vectordata&&(0!=vectordata.indexOf('{"shapes"')&&0!=vectordata.indexOf('{"colors"')||lc.loadSnapshot(JSON.parse(vectordata))),opts.uploader=uploader.clone(),opts.uploader.init(element,opts),this.instanceprops[opts.recorderid]=opts,this.registerEvents(opts.recorderid)},registerEvents:function(recid){var opts=this.instanceprops[recid];opts.autosave?opts.lc.on("drawingChange",(function(){var m=$("#"+recid+"_messages")[0],savebutton=$("#"+recid+"_btn_upload_whiteboard")[0];if(m){savebutton&&(savebutton.disabled=!1),m.innerHTML="";var th=utils.timeouthandles[recid];th&&clearTimeout(th),utils.timeouthandles[recid]=setTimeout((function(){utils.WhiteboardUploadHandler(recid,opts.lc,opts,opts.uploader)}),opts.autosave)}})):opts.lc.on("drawingChange",(function(){var m=$("#"+recid+"_messages");m&&(m.innerHTML="File has not been saved.")}));var uploadbutton=$("#"+recid+"_btn_upload_whiteboard");uploadbutton&&(opts.autosave?uploadbutton.click((function(){utils.WhiteboardUploadHandler(recid,opts.lc,opts,opts.uploader)})):uploadbutton.click((function(){var cvs=utils.getCvs(recid,opts.lc,opts);utils.pokeVectorData(recid,opts.lc,opts),opts.uploader.uploadFile(cvs.toDataURL(),"image/png")})))}}}));

//# sourceMappingURL=literallycanvas_amd.min.js.map