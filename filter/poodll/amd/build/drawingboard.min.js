function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("filter_poodll/drawingboard",[],function(){var a={};a.Board=function(b,c){this.opts=$.extend({},a.Board.defaultOpts,c);this.ev=new a.Utils.MicroEvent;this.id=b;this.$el=$(document.getElementById(b));if(!this.$el.length)return!1;var d="<div class=\"drawing-board-canvas-wrapper\"></canvas><canvas class=\"drawing-board-canvas\"></canvas><div class=\"drawing-board-cursor drawing-board-utils-hidden\"></div></div>";if(-1<this.opts.controlsPosition.indexOf("bottom"))d+="<div class=\"drawing-board-controls\"></div>";else d="<div class=\"drawing-board-controls\"></div>"+d;this.$el.addClass("drawing-board").append(d);this.dom={$canvasWrapper:this.$el.find(".drawing-board-canvas-wrapper"),$canvas:this.$el.find(".drawing-board-canvas"),$cursor:this.$el.find(".drawing-board-cursor"),$controls:this.$el.find(".drawing-board-controls")};$.each(["left","right","center"],$.proxy(function(a,b){if(-1<this.opts.controlsPosition.indexOf(b)){this.dom.$controls.attr("data-align",b);return!1}},this));this.canvas=this.dom.$canvas.get(0);this.ctx=this.canvas&&this.canvas.getContext&&this.canvas.getContext("2d")?this.canvas.getContext("2d"):null;this.color=this.opts.color;if(!this.ctx){if(this.opts.errorMessage)this.$el.html(this.opts.errorMessage);return!1}this.storage=this._getStorage();this.initHistory();this.reset({webStorage:!1,history:!1,background:!1});this.initControls();this.resize();this.reset({webStorage:!1,history:!0,background:!0});this.restoreWebStorage();this.initDropEvents();this.initDrawEvents()};a.Board.defaultOpts={controls:["Color","DrawingMode","Size","Navigation"],controlsPosition:"top left",color:"#000000",size:1,background:"#fff",eraserColor:"background",webStorage:"session",droppable:!1,enlargeYourContainer:!1,errorMessage:"<p>It seems you use an obsolete browser. <a href=\"http://browsehappy.com/\" target=\"_blank\">Update it</a> to start drawing.</p>"};a.Board.prototype={reset:function reset(a){a=$.extend({color:this.opts.color,size:this.opts.size,webStorage:!0,history:!0,background:!1},a);this.setMode("pencil");if(a.background)this.resetBackground(this.opts.background,!1);if(a.color)this.setColor(a.color);if(a.size)this.ctx.lineWidth=a.size;this.ctx.lineCap="round";this.ctx.lineJoin="round";if(a.webStorage)this.saveWebStorage();if(a.history)this.saveHistory();this.blankCanvas=this.getImg();this.ev.trigger("board:reset",a)},resetBackground:function resetBackground(b,c){b=b||this.opts.background;c="undefined"!=typeof c?c:!0;var d=a.Utils.isColor(b),e=this.getMode();this.setMode("pencil");this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.width);if(d){this.ctx.fillStyle=b;this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}else if(b)this.setImg(b);this.setMode(e);if(c)this.saveHistory()},resize:function resize(){this.dom.$controls.toggleClass("drawing-board-controls-hidden",!this.controls||!this.controls.length);var b,c,d=[this.$el.width(),a.Utils.boxBorderWidth(this.$el),a.Utils.boxBorderWidth(this.dom.$canvasWrapper,!0,!0)],e=[this.$el.height(),a.Utils.boxBorderHeight(this.$el),this.dom.$controls.height(),a.Utils.boxBorderHeight(this.dom.$controls,!1,!0),a.Utils.boxBorderHeight(this.dom.$canvasWrapper,!0,!0)],f=this,g=function(a,b){b=b||1;for(var c=a[0],d=1;d<a.length;d++){c=c+a[d]*b}return c},h=function(a){return g(a,-1)};if(this.opts.enlargeYourContainer){b=this.$el.width();c=this.$el.height();this.$el.width(g(d));this.$el.height(g(e))}else{b=h(d);c=h(e)}this.dom.$canvasWrapper.css("width",b+"px");this.dom.$canvasWrapper.css("height",c+"px");this.dom.$canvas.css("width",b+"px");this.dom.$canvas.css("height",c+"px");this.canvas.width=b;this.canvas.height=c},initControls:function initControls(){this.controls=[];if(!this.opts.controls.length||!a.Control)return!1;for(var b=0,d;b<this.opts.controls.length;b++){d=null;if("string"==typeof this.opts.controls[b])d=new window.DrawingBoard.Control[this.opts.controls[b]](this);else if("object"==_typeof(this.opts.controls[b])){for(var e in this.opts.controls[b]){break}d=new window.DrawingBoard.Control[e](this,this.opts.controls[b][e])}if(d){this.addControl(d)}}},addControl:function addControl(b,c,d){if("string"!=typeof b&&("object"!==_typeof(b)||!b instanceof a.Control))return!1;var e="object"==_typeof(c)?c:{};d=d?1*d:"number"==typeof c?c:null;if("string"==typeof b)b=new window.DrawingBoard.Control[b](this,e);if(d)this.dom.$controls.children().eq(d).before(b.$el);else this.dom.$controls.append(b.$el);if(!this.controls)this.controls=[];this.controls.push(b);this.dom.$controls.removeClass("drawing-board-controls-hidden")},initHistory:function initHistory(){this.history={values:[],position:0}},saveHistory:function saveHistory(){while(30<this.history.values.length){this.history.values.shift();this.history.position--}if(0!==this.history.position&&this.history.position<this.history.values.length){this.history.values=this.history.values.slice(0,this.history.position);this.history.position++}else{this.history.position=this.history.values.length+1}this.history.values.push(this.getImg());this.ev.trigger("historyNavigation",this.history.position)},_goThroughHistory:function _goThroughHistory(a){if(a&&this.history.position==this.history.values.length||!a&&1==this.history.position)return;var b=a?this.history.position+1:this.history.position-1;if(this.history.values.length&&this.history.values[b-1]!==void 0){this.history.position=b;this.setImg(this.history.values[b-1])}this.ev.trigger("historyNavigation",b);this.saveWebStorage()},goBackInHistory:function goBackInHistory(){this._goThroughHistory(!1)},goForthInHistory:function goForthInHistory(){this._goThroughHistory(!0)},setImg:function setImg(a){var b=this.ctx,c=new Image,d=b.globalCompositeOperation;c.onload=function(){b.globalCompositeOperation="source-over";b.clearRect(0,0,b.canvas.width,b.canvas.width);b.drawImage(c,0,0);b.globalCompositeOperation=d};c.src=a},getImg:function getImg(){return this.canvas.toDataURL("image/png")},downloadImg:function downloadImg(){var a=this.getImg();a=a.replace("image/png","image/octet-stream");window.location.href=a},saveWebStorage:function saveWebStorage(){if(window[this.storage]){window[this.storage].setItem("drawing-board-"+this.id,this.getImg());this.ev.trigger("board:save"+this.storage.charAt(0).toUpperCase()+this.storage.slice(1),this.getImg())}},restoreWebStorage:function restoreWebStorage(){if(window[this.storage]&&null!==window[this.storage].getItem("drawing-board-"+this.id)){this.setImg(window[this.storage].getItem("drawing-board-"+this.id));this.ev.trigger("board:restore"+this.storage.charAt(0).toUpperCase()+this.storage.slice(1),window[this.storage].getItem("drawing-board-"+this.id))}},clearWebStorage:function clearWebStorage(){if(window[this.storage]&&null!==window[this.storage].getItem("drawing-board-"+this.id)){window[this.storage].removeItem("drawing-board-"+this.id);this.ev.trigger("board:clear"+this.storage.charAt(0).toUpperCase()+this.storage.slice(1))}},_getStorage:function _getStorage(){if(!this.opts.webStorage||!("session"===this.opts.webStorage||"local"===this.opts.webStorage))return!1;return this.opts.webStorage+"Storage"},initDropEvents:function initDropEvents(){if(!this.opts.droppable)return!1;this.dom.$canvas.on("dragover dragenter drop",function(a){a.stopPropagation();a.preventDefault()});this.dom.$canvas.on("drop",$.proxy(this._onCanvasDrop,this))},_onCanvasDrop:function _onCanvasDrop(a){a=a.originalEvent?a.originalEvent:a;var b=a.dataTransfer.files;if(!b||!b.length||-1==b[0].type.indexOf("image")||!window.FileReader)return!1;var c=new FileReader;c.readAsDataURL(b[0]);c.onload=$.proxy(function(a){this.setImg(a.target.result);this.ev.trigger("board:imageDropped",a.target.result);this.ev.trigger("board:userAction");this.saveHistory()},this)},setMode:function setMode(b,c){c=c||!1;b=b||"pencil";this.ev.unbind("board:startDrawing",$.proxy(this.fill,this));if("transparent"===this.opts.eraserColor)this.ctx.globalCompositeOperation="eraser"===b?"destination-out":"source-over";else{if("eraser"===b){if("background"===this.opts.eraserColor&&a.Utils.isColor(this.opts.background))this.ctx.strokeStyle=this.opts.background;else if(a.Utils.isColor(this.opts.eraserColor))this.ctx.strokeStyle=this.opts.eraserColor}else if(!this.mode||"eraser"===this.mode){this.ctx.strokeStyle=this.color}if("filler"===b)this.ev.bind("board:startDrawing",$.proxy(this.fill,this))}this.mode=b;if(!c)this.ev.trigger("board:mode",this.mode)},getMode:function getMode(){return this.mode||"pencil"},setColor:function setColor(b){var c=this;b=b||this.color;if(!a.Utils.isColor(b))return!1;this.color=b;if("transparent"!==this.opts.eraserColor&&"eraser"===this.mode){var d=function(a){if("eraser"!==a)c.strokeStyle=c.color;c.ev.unbind("board:mode",d)};this.ev.bind("board:mode",d)}else this.ctx.strokeStyle=this.color},fill:function fill(c){if(this.getImg()===this.blankCanvas){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.width);this.ctx.fillStyle=this.color;this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);return}var d=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),e=0,f=1,h=2,i=3,j=this.ctx.strokeStyle,k=parseInt(j.substr(1,2),16),l=parseInt(j.substr(3,2),16),g=parseInt(j.substr(5,2),16),b=a.Utils.pixelAt(d,parseInt(c.coords.x,10),parseInt(c.coords.y,10));if(b[i]===a.Utils.RGBToInt(k,l,g))return;var m=[b],n,o=d.width-1,p=d.height-1;while(n=m.pop()){if(n[i]===b[i]){d.data[n[e]]=k;d.data[n[e]+1]=l;d.data[n[e]+2]=g;if(0<n[f])m.push(a.Utils.pixelAt(d,n[f]-1,n[h]));if(n[f]<o)m.push(a.Utils.pixelAt(d,n[f]+1,n[h]));if(0<n[h])m.push(a.Utils.pixelAt(d,n[f],n[h]-1));if(n[h]<p)m.push(a.Utils.pixelAt(d,n[f],n[h]+1))}}this.ctx.putImageData(d,0,0)},initDrawEvents:function initDrawEvents(){this.isDrawing=!1;this.isMouseHovering=!1;this.coords={};this.coords.old=this.coords.current=this.coords.oldMid={x:0,y:0};this.dom.$canvas.on("mousedown touchstart",$.proxy(function(a){this._onInputStart(a,this._getInputCoords(a))},this));this.dom.$canvas.on("mousemove touchmove",$.proxy(function(a){this._onInputMove(a,this._getInputCoords(a))},this));this.dom.$canvas.on("mousemove",$.proxy(function(){},this));this.dom.$canvas.on("mouseup touchend",$.proxy(function(a){this._onInputStop(a,this._getInputCoords(a))},this));this.dom.$canvas.on("mouseover",$.proxy(function(a){this._onMouseOver(a,this._getInputCoords(a))},this));this.dom.$canvas.on("mouseout",$.proxy(function(a){this._onMouseOut(a,this._getInputCoords(a))},this));$("body").on("mouseup touchend",$.proxy(function(){this.isDrawing=!1},this));if(window.requestAnimationFrame)requestAnimationFrame($.proxy(this.draw,this))},draw:function draw(){if(window.requestAnimationFrame&&10<this.ctx.lineWidth&&this.isMouseHovering){this.dom.$cursor.css({width:this.ctx.lineWidth+"px",height:this.ctx.lineWidth+"px"});var b=a.Utils.tpl("translateX({{x}}px) translateY({{y}}px)",{x:this.coords.current.x-this.ctx.lineWidth/2,y:this.coords.current.y-this.ctx.lineWidth/2});this.dom.$cursor.css({transform:b,"-webkit-transform":b,"-ms-transform":b});this.dom.$cursor.removeClass("drawing-board-utils-hidden")}else{this.dom.$cursor.addClass("drawing-board-utils-hidden")}if(this.isDrawing){var c=this._getMidInputCoords(this.coords.current);this.ctx.beginPath();this.ctx.moveTo(c.x,c.y);this.ctx.quadraticCurveTo(this.coords.old.x,this.coords.old.y,this.coords.oldMid.x,this.coords.oldMid.y);this.ctx.stroke();this.coords.old=this.coords.current;this.coords.oldMid=c}if(window.requestAnimationFrame)requestAnimationFrame($.proxy(function(){this.draw()},this))},_onInputStart:function _onInputStart(a,b){this.coords.current=this.coords.old=b;this.coords.oldMid=this._getMidInputCoords(b);this.isDrawing=!0;if(!window.requestAnimationFrame)this.draw();this.ev.trigger("board:startDrawing",{e:a,coords:b});a.preventDefault()},_onInputMove:function _onInputMove(a,b){this.coords.current=b;this.ev.trigger("board:drawing",{e:a,coords:b});if(!window.requestAnimationFrame)this.draw();a.preventDefault()},_onInputStop:function _onInputStop(a,b){if(this.isDrawing&&(!a.touches||0===a.touches.length)){this.isDrawing=!1;this.saveWebStorage();this.saveHistory();this.ev.trigger("board:stopDrawing",{e:a,coords:b});this.ev.trigger("board:userAction");a.preventDefault()}},_onMouseOver:function _onMouseOver(a,b){this.isMouseHovering=!0;this.coords.old=this._getInputCoords(a);this.coords.oldMid=this._getMidInputCoords(this.coords.old);this.ev.trigger("board:mouseOver",{e:a,coords:b})},_onMouseOut:function _onMouseOut(a,b){this.isMouseHovering=!1;this.ev.trigger("board:mouseOut",{e:a,coords:b})},_getInputCoords:function _getInputCoords(a){a=a.originalEvent?a.originalEvent:a;var b,c;if(a.touches&&1==a.touches.length){b=a.touches[0].pageX;c=a.touches[0].pageY}else{b=a.pageX;c=a.pageY}return{x:b-this.dom.$canvas.offset().left,y:c-this.dom.$canvas.offset().top}},_getMidInputCoords:function _getMidInputCoords(a){return{x:this.coords.old.x+a.x>>1,y:this.coords.old.y+a.y>>1}}};a.Control=function(a,b){this.board=a;this.opts=$.extend({},this.defaults,b);this.$el=$(document.createElement("div")).addClass("drawing-board-control");if(this.name)this.$el.addClass("drawing-board-control-"+this.name);this.board.ev.bind("board:reset",$.proxy(this.onBoardReset,this));this.initialize.apply(this,arguments);return this};a.Control.prototype={name:"",defaults:{},initialize:function initialize(){},addToBoard:function addToBoard(){this.board.addControl(this)},onBoardReset:function onBoardReset(){}};a.Control.extend=function(a,b){var c=this,d;if(a&&a.hasOwnProperty("constructor")){d=a.constructor}else{d=function(){return c.apply(this,arguments)}}$.extend(d,c,b);var e=function(){this.constructor=d};e.prototype=c.prototype;d.prototype=new e;if(a)$.extend(d.prototype,a);d.__super__=c.prototype;return d};a.Control.Color=a.Control.extend({name:"colors",initialize:function initialize(){this.initTemplate();var a=this;this.$el.on("click",".drawing-board-control-colors-picker",function(b){var c=$(this).attr("data-color");a.board.setColor(c);a.$el.find(".drawing-board-control-colors-current").css("background-color",c).attr("data-color",c);a.board.ev.trigger("color:changed",c);a.$el.find(".drawing-board-control-colors-rainbows").addClass("drawing-board-utils-hidden");b.preventDefault()});this.$el.on("click",".drawing-board-control-colors-current",function(b){a.$el.find(".drawing-board-control-colors-rainbows").toggleClass("drawing-board-utils-hidden");b.preventDefault()});$("body").on("click",function(b){var c=$(b.target),d=c.hasClass("drawing-board-control-colors-current")?c:c.closest(".drawing-board-control-colors-current"),e=a.$el.find(".drawing-board-control-colors-current"),f=a.$el.find(".drawing-board-control-colors-rainbows");if((!d.length||d.get(0)!==e.get(0))&&!f.hasClass("drawing-board-utils-hidden"))f.addClass("drawing-board-utils-hidden")})},initTemplate:function initTemplate(){var b="<div class=\"drawing-board-control-colors-picker\" data-color=\"{{color}}\" style=\"background-color: {{color}}\"></div>",c="";$.each([.75,.5,.25],$.proxy(function(d,e){var f=0,g=null;c+="<div class=\"drawing-board-control-colors-rainbow\">";if(.25==e)g=this._rgba(0,0,0,1);if(.5==e)g=this._rgba(150,150,150,1);if(.75==e)g=this._rgba(255,255,255,1);c+=a.Utils.tpl(b,{color:g.toString()});while(330>=f){c+=a.Utils.tpl(b,{color:this._hsl2Rgba(this._hsl(f-60,1,e)).toString()});f+=30}c+="</div>"},this));this.$el.append($(a.Utils.tpl("<div class=\"drawing-board-control-inner\"><div class=\"drawing-board-control-colors-current\" style=\"background-color: {{color}}\" data-color=\"{{color}}\"></div><div class=\"drawing-board-control-colors-rainbows\">{{rainbows}}</div></div>",{color:this.board.color,rainbows:c})));this.$el.find(".drawing-board-control-colors-rainbows").addClass("drawing-board-utils-hidden")},onBoardReset:function onBoardReset(){this.board.setColor(this.$el.find(".drawing-board-control-colors-current").attr("data-color"))},_rgba:function _rgba(c,d,e,b){return{r:c,g:d,b:e,a:b,toString:function toString(){return"rgba("+c+", "+d+", "+e+", "+b+")"}}},_hsl:function _hsl(a,b,c){return{h:a,s:b,l:c,toString:function toString(){return"hsl("+a+", "+100*b+"%, "+100*c+"%)"}}},_hex2Rgba:function _hex2Rgba(a){var b=parseInt(a.substring(1),16);return this._rgba(b>>16,255&b>>8,255&b,1)},_hsl2Rgba:function _hsl2Rgba(a){var d=a.h/360,e=a.s,f=a.l,h,i,j;function c(a,b,c){if(0>c)c+=1;if(1<c)c-=1;if(c<1/6)return a+6*(b-a)*c;if(c<1/2)return b;if(c<2/3)return a+6*((b-a)*(2/3-c));return a}if(0===e){h=i=j=f}else{var k=.5>f?f*(1+e):f+e-f*e,l=2*f-k;h=Math.floor(255*c(l,k,d+1/3));i=Math.floor(255*c(l,k,d));j=Math.floor(255*c(l,k,d-1/3))}return this._rgba(h,i,j,1)}});a.Control.DrawingMode=a.Control.extend({name:"drawingmode",defaults:{pencil:!0,eraser:!0,filler:!0},initialize:function initialize(){this.prevMode=this.board.getMode();$.each(["pencil","eraser","filler"],$.proxy(function(a,b){if(this.opts[b]){this.$el.append("<button class=\"drawing-board-control-drawingmode-"+b+"-button\" data-mode=\""+b+"\"></button>")}},this));this.$el.on("click","button[data-mode]",$.proxy(function(a){var b=$(a.currentTarget).attr("data-mode"),c=this.board.getMode();if(c!==b)this.prevMode=c;var d=c===b?this.prevMode:b;this.board.setMode(d);a.preventDefault()},this));this.board.ev.bind("board:mode",$.proxy(function(a){this.toggleButtons(a)},this));this.toggleButtons(this.board.getMode())},toggleButtons:function toggleButtons(a){this.$el.find("button[data-mode]").each(function(b,c){var d=$(c);d.toggleClass("active",a===d.attr("data-mode"))})}});a.Control.Navigation=a.Control.extend({name:"navigation",defaults:{back:!0,forward:!0,reset:!0},initialize:function initialize(){var a="";if(this.opts.back)a+="<button class=\"drawing-board-control-navigation-back\">&larr;</button>";if(this.opts.forward)a+="<button class=\"drawing-board-control-navigation-forward\">&rarr;</button>";if(this.opts.reset)a+="<button class=\"drawing-board-control-navigation-reset\">&times;</button>";this.$el.append(a);if(this.opts.back){var b=this.$el.find(".drawing-board-control-navigation-back");this.board.ev.bind("historyNavigation",$.proxy(function(a){if(1===a)b.attr("disabled","disabled");else b.removeAttr("disabled")},this));this.$el.on("click",".drawing-board-control-navigation-back",$.proxy(function(a){this.board.goBackInHistory();a.preventDefault()},this))}if(this.opts.forward){var c=this.$el.find(".drawing-board-control-navigation-forward");this.board.ev.bind("historyNavigation",$.proxy(function(a){if(a===this.board.history.values.length)c.attr("disabled","disabled");else c.removeAttr("disabled")},this));this.$el.on("click",".drawing-board-control-navigation-forward",$.proxy(function(a){this.board.goForthInHistory();a.preventDefault()},this))}if(this.opts.reset){this.$el.on("click",".drawing-board-control-navigation-reset",$.proxy(function(a){this.board.reset({background:!0});a.preventDefault()},this))}}});a.Control.Size=a.Control.extend({name:"size",defaults:{type:"auto",dropdownValues:[1,3,6,10,20,30,40,50]},types:["dropdown","range"],initialize:function initialize(){if("auto"==this.opts.type)this.opts.type=this._iHasRangeInput()?"range":"dropdown";var a=-1<$.inArray(this.opts.type,this.types)?this["_"+this.opts.type+"Template"]():!1;if(!a)return!1;this.val=this.board.opts.size;this.$el.append($(a));this.$el.attr("data-drawing-board-type",this.opts.type);this.updateView();var b=this;if("range"==this.opts.type){this.$el.on("change",".drawing-board-control-size-range-input",function(a){b.val=$(this).val();b.updateView();b.board.ev.trigger("size:changed",b.val);a.preventDefault()})}if("dropdown"==this.opts.type){this.$el.on("click",".drawing-board-control-size-dropdown-current",$.proxy(function(){this.$el.find(".drawing-board-control-size-dropdown").toggleClass("drawing-board-utils-hidden")},this));this.$el.on("click","[data-size]",function(a){b.val=parseInt($(this).attr("data-size"),0);b.updateView();b.board.ev.trigger("size:changed",b.val);a.preventDefault()})}},_rangeTemplate:function _rangeTemplate(){return a.Utils.tpl("<div class=\"drawing-board-control-inner\" title=\"{{size}}\"><input type=\"range\" min=\"1\" max=\"50\" value=\"{{size}}\" step=\"1\" class=\"drawing-board-control-size-range-input\"><span class=\"drawing-board-control-size-range-current\"></span></div>",{size:this.board.opts.size})},_dropdownTemplate:function _dropdownTemplate(){var b="<div class=\"drawing-board-control-inner\" title=\"{{size}}\"><div class=\"drawing-board-control-size-dropdown-current\"><span></span></div><ul class=\"drawing-board-control-size-dropdown\">";$.each(this.opts.dropdownValues,function(c,d){b+=a.Utils.tpl("<li data-size=\"{{size}}\"><span style=\"width: {{size}}px; height: {{size}}px; border-radius: {{size}}px;\"></span></li>",{size:d})});b+="</ul></div>";return b},onBoardReset:function onBoardReset(){this.updateView()},updateView:function updateView(){var a=this.val;this.board.ctx.lineWidth=a;this.$el.find(".drawing-board-control-size-range-current, .drawing-board-control-size-dropdown-current span").css({width:a+"px",height:a+"px",borderRadius:a+"px",marginLeft:-1*a/2+"px",marginTop:-1*a/2+"px"});this.$el.find(".drawing-board-control-inner").attr("title",a);if("dropdown"==this.opts.type){var b=null;$.each(this.opts.dropdownValues,function(c,d){if(null===b||Math.abs(d-a)<Math.abs(b-a))b=d});this.$el.find(".drawing-board-control-size-dropdown").addClass("drawing-board-utils-hidden")}},_iHasRangeInput:function _iHasRangeInput(){var a=document.createElement("input"),b=document.documentElement,c;a.setAttribute("type","range");c="text"!==a.type;a.value=":)";a.style.cssText="position:absolute;visibility:hidden;";if(/^range$/.test("range")&&a.style.WebkitAppearance!==void 0){b.appendChild(a);defaultView=document.defaultView;c=defaultView.getComputedStyle&&"textfield"!==defaultView.getComputedStyle(a,null).WebkitAppearance&&0!==a.offsetHeight;b.removeChild(a)}return!!c}});a.Control.Download=a.Control.extend({name:"download",initialize:function initialize(){this.$el.append("<button class=\"drawing-board-control-download-button\"></button>");this.$el.on("click",".drawing-board-control-download-button",$.proxy(function(a){this.board.downloadImg();a.preventDefault()},this))}});a.Utils={};a.Utils.tpl=function(){"use strict";var a;return function(b,c){return b.replace(/{{\s*([a-z0-9_][\.a-z0-9_]*)\s*}}/gi,function(b,d){var e=d.split("."),f=e.length,g=c,h=0;for(;h<f;h++){g=g[e[h]];if(g===a){throw"tim: '"+e[h]+"' not found in "+b}if(h==f-1){return g}}})}}();a.Utils.MicroEvent=function(){};a.Utils.MicroEvent.prototype={bind:function bind(a,b){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(b)},unbind:function unbind(a,b){this._events=this._events||{};if(!1==a in this._events)return;this._events[a].splice(this._events[a].indexOf(b),1)},trigger:function trigger(a){this._events=this._events||{};if(!1==a in this._events)return;for(var b=0;b<this._events[a].length;b++){this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}}};a.Utils._boxBorderSize=function(a,b,c,d){b=!!b||!0;c=!!c||!1;var e=0,f;if("width"==d){f=["border-left-width","border-right-width"];if(b)f.push("padding-left","padding-right");if(c)f.push("margin-left","margin-right")}else{f=["border-top-width","border-bottom-width"];if(b)f.push("padding-top","padding-bottom");if(c)f.push("margin-top","margin-bottom")}for(var g=f.length-1;0<=g;g--){e+=parseInt(a.css(f[g]).replace("px",""),10)}return e};a.Utils.boxBorderWidth=function(b,c,d){return a.Utils._boxBorderSize(b,c,d,"width")};a.Utils.boxBorderHeight=function(b,c,d){return a.Utils._boxBorderSize(b,c,d,"height")};a.Utils.isColor=function(a){if(!a||!a.length)return!1;return /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a)||-1!==$.inArray(a.substring(0,3),["rgb","hsl"])};a.Utils.RGBToInt=function(a,d,e){var b=0;b|=(255&a)<<16;b|=(255&d)<<8;b|=255&e;return b};a.Utils.pixelAt=function(b,d,e){var f=4*(e*b.width+d),g=a.Utils.RGBToInt(b.data[f],b.data[f+1],b.data[f+2]);return[f,d,e,g]};(function(){for(var a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;++b){window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"]}})();var b;if("undefined"!=typeof window){b=window}else if("undefined"!=typeof global){b=global}else if("undefined"!=typeof self){b=self}else{b=this}b.DrawingBoard=a;return a});
//# sourceMappingURL=drawingboard.min.js.map
