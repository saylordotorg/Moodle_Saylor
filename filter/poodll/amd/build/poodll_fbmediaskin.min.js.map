{"version":3,"sources":["../src/poodll_fbmediaskin.js"],"names":["define","$","log","debug","instanceprops","pmr","uploaded","clone","extend","init","ip","warmedup","fetch_instanceprops","onUploadSuccess","controlbarid","hide","show","onUploadFailure","fetch_status_bar","skin","fetch_preview_audio","fetch_model_audio","modelplayer","M","cfg","wwwroot","fetch_preview_video","fetch_resource_audio","resourceplayer","fetch_resource_video","fetch_uploader_skin","fetch_ding_player","dingplayer","onMediaError","e","console","error","onMediaSuccess_video","highlight_button","uploader","Output","timer","reset","start","update_status","controlbar","stopbutton","attr","savebutton","onMediaSuccess_audio","checkplayer","do_pause_audio","handle_timer_update","seconds","initseconds","stoprecbutton","click","insert_controlbar_video","element","prepare_controlbar","insert_controlbar_audio","mediatype","skin_style","config","media_skin_style","recorder_class","replace","resource","resource2","status","size_class","size","controls","util","get_string","prepend","resourcebutton","startbutton","playbutton","playmodelbutton","resourcewrapper","startrecwrapper","playmodelwrapper","register_controlbar_events_video","onMediaSuccess","register_controlbar_events_audio","play_ding","action","play","alert","onended","highlightwrapper","wrappers","each","hasClass","removeClass","addClass","warmup_recorder","warmup_context","warmup_preview","do_start_audio","model","get","ding","pause","dingurl","self","on","do_resume_audio","do_stop_audio","stop","do_play_audio","disable_button","blobs","length","do_save_audio","window","onbeforeunload","enable_button","button","prop","show_button","hide_button"],"mappings":"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","sourcesContent":["/* jshint ignore:start */\ndefine(['jquery', 'core/log', 'filter_poodll/utils_amd'], function ($, log, utils) {\n\n    \"use strict\"; // jshint ;_;\n\n    log.debug('PoodLL Fluencybuilder Skin: initialising');\n\n    return {\n\n        instanceprops: null,\n        pmr: null,\n        uploaded: false,\n\n        //for making multiple instances\n        clone: function () {\n            return $.extend(true, {}, this);\n        },\n\n        init: function (ip, pmr) {\n            this.instanceprops = ip;\n            this.instanceprops.warmedup = false;\n            this.pmr = pmr;\n        },\n\n\n        fetch_instanceprops: function () {\n            return this.instanceprops;\n        },\n\n\n        onUploadSuccess: function (controlbarid) {\n            $('#' + controlbarid + ' > .poodll_save-recording').hide();\n            // $('#' + controlbarid  + '_messages').hide();\n            $('#' + controlbarid + ' > .poodll_savedsuccessfully').show();\n        },\n\n        onUploadFailure: function (controlbarid) {\n            return;\n        },\n\n        fetch_status_bar: function (skin) {\n            var status = '<div class=\"poodll_status_' + skin + ' hide\"></div>';\n            return status;\n        },\n\n        fetch_preview_audio: function (skin) {\n            var checkplayer = '<audio class=\"poodll_checkplayer_' + skin + ' hide\" playsinline=\"playsinline\" muted></audio>';\n            return checkplayer;\n        },\n        fetch_model_audio: function () {\n            var modelplayer = '<audio class=\"poodll_modelplayer_fluencybuilder hide\" src=\"' + M.cfg.wwwroot + '/filter/poodll/ding.mp3\" playsinline=\"playsinline\"></audio>';\n            return modelplayer;\n        },\n        fetch_preview_video: function (skin) {\n            var checkplayer = '<video class=\"poodll_checkplayer_' + skin + '\" width=\"320\" height=\"240\" playsinline=\"playsinline\" muted></video>';\n            return checkplayer;\n        },\n        fetch_resource_audio: function (skin) {\n            var resourceplayer = '<audio class=\"poodll_resourceplayer_' + skin + ' hide\" src=\"' + M.cfg.wwwroot + '/filter/poodll/ding.mp3\" playsinline=\"playsinline\"></audio>';\n            return resourceplayer;\n        },\n        fetch_resource_video: function (skin) {\n            var resourceplayer = '<video class=\"poodll_resourceplayer_' + skin + ' hide\" src=\"@@RESOURCEURLx@@\" playsinline=\"playsinline\"></video>';\n            return resourceplayer;\n        },\n        fetch_uploader_skin: function (controlbarid, element) {\n            return false;\n        },\n        fetch_ding_player: function () {\n            var skin = 'fluencybuilder';\n            var dingplayer = '<audio class=\"poodll_dingplayer_' + skin + ' hide\"  src=\"' + M.cfg.wwwroot + '/filter/poodll/ding.mp3\" ></audio>';\n            return dingplayer;\n        },\n        onMediaError: function (e) {\n            console.error('media error', e);\n        },\n\n        onMediaSuccess_video: function (controlbarid) {\n            var ip = this.fetch_instanceprops(controlbarid);\n\n            this.highlight_button('bwrapper_start-recording', controlbarid);\n\n            //clear messages\n            ip.uploader.Output('');\n\n            //timer and status bar\n            ip.timer.reset();\n            ip.timer.start();\n            this.update_status(controlbarid);\n\n            ip.controlbar.stopbutton.attr('disabled', false);\n            ip.controlbar.savebutton.attr('disabled', false);\n\n        },\n\n        onMediaSuccess_audio: function (controlbarid) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            ip.controlbar.checkplayer.attr('src', null);\n            this.pmr.do_pause_audio(ip);\n\n        },\n\n        handle_timer_update: function (controlbarid) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            this.update_status(controlbarid);\n            if (ip.timer.seconds == 0 && ip.timer.initseconds > 0) {\n                ip.controlbar.stoprecbutton.click();\n            }\n        },\n\n        update_status: function (controlbarid) {\n            /*\n            var ip = this.fetch_instanceprops(controlbarid);\n            ip.controlbar.status.html(ip.timer.fetch_display_time());\n            */\n        },\n\n\n        //insert the control bar and return it to be reused\n        insert_controlbar_video: function (element, controlbarid, checkplayer, resourceplayer) {\n            var controlbar = this.prepare_controlbar(element, controlbarid, checkplayer, resourceplayer, 'video');\n            return controlbar;\n        },\n\n        //insert the control bar and return it to be reused\n        insert_controlbar_audio: function (element, controlbarid, checkplayer, resourceplayer) {\n            var controlbar = this.prepare_controlbar(element, controlbarid, checkplayer, resourceplayer, 'audio');\n            return controlbar;\n        },\n\n        //insert the control bar and return it to be reused\n        prepare_controlbar: function (element, controlbarid, checkplayer, resourceplayer, mediatype) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            var skin_style = ip.config.media_skin_style;\n\n            var recorder_class = mediatype == 'video' ? 'poodll_mediarecorder_video' : 'poodll_mediarecorder_audio';\n\n            //fetch html for players and items that t\n            var resourceplayer = resourceplayer.replace('@@RESOURCEURL@@', ip.config.resource);\n            var modelplayer = this.fetch_model_audio();\n            modelplayer = modelplayer.replace('@@MODELURL@@', ip.config.resource2);\n            var dingplayer = this.fetch_ding_player();\n            var status = this.fetch_status_bar('fluencybuilder');\n\n            //fetch the size class we use. Not really meaningful in fluency builder\n            var size_class = 'poodll_mediarecorder_size_auto';\n            switch (ip.config.size) {\n                case 'small':\n                    size_class = 'poodll_mediarecorder_size_small';\n                    break;\n                case 'big':\n                    size_class = 'poodll_mediarecorder_size_big';\n                    break;\n                case 'auto':\n                    size_class = 'poodll_mediarecorder_size_auto';\n            }\n\n\n            var controls = '<div class=\"poodll_mediarecorderholder_fluencybuilder '\n                + recorder_class + ' ' + size_class + '\" id=\"holder_' + controlbarid + '\">';\n\n            controls += '<div class=\"poodll_mediarecorderbox_fluencybuilder\" id=\"' + controlbarid + '\">';\n            controls += '<div class=\"style-holder ' + skin_style + '\">';\n            controls += status,\n                controls += dingplayer,\n                controls += modelplayer,\n                controls += checkplayer,\n                controls += resourceplayer,\n                controls += '<div class=\"fb_bwrapper bwrapper_play-resource mod_fluencybuilder_autobutton_inactive\"><button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_play-resource_fluencybuilder\"><i class=\"fa fa-assistive-listening-systems\" aria-hidden=\"true\"></i></button></div>';\n            controls += '<div class=\"fb_bwrapper bwrapper_start-recording mod_fluencybuilder_autobutton_inactive\"><button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_start-recording_fluencybuilder\" disabled><i class=\"fa fa-microphone\" aria-hidden=\"true\"></i></button></div>';\n            controls += '<div class=\"fb_bwrapper bwrapper_play-model mod_fluencybuilder_autobutton_inactive\"> <button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_play-model_fluencybuilder\" disabled><i class=\"fa fa-play-circle\" aria-hidden=\"true\"></i></button></div>';\n\n            /* hidden buttons: they still are used internally so we need them, but user doesn't see them */\n            controls += '<button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_play-recording_fluencybuilder hide\">' + M.util.get_string('recui_play', 'filter_poodll') + '</button>';\n            controls += '<button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_stop-playing_fluencybuilder hide\">' + 'stopplay' + '</button>';\n            controls += '<button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_stop-recording_fluencybuilder hide\">' + M.util.get_string('recui_stop', 'filter_poodll') + '</button>';\n            controls += '<button type=\"button\" class=\"poodll_save-recording_fluencybuilder pmr_disabled hide\">' + M.util.get_string('recui_save', 'filter_poodll') + '</button>';\n            controls += '</div></div></div>';\n            $(element).prepend(controls);\n\n            var controlbar = {\n                status: $('#' + controlbarid + '  .poodll_status_fluencybuilder'),\n                dingplayer: $('#' + controlbarid + '  .poodll_dingplayer_fluencybuilder'),\n                modelplayer: $('#' + controlbarid + '  .poodll_modelplayer_fluencybuilder'),\n                resourceplayer: $('#' + controlbarid + '  .poodll_resourceplayer_fluencybuilder'),\n                checkplayer: $('#' + controlbarid + '  .poodll_checkplayer_fluencybuilder'),\n                resourcebutton: $('#' + controlbarid + '  .poodll_play-resource_fluencybuilder'),\n                startbutton: $('#' + controlbarid + '  .poodll_start-recording_fluencybuilder'),\n                stoprecbutton: $('#' + controlbarid + '  .poodll_stop-recording_fluencybuilder'),\n                stopbutton: $('#' + controlbarid + '  .poodll_stop-playing_fluencybuilder'),\n                playbutton: $('#' + controlbarid + '  .poodll_play-recording_fluencybuilder'),\n                playmodelbutton: $('#' + controlbarid + '  .poodll_play-model_fluencybuilder'),\n                savebutton: $('#' + controlbarid + '  .poodll_save-recording_fluencybuilder'),\n                resourcewrapper: $('#' + controlbarid + '  .bwrapper_play-resource'),\n                startrecwrapper: $('#' + controlbarid + '  .bwrapper_start-recording'),\n                playmodelwrapper: $('#' + controlbarid + '  .bwrapper_play-model')\n            };\n            return controlbar;\n        }, //end of fetch_control_bar_fluencybuilder\n\n\n        register_controlbar_events_video: function (onMediaSuccess, controlbarid) {\n            return this.register_controlbar_events_audio(onMediaSuccess, controlbarid);\n        },\n\n\n        /*\n        * Plays a ding and calls the next action\n        *\n        *\n         */\n        play_ding: function (action, controlbarid) {\n\n            var ip = this.fetch_instanceprops(controlbarid);\n            ip.controlbar.dingplayer[0].play();\n            switch (action) {\n                case 'click_start':\n                    ip.controlbar.startbutton.click();\n                    break;\n                case 'click_play':\n                    ip.controlbar.playmodelbutton.click();\n                    break;\n                case 'show_dialog':\n                    alert('dialog');\n                    break;\n                default:\n                    ip.controlbar.dingplayer[0].onended = null;\n            }\n        },\n\n        /*\n         * Highlights the current button (wrapper) and dehighlishts the rest\n         *\n         *\n         */\n        highlight_button: function (highlightwrapper, controlbarid) {\n            var wrappers = $('#' + controlbarid + '  .fb_bwrapper');\n            $(wrappers).each(function (index) {\n                if ($(this).hasClass(highlightwrapper)) {\n                    $(this).removeClass('mod_fluencybuilder_autobutton_inactive');\n                    $(this).addClass('mod_fluencybuilder_autobutton_active');\n                } else {\n                    $(this).removeClass('mod_fluencybuilder_autobutton_active');\n                    $(this).addClass('mod_fluencybuilder_autobutton_inactive');\n                }\n            });\n        },\n\n        warmup_recorder: function (controlbarid, onMediaSuccess) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            //warm up preview player and audiocontext\n            this.pmr.warmup_context(ip);\n            this.pmr.warmup_preview(ip);\n\n            //We start recording here for mobile sfari click proximity\n            //but immediately pause it in onMediaSuccess\n            //when we really start (start-rec button click event), we \"resume\" recording\n            this.pmr.do_start_audio(ip, onMediaSuccess);\n\n\n            //fetch players and info\t\n            var model = ip.controlbar.modelplayer.get(0);\n            var ding = ip.controlbar.dingplayer.get(0);\n            var resource = ip.controlbar.resourceplayer.get(0);\n\n\n            if (!ip.warmedup) {\n                //play from players\n                try {\n                    resource.play();\n                    ding.play();\n                    model.play();\n                    resource.pause();\n                    ding.pause();\n                    model.pause();\n\n                } catch (e) {\n                    //do nothing\n                }\n            }\n\n\n            //set src on urls\n            var dingurl = M.cfg.wwwroot + '/filter/poodll/ding.mp3';\n            $(model).attr('src', ip.config.resource2);\n            $(ding).attr('src', dingurl);\n            $(resource).attr('src', ip.config.resource);\n            //flag all warmed up\n            ip.warmedup = true;\n        },\n\n        register_controlbar_events_audio: function (onMediaSuccess, controlbarid) {\n            var self = this;\n            var pmr = this.pmr;\n            var ip = this.fetch_instanceprops(controlbarid);\n\n            //when audio prompt finishes , play ding, then start recording\n            //AUTOMATION\n            ip.controlbar.resourceplayer.on('ended', function () {\n                if (ip.warmedup) {\n                    self.play_ding('click_start', controlbarid);\n                }\n            });\n\n            ip.controlbar.modelplayer.on('ended', function () {\n                self.highlight_button('', controlbarid);\n            });\n\n\n            //when start recording button clicked\n            ip.controlbar.startbutton.click(function () {\n\n                //pmr.do_start_audio(ip, onMediaSuccess);\n                pmr.do_resume_audio(ip);\n\n\n                self.highlight_button('bwrapper_start-recording', controlbarid);\n\n                //clear messages\n                ip.uploader.Output('');\n\n                //timer and status bar\n                ip.timer.reset();\n                ip.timer.start();\n                self.update_status(controlbarid);\n\n                ip.controlbar.stopbutton.attr('disabled', false);\n                ip.controlbar.savebutton.attr('disabled', false);\n\n            });\n\n\n            //when the stop recording button is pressed\n            ip.controlbar.stoprecbutton.click(function () {\n                pmr.do_stop_audio(ip);\n\n                //AUTOMATION\n                self.play_ding('click_play', controlbarid);\n\n                //timer and status bar\n                ip.timer.stop()\n                self.update_status(controlbarid);\n            });\n\n            //when the stop playing recording button is pressed\n            ip.controlbar.stopbutton.click(function () {\n\n                self.highlight_button('none', controlbarid);\n\n                //timer and status bar\n                ip.timer.stop()\n                self.update_status(controlbarid);\n\n            });\n\n            //when the play recording button is pressed\n            ip.controlbar.playmodelbutton.click(function () {\n                var modelplayer = ip.controlbar.modelplayer.get(0);\n                modelplayer.play();\n                self.highlight_button('bwrapper_play-model', controlbarid);\n\n            });\n\n            //when the play recording button is pressed\n            ip.controlbar.playbutton.click(function () {\n                var checkplayer = ip.controlbar.checkplayer.get(0);\n                pmr.do_play_audio(ip, checkplayer);\n            });\n\n            //when the play prompt button is pressed\n            ip.controlbar.resourcebutton.click(function () {\n\n                self.warmup_recorder(controlbarid, onMediaSuccess);\n\n                self.disable_button(this);\n                var resourceplayer = ip.controlbar.resourceplayer.get(0);\n                resourceplayer.play();\n                self.highlight_button('bwrapper_play-resource', controlbarid);\n            });\n\n            //when the save button is pressed\n            ip.controlbar.savebutton.click(function () {\n                self.disable_button(this);\n                if (ip.blobs && ip.blobs.length > 0) {\n                    pmr.do_save_audio(ip);\n                    self.uploaded = true;\n                    self.disable_button(ip.controlbar.startbutton);\n                } else {\n                    ip.uploader.Output(M.util.get_string('recui_nothingtosaveerror', 'filter_poodll'));\n                }//end of if self.blobs\t\t\n                //probably not necessary  ... but getting odd ajax errors occasionally\n                return false;\n            });//end of save recording\n\n            window.onbeforeunload = function () {\n                self.enable_button(ip.controlbar.startbutton);\n                var checkplayer = ip.controlbar.checkplayer;\n                if (checkplayer && checkplayer.get(0)) {\n                    checkplayer.get(0).pause();\n                }\n            };\n        }, //end of register_control_bar_events_fluencybuilder\n\n        /*\n         * convenient functions to hide/show/enable/disable buttons\n         *\n         *\n         */\n        enable_button: function (button) {\n            $(button).prop('disabled', false);\n\n            // $(button).removeClass('pmr_disabled');\n        },\n        disable_button: function (button) {\n            $(button).prop('disabled', true);\n            //  $(button).addClass('pmr_disabled');\n        },\n        show_button: function (button) {\n            button.show();\n        },\n        hide_button: function (button) {\n            button.hide();\n        },\n\n    };//end of returned object\n});//total end\n"],"file":"poodll_fbmediaskin.min.js"}