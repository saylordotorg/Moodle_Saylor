define(["jquery","core/log","filter_poodll/utils_amd","filter_poodll/upskin_radial","filter_poodll/util_dragdrop"],function(a,b,c,d,e){"use strict";return b.debug("PoodLL Upload Media skin: initialising"),{instanceprops:null,pmr:null,clone:function(){return a.extend(!0,{},this)},init:function(a,b){this.instanceprops=a,this.pmr=b},fetch_status_bar:function(a){var b="";return b},fetch_preview_audio:function(a){var b="";return b},fetch_preview_video:function(a){var b="";return b},fetch_resource_audio:function(a){var b="";return b},fetch_resource_video:function(a){var b="";return b},fetch_uploader_skin:function(a,b){var c=this.fetch_instance_props(),e=d.clone();return e.init(c.config,b,c.controlbar.uploadcanvas,c.controlbar.uploadmessages),e.setDrawParam("lineWidth",2),e.setDrawParam("font","14px Arial"),e},handle_timer_update:function(a){},onUploadSuccess:function(b){a("#"+b+" > .poodll_save-recording").hide(),a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function(a){},onMediaSuccess_video:function(a){},onMediaSuccess_audio:function(a){},insert_controlbar_video:function(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},register_controlbar_events_video:function(a,b){return this.register_events(b)},register_controlbar_events_audio:function(a,b){return this.register_events(b)},fetch_instance_props:function(){return this.instanceprops},prepare_controlbar:function(b,d,e,f,g){var h=this.fetch_instance_props(),i="";switch(g){case"video":i="video/webm,video/ogg,video/mp4,video/x-m4v,video/*";break;case"snapshot":case"image":i="image/*";case"audio":var j=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;i=j?"video/*":"audio/*";default:i=""}if(c.is_ios()||c.is_android())var k=M.util.get_string("recui_recordorchoose","filter_poodll");else var k=M.util.get_string("recui_choosefile","filter_poodll");var l=h.config.media_skin_style,m="video"==g?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",n='<div class="poodll_mediarecorderholder_upload '+m+'" id="holder_'+d+'">';if(n+='<div class="poodll_mediarecorderbox_upload" id="'+d+'">',n+=h.errordialog.fetch_dialogue_box(),n+='<div class="style-holder '+l+'">',"audio"==g)var o=250,p=50;else var o=130,p=210;n+='<div class="poodll_mediarecorder_uploadcanvas_cont_upload"><canvas id="'+d+'_uploadcanvas" width="'+o+'" height="'+p+'" class="poodll_mediarecorder_uploadcanvas_upload"></canvas></div>',n+='<div class="p_btn_wrapper">',n+='<input type="file" id="'+d+'_poodllfileselect" name="poodllfileselect[]" accept="'+i+'"/>',n+='<button type="button" id="'+d+'_p_btn" class="p_btn">'+k+"</button>",n+="</div>",n+='<div class="poodll_uploadmessages_once"></div>',n+="</div></div></div>",a(b).prepend(n);var q={errorsdialog:a("#"+d+" .poodll_dialogue_box_errors"),filebutton:a("#"+d+"_poodllfileselect"),startbutton:a("#"+d+"_p_btn"),uploadcanvas:a("#"+d+"_uploadcanvas"),uploadmessages:a("#"+d+" .poodll_uploadmessages_once")};return h.errordialog.set_dialogue_box(q.errorsdialog),q},register_events:function(a){var b=this,c=(this.pmr,this.fetch_instance_props());c.config.hermes.enable(),c.controlbar.filebutton.on("change",function(a){var d=a.target.files||a.dataTransfer.files;b.FileSelectHandler(d,c.uploader),e.turnoff_dragdrop(),c.controlbar.filebutton.off("change"),c.controlbar.filebutton.attr("disabled",!0)}),e.init(c.controlbar.uploadcanvas,this.FileSelectHandler,c)},FileSelectHandler:function(a,c){for(var d,e=0;d=a[e];e++)b.debug("filetype:"+d.type),c.uploadBlob(d,d.type)}}});