define(["jquery","core/log","filter_poodll/utils_amd","filter_poodll/upskin_radial","filter_poodll/util_dragdrop"],(function($,log,utils,upskin_radial,dd){return log.debug("PoodLL Upload Media skin: initialising"),{instanceprops:null,pmr:null,clone:function(){return $.extend(!0,{},this)},init:function(ip,pmr){this.instanceprops=ip,this.pmr=pmr},fetch_status_bar:function(skinname){return""},fetch_preview_audio:function(skinname){return""},fetch_preview_video:function(skinname){return""},fetch_resource_audio:function(skinname){return""},fetch_resource_video:function(skinname){return""},fetch_uploader_skin:function(controlbarid,element){var ip=this.fetch_instance_props(),upskin=upskin_radial.clone();return upskin.init(ip.config,element,ip.controlbar.uploadcanvas,ip.controlbar.uploadmessages),upskin.setDrawParam("lineWidth",2),upskin.setDrawParam("font","14px Arial"),upskin},handle_timer_update:function(controlbarid){},onUploadSuccess:function(controlbarid){$("#"+controlbarid+" > .poodll_save-recording").hide(),$("#"+controlbarid+" > .poodll_savedsuccessfully").show()},onUploadFailure:function(controlbarid){},onMediaSuccess_video:function(controlbarid){},onMediaSuccess_audio:function(controlbarid){},insert_controlbar_video:function(element,controlbarid,preview,resource){return this.prepare_controlbar(element,controlbarid,preview,resource,"video")},insert_controlbar_audio:function(element,controlbarid,preview,resource){return this.prepare_controlbar(element,controlbarid,preview,resource,"audio")},register_controlbar_events_video:function(onMediaSuccess,controlbarid){return this.register_events(controlbarid)},register_controlbar_events_audio:function(onMediaSuccess,controlbarid){return this.register_events(controlbarid)},fetch_instance_props:function(){return this.instanceprops},prepare_controlbar:function(element,controlbarid,preview,resource,mediatype){var ip=this.fetch_instance_props(),acceptmedia="";switch(mediatype){case"video":acceptmedia="video/webm,video/ogg,video/mp4,video/x-m4v,video/*";break;case"snapshot":case"image":acceptmedia="image/*";case"audio":acceptmedia=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream?"video/*":"audio/*";default:acceptmedia=""}if(utils.is_ios()||utils.is_android())var ss_chooselabel=M.util.get_string("recui_recordorchoose","filter_poodll");else ss_chooselabel=M.util.get_string("recui_choosefile","filter_poodll");var skin_style=ip.config.media_skin_style,controls='<div class="poodll_mediarecorderholder_upload '+("video"==mediatype?"poodll_mediarecorder_video":"poodll_mediarecorder_audio")+'" id="holder_'+controlbarid+'">';if(controls+='<div class="poodll_mediarecorderbox_upload" id="'+controlbarid+'">',controls+=ip.errordialog.fetch_dialogue_box(),controls+='<div class="style-holder '+skin_style+'">',"audio"==mediatype)var canvaswidth=250,canvasheight=50;else canvaswidth=130,canvasheight=210;controls+='<div class="poodll_mediarecorder_uploadcanvas_cont_upload"><canvas id="'+controlbarid+'_uploadcanvas" width="'+canvaswidth+'" height="'+canvasheight+'" class="poodll_mediarecorder_uploadcanvas_upload"></canvas></div>',controls+='<div class="p_btn_wrapper">',controls+='<input type="file" id="'+controlbarid+'_poodllfileselect" name="poodllfileselect[]" accept="'+acceptmedia+'"/>',controls+='<button type="button" id="'+controlbarid+'_p_btn" class="p_btn">'+ss_chooselabel+"</button>",controls+="</div>",controls+='<div class="poodll_uploadmessages_once"></div>',controls+="</div></div></div>",$(element).prepend(controls);var controlbar={errorsdialog:$("#"+controlbarid+" .poodll_dialogue_box_errors"),filebutton:$("#"+controlbarid+"_poodllfileselect"),startbutton:$("#"+controlbarid+"_p_btn"),uploadcanvas:$("#"+controlbarid+"_uploadcanvas"),uploadmessages:$("#"+controlbarid+" .poodll_uploadmessages_once")};return ip.errordialog.set_dialogue_box(controlbar.errorsdialog),controlbar},register_events:function(controlbarid){var self=this,ip=(this.pmr,this.fetch_instance_props());ip.config.hermes.enable(),ip.controlbar.filebutton.on("change",(function(e){var files=e.target.files||e.dataTransfer.files;self.FileSelectHandler(files,ip.uploader),dd.turnoff_dragdrop(),ip.controlbar.filebutton.off("change"),ip.controlbar.filebutton.attr("disabled",!0)})),dd.init(ip.controlbar.uploadcanvas,this.FileSelectHandler,ip)},FileSelectHandler:function(files,uploader){for(var file,i=0;file=files[i];i++)log.debug("filetype:"+file.type),uploader.uploadBlob(file,file.type)}}}));

//# sourceMappingURL=poodll_uploadmediaskin.min.js.map