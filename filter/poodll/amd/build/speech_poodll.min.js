define(["jquery","core/log","filter_poodll/speech_browser","filter_poodll/speech_awstranscriber"],function(a,b,c,d){"use strict";return b.debug("speech_poodll: initialising"),{recognizer:null,clone:function(){return a.extend(!0,{},this)},will_work_ok:function(a){if("streamingtranscriber"in a)switch(a.streamingtranscriber){case"aws":return d.will_work_ok(a);case"browser":return c.will_work_ok(a)}return c.will_work_ok(a)||d.will_work_ok(a)},init:function(a){if("streamingtranscriber"in a)switch(a.streamingtranscriber){case"aws":this.recognizer=d.clone(),this.recognizer.init(a);break;case"browser":this.recognizer=c.clone(),this.recognizer.init(a)}if(!this.recognizer)if(c.will_work_ok(a))this.recognizer=c.clone(),this.recognizer.init(a);else{if(!d.will_work_ok(a))return b.debug("no usable speech recognizer found"),!1;this.recognizer=d.clone(),this.recognizer.init(a)}},set_grammar:function(a){this.recognizer.set_grammar(a)},start:function(a){this.recognizer&&(this.recognizer.onfinalspeechcapture=this.onfinalspeechcapture,this.recognizer.oninterimspeechcapture=this.oninterimspeechcapture,this.recognizer&&this.recognizer.start(a))},stop:function(){this.recognizer&&this.recognizer&&this.recognizer.stop()},onfinalspeechcapture:function(a,c){this.recognizer&&b.debug("final:"+a)},oninterimspeechcapture:function(a){this.recognizer&&b.debug("interim:"+a)}}});