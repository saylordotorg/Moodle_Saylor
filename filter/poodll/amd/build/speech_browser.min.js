define ("filter_poodll/speech_browser",["jquery","core/log"],function(a,b){"use strict";b.debug("speech_browser: initialising");return{recognition:null,recognizing:!1,ignore_onend:!1,final_transcript:"",start_timestamp:0,lang:"en-US",clone:function clone(){return a.extend(!0,{},this)},will_work_ok:function will_work_ok(){return"webkitSpeechRecognition"in window||"SpeechRecognition"in window},init:function init(a){var b=b||webkitSpeechRecognition;this.recognition=new b;this.recognition.continuous=!0;this.recognition.interimResults=!0;this.lang=a.language?a.language:"en-US";this.register_events()},set_grammar:function set_grammar(a){var b=b||webkitSpeechGrammarList;if(b){var c=new b;c.addFromString(a,1);this.recognition.grammars=c}},start:function start(){if(this.recognizing){return}this.recognizing=!0;this.final_transcript="";this.recognition.lang=this.lang;this.recognition.start();this.ignore_onend=!1;this.start_timestamp=Date.now()},stop:function stop(){this.recognizing=!1;this.recognition.stop()},register_events:function register_events(){var a=this.recognition,c=this;a.onstart=function(){c.recognizing=!0};a.onerror=function(a){if("no-speech"==a.error){b.debug("info_no_speech");c.ignore_onend=!0}if("audio-capture"==a.error){b.debug("info_no_microphone");c.ignore_onend=!0}if("not-allowed"==a.error){if(100>a.timeStamp-c.start_timestamp){b.debug("info_blocked")}else{b.debug("info_denied")}c.ignore_onend=!0}};a.onend=function(){if(!1==c.recognizing){return}if(c.ignore_onend){c.recognizing=!1}else{a.start()}};a.onresult=function(a){for(var b="",d=a.resultIndex;d<a.results.length;++d){if(a.results[d].isFinal){c.final_transcript+=a.results[d][0].transcript;c.onfinalspeechcapture(c.final_transcript,JSON.stringify(a.results));c.final_transcript=""}else{b+=a.results[d][0].transcript;c.oninterimspeechcapture(b)}}}},onfinalspeechcapture:function onfinalspeechcapture(a){b.debug(a)},oninterimspeechcapture:function oninterimspeechcapture(){}}});
//# sourceMappingURL=speech_browser.min.js.map
