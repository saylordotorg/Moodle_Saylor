define(["jquery","core/log","filter_poodll/dlg_poodll","filter_poodll/utils_amd"],(function($,log,dialog,utils){return log.debug("download dialog: initialising"),{dlg:null,instanceprops:null,pmr:null,dlgbox:null,init:function(pmr,instanceprops){this.dlg=dialog.clone(),this.dlg.setHeader("Download"),this.instanceprops=instanceprops,this.pmr=pmr},clone:function(){return $.extend(!0,{},this)},fetch_blob_url:function(){var concatenatedBlob=utils.simpleConcatenateBlobs(this.instanceprops.blobs,this.instanceprops.blobs[0].type);return URL.createObjectURL(concatenatedBlob)},fetch_dialogue_box:function(){return this.dlg.fetch_dialogue_box("download")},set_dialogue_box:function(dlgbox){this.dlgbox=dlgbox,this.dlg.set_dialogue_box(dlgbox)},open:function(){var self=this,ip=this.instanceprops,ext="",nowdatetime=(new Date).toISOString().replace(/[^0-9]/g,""),filename=ip.config.mediatype+"_"+nowdatetime;utils.doConcatenateBlobs(this.instanceprops.blobs,(function(concatenatedBlob){switch(concatenatedBlob.type){case"audio/wav":case"audio/pcm":ext=".wav";break;case"audio/ogg":ext=".ogg";break;case"audio/webm":case"video/webm":ext=".webm";break;default:var bits=concatenatedBlob.type.split("/");bits.length>1&&(ext="."+bits[1])}filename+=ext;var theurl=URL.createObjectURL(concatenatedBlob),displaytext=M.util.get_string("recui_downloadfile","filter_poodll"),content='<div class="filter_poodll_dlgdownload_content">';content+='<a href="'+theurl+'" download="'+filename+'" class="btn btn-secondary">'+displaytext+"</a>",content+="</div>",self.dlg.setContent(content),self.registerEvents(),self.dlg.open()}))},registerEvents:function(){}}}));

//# sourceMappingURL=dlg_download.min.js.map