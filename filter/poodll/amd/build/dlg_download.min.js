define(["jquery","core/log","filter_poodll/dlg_poodll","filter_poodll/utils_amd"],function(a,b,c,d){return b.debug("download dialog: initialising"),{dlg:null,instanceprops:null,pmr:null,dlgbox:null,init:function(a,b){this.dlg=c.clone(),this.dlg.setHeader("Download"),this.instanceprops=b,this.pmr=a},clone:function(){return a.extend(!0,{},this)},fetch_blob_url:function(){var a=d.simpleConcatenateBlobs(this.instanceprops.blobs,this.instanceprops.blobs[0].type),b=URL.createObjectURL(a);return b},fetch_dialogue_box:function(){return this.dlg.fetch_dialogue_box("download")},set_dialogue_box:function(a){this.dlgbox=a,this.dlg.set_dialogue_box(a)},open:function(){var a=this,b=this.instanceprops,c="",e=(new Date).toISOString().replace(/[^0-9]/g,""),f=b.config.mediatype+"_"+e;d.doConcatenateBlobs(this.instanceprops.blobs,function(b){switch(b.type){case"audio/wav":case"audio/pcm":c=".wav";break;case"audio/ogg":c=".ogg";break;case"audio/webm":case"video/webm":c=".webm";break;default:var d=b.type.split("/");d.length>1&&(c="."+d[1])}f+=c;var e=URL.createObjectURL(b),g=M.util.get_string("recui_downloadfile","filter_poodll"),h='<div class="filter_poodll_dlgdownload_content">';h+='<a href="'+e+'" download="'+f+'" class="btn btn-secondary">'+g+"</a>",h+="</div>",a.dlg.setContent(h),a.registerEvents(),a.dlg.open()})},registerEvents:function(){}}});