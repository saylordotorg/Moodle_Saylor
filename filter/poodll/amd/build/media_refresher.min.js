define ("filter_poodll/media_refresher",["jquery","core/log"],function(a,b){"use strict";b.debug("Media refresher: initialising");return{placeholderduration:null,mediaduration:null,alertconverted:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,c,d){this.placeholderduration=b;this.mediaduration=c;this.alertconverted=d;this.check_updates(a,"firstpass")},should_be_checked:function should_be_checked(c){b.debug("mediaduration: "+this.mediaduration);b.debug("placeholderduration: "+this.placeholderduration);b.debug("fixed to one mediaduration: "+parseFloat(this.mediaduration).toFixed(1));b.debug("fixed to one placeholderduration: "+parseFloat(this.placeholderduration).toFixed(1));if(!a.isNumeric(this.placeholderduration)){return!1}if(!a.isNumeric(this.mediaduration)){return!1}if(parseFloat(this.mediaduration).toFixed(1)!=parseFloat(this.placeholderduration).toFixed(1)){return!1}if(""==c){return!1}return!0},check_updates:function check_updates(a,c){this.should_be_checked(a);if("firstpass"==c&&!this.should_be_checked(a)){return}var d=new XMLHttpRequest,e=this;d.onreadystatechange=function(){if(4===this.readyState){if(200==d.status){var f=d.responseText,g=JSON.parse(f);if(g){switch(g.code){case"mediaready":e.alertconverted();break;case"stillwaiting":setTimeout(function(){e.check_updates(a,"secondpass")},15e3);break;case"notask":if("secondpass"==c){e.alertconverted()}break;case"notloggedin":default:}}}else{b.debug("Not 200 response:"+d.status)}}};d.open("POST",M.cfg.wwwroot+"/filter/poodll/ajaxmediaquery.php",!0);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.setRequestHeader("Cache-Control","no-cache");d.send("filename="+a)}}});
//# sourceMappingURL=media_refresher.min.js.map
