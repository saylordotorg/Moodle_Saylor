function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}!function(e){var t;function a(){var e=Error.apply(this,arguments);e.name=this.name="FlashError",this.stack=e.stack,this.message=e.message}function s(){var e=Error.apply(this,arguments);e.name=this.name="WebcamError",this.stack=e.stack,this.message=e.message}IntermediateInheritor=function(){},IntermediateInheritor.prototype=Error.prototype,a.prototype=new IntermediateInheritor,s.prototype=new IntermediateInheritor;var Webcam={version:"1.0.15",protocol:location.protocol.match(/https/i)?"https":"http",loaded:!1,live:!1,userMedia:!0,params:{width:0,height:0,dest_width:0,dest_height:0,image_format:"jpeg",jpeg_quality:90,enable_flash:!0,force_flash:!1,flip_horiz:!1,fps:30,upload_name:"webcam",constraints:null,swfURL:"",flashNotDetectedText:"ERROR: No Adobe Flash Player detected.  Webcam.js relies on Flash for browsers that do not support getUserMedia (like yours).",noInterfaceFoundText:"No supported webcam interface found.",unfreeze_snap:!0},errors:{FlashError:a,WebcamError:s},hooks:{},init:function(){var t=this;this.mediaDevices=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices:navigator.mozGetUserMedia||navigator.webkitGetUserMedia?{getUserMedia:function(e){return new Promise((function(t,a){(navigator.mozGetUserMedia||navigator.webkitGetUserMedia).call(navigator,e,t,a)}))}}:null,e.URL=e.URL||e.webkitURL||e.mozURL||e.msURL,this.userMedia=this.userMedia&&!!this.mediaDevices&&!!e.URL,navigator.userAgent.match(/Firefox\D+(\d+)/)&&parseInt(RegExp.$1,10)<21&&(this.userMedia=null),this.userMedia&&e.addEventListener("beforeunload",(function(e){t.reset()}))},attach:function(a){if("string"==typeof a&&(a=document.getElementById(a)||document.querySelector(a)),!a)return this.dispatch("error",new s("Could not locate DOM element to attach to."));this.container=a,a.innerHTML="";var i=document.createElement("div");if(a.appendChild(i),this.peg=i,this.params.width||(this.params.width=a.offsetWidth),this.params.height||(this.params.height=a.offsetHeight),!this.params.width||!this.params.height)return this.dispatch("error",new s("No width and/or height for webcam.  Please call set() first, or attach to a visible element."));this.params.dest_width||(this.params.dest_width=this.params.width),this.params.dest_height||(this.params.dest_height=this.params.height),this.userMedia=void 0===t?this.userMedia:t,this.params.force_flash&&(t=this.userMedia,this.userMedia=null),"number"!=typeof this.params.fps&&(this.params.fps=30);var r=this.params.width/this.params.dest_width,o=this.params.height/this.params.dest_height;if(this.userMedia){var n=document.createElement("video");n.setAttribute("autoplay","autoplay"),n.style.width=this.params.dest_width+"px",n.style.height=this.params.dest_height+"px",1==r&&1==o||(a.style.overflow="hidden",n.style.webkitTransformOrigin="0px 0px",n.style.mozTransformOrigin="0px 0px",n.style.msTransformOrigin="0px 0px",n.style.oTransformOrigin="0px 0px",n.style.transformOrigin="0px 0px",n.style.webkitTransform="scaleX("+r+") scaleY("+o+")",n.style.mozTransform="scaleX("+r+") scaleY("+o+")",n.style.msTransform="scaleX("+r+") scaleY("+o+")",n.style.oTransform="scaleX("+r+") scaleY("+o+")",n.style.transform="scaleX("+r+") scaleY("+o+")"),a.appendChild(n),this.video=n;var h=this;this.mediaDevices.getUserMedia({audio:!1,video:this.params.constraints||{mandatory:{minWidth:this.params.dest_width,minHeight:this.params.dest_height}}}).then((function(t){n.onloadedmetadata=function(e){h.stream=t,h.loaded=!0,h.live=!0,h.dispatch("load"),h.dispatch("live"),h.flip()},n.srcObject=t||t})).catch((function(e){h.params.enable_flash&&h.detectFlash()?setTimeout((function(){h.params.force_flash=1,h.attach(a)}),1):h.dispatch("error",e)}))}else if(this.params.enable_flash&&this.detectFlash()){e.Webcam=Webcam;var l=document.createElement("div");l.innerHTML=this.getSWFHTML(),a.appendChild(l)}else this.dispatch("error",new s(this.params.noInterfaceFoundText));if(this.params.crop_width&&this.params.crop_height){var c=Math.floor(this.params.crop_width*r),m=Math.floor(this.params.crop_height*o);a.style.width=c+"px",a.style.height=m+"px",a.style.overflow="hidden",a.scrollLeft=Math.floor(this.params.width/2-c/2),a.scrollTop=Math.floor(this.params.height/2-m/2)}else a.style.width=this.params.width+"px",a.style.height=this.params.height+"px"},reset:function(){if(this.preview_active&&this.unfreeze(),this.unflip(),this.userMedia){if(this.stream)if(this.stream.getVideoTracks){var e=this.stream.getVideoTracks();e&&e[0]&&e[0].stop&&e[0].stop()}else this.stream.stop&&this.stream.stop();delete this.stream,delete this.video}!0!==this.userMedia&&this.getMovie()._releaseCamera(),this.container&&(this.container.innerHTML="",delete this.container),this.loaded=!1,this.live=!1},set:function(){if(1==arguments.length)for(var e in arguments[0])this.params[e]=arguments[0][e];else this.params[arguments[0]]=arguments[1]},on:function(e,t){e=e.replace(/^on/i,"").toLowerCase(),this.hooks[e]||(this.hooks[e]=[]),this.hooks[e].push(t)},off:function(e,t){if(e=e.replace(/^on/i,"").toLowerCase(),this.hooks[e])if(t){var a=this.hooks[e].indexOf(t);a>-1&&this.hooks[e].splice(a,1)}else this.hooks[e]=[]},dispatch:function(){var t=arguments[0].replace(/^on/i,"").toLowerCase(),i=Array.prototype.slice.call(arguments,1);if(this.hooks[t]&&this.hooks[t].length){for(var r=0,o=this.hooks[t].length;r<o;r++){var n=this.hooks[t][r];"function"==typeof n?n.apply(this,i):"object"==_typeof(n)&&2==n.length?n[0][n[1]].apply(n[0],i):e[n]&&e[n].apply(e,i)}return!0}return"error"==t&&(i[0]instanceof a||i[0]instanceof s?message=i[0].message:message="Could not access webcam: "+i[0].name+": "+i[0].message+" "+i[0].toString(),alert("Webcam.js Error: "+message)),!1},setSWFLocation:function(e){this.set("swfURL",e)},detectFlash:function(){var t="Shockwave Flash",s="application/x-shockwave-flash",i=e,r=navigator,o=!1;if(void 0!==r.plugins&&"object"===_typeof(r.plugins[t]))r.plugins[t].description&&void 0!==r.mimeTypes&&r.mimeTypes[s]&&r.mimeTypes[s].enabledPlugin&&(o=!0);else if(void 0!==i.ActiveXObject)try{var h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(h)h.GetVariable("$version")&&(o=!0)}catch(c){}return o},getSWFHTML:function(){var t="",s=this.params.swfURL;if(location.protocol.match(/file/))return this.dispatch("error",new a("Flash does not work from local disk.  Please run from a web server.")),'<h3 style="color:red">ERROR: the Webcam.js Flash fallback does not work from local disk.  Please run it from a web server.</h3>';if(!this.detectFlash())return this.dispatch("error",new a("Adobe Flash Player not found.  Please install from get.adobe.com/flashplayer and try again.")),'<h3 style="color:red">'+this.params.flashNotDetectedText+"</h3>";if(!s){for(var i="",r=document.getElementsByTagName("script"),o=0,n=r.length;o<n;o++){var h=r[o].getAttribute("src");h&&h.match(/\/webcam(\.min)?\.js/)&&(i=h.replace(/\/webcam(\.min)?\.js.*$/,""),o=n)}s=i?i+"/webcam.swf":"webcam.swf"}e.localStorage&&!localStorage.getItem("visited")&&(this.params.new_user=1,localStorage.setItem("visited",1));var l="";for(var c in this.params)l&&(l+="&"),l+=c+"="+escape(this.params[c]);return t+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" type="application/x-shockwave-flash" codebase="'+this.protocol+'://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+this.params.width+'" height="'+this.params.height+'" id="webcam_movie_obj" align="middle"><param name="wmode" value="opaque" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+s+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+l+'"/><embed id="webcam_movie_embed" src="'+s+'" wmode="opaque" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+this.params.width+'" height="'+this.params.height+'" name="webcam_movie_embed" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+l+'"></embed></object>'},getMovie:function(){if(!this.loaded)return this.dispatch("error",new a("Flash Movie is not loaded yet"));var e=document.getElementById("webcam_movie_obj");return e&&e._snap||(e=document.getElementById("webcam_movie_embed")),e||this.dispatch("error",new a("Cannot locate Flash movie in DOM")),e},freeze:function(){var e=this,t=this.params;this.preview_active&&this.unfreeze();var a=this.params.width/this.params.dest_width,s=this.params.height/this.params.dest_height;this.unflip();var i=t.crop_width||t.dest_width,r=t.crop_height||t.dest_height,o=document.createElement("canvas");o.width=i,o.height=r;var n=o.getContext("2d");this.preview_canvas=o,this.preview_context=n,1==a&&1==s||(o.style.webkitTransformOrigin="0px 0px",o.style.mozTransformOrigin="0px 0px",o.style.msTransformOrigin="0px 0px",o.style.oTransformOrigin="0px 0px",o.style.transformOrigin="0px 0px",o.style.webkitTransform="scaleX("+a+") scaleY("+s+")",o.style.mozTransform="scaleX("+a+") scaleY("+s+")",o.style.msTransform="scaleX("+a+") scaleY("+s+")",o.style.oTransform="scaleX("+a+") scaleY("+s+")",o.style.transform="scaleX("+a+") scaleY("+s+")"),this.snap((function(){o.style.position="relative",o.style.left=e.container.scrollLeft+"px",o.style.top=e.container.scrollTop+"px",e.container.insertBefore(o,e.peg),e.container.style.overflow="hidden",e.preview_active=!0}),o)},unfreeze:function(){this.preview_active&&(this.container.removeChild(this.preview_canvas),delete this.preview_context,delete this.preview_canvas,this.preview_active=!1,this.flip())},flip:function(){if(this.params.flip_horiz){var e=this.container.style;e.webkitTransform="scaleX(-1)",e.mozTransform="scaleX(-1)",e.msTransform="scaleX(-1)",e.oTransform="scaleX(-1)",e.transform="scaleX(-1)",e.filter="FlipH",e.msFilter="FlipH"}},unflip:function(){if(this.params.flip_horiz){var e=this.container.style;e.webkitTransform="scaleX(1)",e.mozTransform="scaleX(1)",e.msTransform="scaleX(1)",e.oTransform="scaleX(1)",e.transform="scaleX(1)",e.filter="",e.msFilter=""}},savePreview:function(e,t){var a=this.params,s=this.preview_canvas,i=this.preview_context;t&&t.getContext("2d").drawImage(s,0,0);e(t?null:s.toDataURL("image/"+a.image_format,a.jpeg_quality/100),s,i),this.params.unfreeze_snap&&this.unfreeze()},snap:function(e,t){var i=this.params;if(!this.loaded)return this.dispatch("error",new s("Webcam is not loaded yet"));if(!e)return this.dispatch("error",new s("Please provide a callback function or canvas to snap()"));if(this.preview_active)return this.savePreview(e,t),null;var r=document.createElement("canvas");r.width=this.params.dest_width,r.height=this.params.dest_height;var o=r.getContext("2d");this.params.flip_horiz&&(o.translate(i.dest_width,0),o.scale(-1,1));var n=function(){if(this.src&&this.width&&this.height&&o.drawImage(this,0,0,i.dest_width,i.dest_height),i.crop_width&&i.crop_height){var a=document.createElement("canvas");a.width=i.crop_width,a.height=i.crop_height;var s=a.getContext("2d");s.drawImage(r,Math.floor(i.dest_width/2-i.crop_width/2),Math.floor(i.dest_height/2-i.crop_height/2),i.crop_width,i.crop_height,0,0,i.crop_width,i.crop_height),o=s,r=a}if(t){var n=t.getContext("2d");n.drawImage(r,0,0)}e(t?null:r.toDataURL("image/"+i.image_format,i.jpeg_quality/100),r,o)};if(this.userMedia)o.drawImage(this.video,0,0,this.params.dest_width,this.params.dest_height),n();else{var h=this.getMovie()._snap(),l=new Image;l.onload=n,l.src="data:image/"+this.params.image_format+";base64,"+h}return null},configure:function(e){e||(e="camera"),this.getMovie()._configure(e)},flashNotify:function(e,t){switch(e){case"flashLoadComplete":this.loaded=!0,this.dispatch("load");break;case"cameraLive":this.live=!0,this.dispatch("live");break;case"error":this.dispatch("error",new a(t))}},b64ToUint6:function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},base64DecToArr:function(e,t){for(var o,n,a=e.replace(/[^A-Za-z0-9\+\/]/g,""),s=a.length,i=t?Math.ceil((3*s+1>>2)/t)*t:3*s+1>>2,r=new Uint8Array(i),h=0,l=0,c=0;c<s;c++)if(n=3&c,h|=this.b64ToUint6(a.charCodeAt(c))<<18-6*n,3===n||s-c==1){for(o=0;o<3&&l<i;o++,l++)r[l]=h>>>(16>>>o&24)&255;h=0}return r},upload:function(e,t,a){var s=this.params.upload_name||"webcam",i="";if(!e.match(/^data\:image\/(\w+)/))throw"Cannot locate image format in Data URI";i=RegExp.$1;var r=e.replace(/^data\:image\/\w+\;base64\,/,""),o=new XMLHttpRequest;o.open("POST",t,!0),o.upload&&o.upload.addEventListener&&o.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=e.loaded/e.total;Webcam.dispatch("uploadProgress",t,e)}}),!1);var n=this;o.onload=function(){a&&a.apply(n,[o.status,o.responseText,o.statusText]),Webcam.dispatch("uploadComplete",o.status,o.responseText,o.statusText)};var h=new Blob([this.base64DecToArr(r)],{type:"image/"+i}),l=new FormData;l.append(s,h,s+"."+i.replace(/e/,"")),o.send(l)}};Webcam.init(),"function"==typeof define&&define.amd?define("filter_poodll/webcam",(function(){return Webcam})):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=Webcam:e.Webcam=Webcam}(window);

//# sourceMappingURL=webcam.min.js.map