function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(b){var e;function c(){var a=Error.apply(this,arguments);a.name=this.name="FlashError";this.stack=a.stack;this.message=a.message}function d(){var a=Error.apply(this,arguments);a.name=this.name="WebcamError";this.stack=a.stack;this.message=a.message}IntermediateInheritor=function IntermediateInheritor(){};IntermediateInheritor.prototype=Error.prototype;c.prototype=new IntermediateInheritor;d.prototype=new IntermediateInheritor;var f={version:"1.0.15",protocol:location.protocol.match(/https/i)?"https":"http",loaded:!1,live:!1,userMedia:!0,params:{width:0,height:0,dest_width:0,dest_height:0,image_format:"jpeg",jpeg_quality:90,enable_flash:!0,force_flash:!1,flip_horiz:!1,fps:30,upload_name:"webcam",constraints:null,swfURL:"",flashNotDetectedText:"ERROR: No Adobe Flash Player detected.  Webcam.js relies on Flash for browsers that do not support getUserMedia (like yours).",noInterfaceFoundText:"No supported webcam interface found.",unfreeze_snap:!0},errors:{FlashError:c,WebcamError:d},hooks:{},init:function init(){var a=this;this.mediaDevices=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices:navigator.mozGetUserMedia||navigator.webkitGetUserMedia?{getUserMedia:function getUserMedia(b){return new Promise(function(c,d){(navigator.mozGetUserMedia||navigator.webkitGetUserMedia).call(navigator,b,c,d)})}}:null;b.URL=b.URL||b.webkitURL||b.mozURL||b.msURL;this.userMedia=this.userMedia&&!!this.mediaDevices&&!!b.URL;if(navigator.userAgent.match(/Firefox\D+(\d+)/)){if(21>parseInt(RegExp.$1,10))this.userMedia=null}if(this.userMedia){b.addEventListener("beforeunload",function(){a.reset()})}},attach:function attach(g){if("string"==typeof g){g=document.getElementById(g)||document.querySelector(g)}if(!g){return this.dispatch("error",new d("Could not locate DOM element to attach to."))}this.container=g;g.innerHTML="";var j=document.createElement("div");g.appendChild(j);this.peg=j;if(!this.params.width)this.params.width=g.offsetWidth;if(!this.params.height)this.params.height=g.offsetHeight;if(!this.params.width||!this.params.height){return this.dispatch("error",new d("No width and/or height for webcam.  Please call set() first, or attach to a visible element."))}if(!this.params.dest_width)this.params.dest_width=this.params.width;if(!this.params.dest_height)this.params.dest_height=this.params.height;this.userMedia=e===void 0?this.userMedia:e;if(this.params.force_flash){e=this.userMedia;this.userMedia=null}if("number"!=typeof this.params.fps)this.params.fps=30;var i=this.params.width/this.params.dest_width,k=this.params.height/this.params.dest_height;if(this.userMedia){var o=document.createElement("video");o.setAttribute("autoplay","autoplay");o.style.width=""+this.params.dest_width+"px";o.style.height=""+this.params.dest_height+"px";if(1!=i||1!=k){g.style.overflow="hidden";o.style.webkitTransformOrigin="0px 0px";o.style.mozTransformOrigin="0px 0px";o.style.msTransformOrigin="0px 0px";o.style.oTransformOrigin="0px 0px";o.style.transformOrigin="0px 0px";o.style.webkitTransform="scaleX("+i+") scaleY("+k+")";o.style.mozTransform="scaleX("+i+") scaleY("+k+")";o.style.msTransform="scaleX("+i+") scaleY("+k+")";o.style.oTransform="scaleX("+i+") scaleY("+k+")";o.style.transform="scaleX("+i+") scaleY("+k+")"}g.appendChild(o);this.video=o;var n=this;this.mediaDevices.getUserMedia({audio:!1,video:this.params.constraints||{mandatory:{minWidth:this.params.dest_width,minHeight:this.params.dest_height}}}).then(function(a){o.onloadedmetadata=function(){n.stream=a;n.loaded=!0;n.live=!0;n.dispatch("load");n.dispatch("live");n.flip()};o.srcObject=a||a}).catch(function(a){if(n.params.enable_flash&&n.detectFlash()){setTimeout(function(){n.params.force_flash=1;n.attach(g)},1)}else{n.dispatch("error",a)}})}else if(this.params.enable_flash&&this.detectFlash()){b.Webcam=f;var h=document.createElement("div");h.innerHTML=this.getSWFHTML();g.appendChild(h)}else{this.dispatch("error",new d(this.params.noInterfaceFoundText))}if(this.params.crop_width&&this.params.crop_height){var l=Math.floor(this.params.crop_width*i),c=Math.floor(this.params.crop_height*k);g.style.width=""+l+"px";g.style.height=""+c+"px";g.style.overflow="hidden";g.scrollLeft=Math.floor(this.params.width/2-l/2);g.scrollTop=Math.floor(this.params.height/2-c/2)}else{g.style.width=""+this.params.width+"px";g.style.height=""+this.params.height+"px"}},reset:function reset(){if(this.preview_active)this.unfreeze();this.unflip();if(this.userMedia){if(this.stream){if(this.stream.getVideoTracks){var a=this.stream.getVideoTracks();if(a&&a[0]&&a[0].stop)a[0].stop()}else if(this.stream.stop){this.stream.stop()}}delete this.stream;delete this.video}if(!0!==this.userMedia){this.getMovie()._releaseCamera()}if(this.container){this.container.innerHTML="";delete this.container}this.loaded=!1;this.live=!1},set:function set(){if(1==arguments.length){for(var a in arguments[0]){this.params[a]=arguments[0][a]}}else{this.params[arguments[0]]=arguments[1]}},on:function on(a,b){a=a.replace(/^on/i,"").toLowerCase();if(!this.hooks[a])this.hooks[a]=[];this.hooks[a].push(b)},off:function off(b,c){b=b.replace(/^on/i,"").toLowerCase();if(this.hooks[b]){if(c){var d=this.hooks[b].indexOf(c);if(-1<d)this.hooks[b].splice(d,1)}else{this.hooks[b]=[]}}},dispatch:function dispatch(){var a=arguments[0].replace(/^on/i,"").toLowerCase(),e=Array.prototype.slice.call(arguments,1);if(this.hooks[a]&&this.hooks[a].length){for(var f=0,g=this.hooks[a].length,h;f<g;f++){h=this.hooks[a][f];if("function"==typeof h){h.apply(this,e)}else if("object"==_typeof(h)&&2==h.length){h[0][h[1]].apply(h[0],e)}else if(b[h]){b[h].apply(b,e)}}return!0}else if("error"==a){if(e[0]instanceof c||e[0]instanceof d){message=e[0].message}else{message="Could not access webcam: "+e[0].name+": "+e[0].message+" "+e[0].toString()}alert("Webcam.js Error: "+message)}return!1},setSWFLocation:function setSWFLocation(a){this.set("swfURL",a)},detectFlash:function detectFlash(){var a=b,c=navigator,d=!1;if("undefined"!=typeof c.plugins&&"object"===_typeof(c.plugins["Shockwave Flash"])){var e=c.plugins["Shockwave Flash"].description;if(e&&"undefined"!=typeof c.mimeTypes&&c.mimeTypes["application/x-shockwave-flash"]&&c.mimeTypes["application/x-shockwave-flash"].enabledPlugin){d=!0}}else if("undefined"!=typeof a.ActiveXObject){try{var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(f){var g=f.GetVariable("$version");if(g)d=!0}}catch(a){}}return d},getSWFHTML:function getSWFHTML(){var a="",d=this.params.swfURL;if(location.protocol.match(/file/)){this.dispatch("error",new c("Flash does not work from local disk.  Please run from a web server."));return"<h3 style=\"color:red\">ERROR: the Webcam.js Flash fallback does not work from local disk.  Please run it from a web server.</h3>"}if(!this.detectFlash()){this.dispatch("error",new c("Adobe Flash Player not found.  Please install from get.adobe.com/flashplayer and try again."));return"<h3 style=\"color:red\">"+this.params.flashNotDetectedText+"</h3>"}if(!d){for(var e="",f=document.getElementsByTagName("script"),g=0,j=f.length,k;g<j;g++){k=f[g].getAttribute("src");if(k&&k.match(/\/webcam(\.min)?\.js/)){e=k.replace(/\/webcam(\.min)?\.js.*$/,"");g=j}}if(e)d=e+"/webcam.swf";else d="webcam.swf"}if(b.localStorage&&!localStorage.getItem("visited")){this.params.new_user=1;localStorage.setItem("visited",1)}var m="";for(var n in this.params){if(m)m+="&";m+=n+"="+escape(this.params[n])}a+="<object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" type=\"application/x-shockwave-flash\" codebase=\""+this.protocol+"://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0\" width=\""+this.params.width+"\" height=\""+this.params.height+"\" id=\"webcam_movie_obj\" align=\"middle\"><param name=\"wmode\" value=\"opaque\" /><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"false\" /><param name=\"movie\" value=\""+d+"\" /><param name=\"loop\" value=\"false\" /><param name=\"menu\" value=\"false\" /><param name=\"quality\" value=\"best\" /><param name=\"bgcolor\" value=\"#ffffff\" /><param name=\"flashvars\" value=\""+m+"\"/><embed id=\"webcam_movie_embed\" src=\""+d+"\" wmode=\"opaque\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\""+this.params.width+"\" height=\""+this.params.height+"\" name=\"webcam_movie_embed\" align=\"middle\" allowScriptAccess=\"always\" allowFullScreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\""+m+"\"></embed></object>";return a},getMovie:function getMovie(){if(!this.loaded)return this.dispatch("error",new c("Flash Movie is not loaded yet"));var a=document.getElementById("webcam_movie_obj");if(!a||!a._snap)a=document.getElementById("webcam_movie_embed");if(!a)this.dispatch("error",new c("Cannot locate Flash movie in DOM"));return a},freeze:function freeze(){var b=this,c=this.params;if(this.preview_active)this.unfreeze();var d=this.params.width/this.params.dest_width,a=this.params.height/this.params.dest_height;this.unflip();var e=c.crop_width||c.dest_width,f=c.crop_height||c.dest_height,g=document.createElement("canvas");g.width=e;g.height=f;var h=g.getContext("2d");this.preview_canvas=g;this.preview_context=h;if(1!=d||1!=a){g.style.webkitTransformOrigin="0px 0px";g.style.mozTransformOrigin="0px 0px";g.style.msTransformOrigin="0px 0px";g.style.oTransformOrigin="0px 0px";g.style.transformOrigin="0px 0px";g.style.webkitTransform="scaleX("+d+") scaleY("+a+")";g.style.mozTransform="scaleX("+d+") scaleY("+a+")";g.style.msTransform="scaleX("+d+") scaleY("+a+")";g.style.oTransform="scaleX("+d+") scaleY("+a+")";g.style.transform="scaleX("+d+") scaleY("+a+")"}this.snap(function(){g.style.position="relative";g.style.left=""+b.container.scrollLeft+"px";g.style.top=""+b.container.scrollTop+"px";b.container.insertBefore(g,b.peg);b.container.style.overflow="hidden";b.preview_active=!0},g)},unfreeze:function unfreeze(){if(this.preview_active){this.container.removeChild(this.preview_canvas);delete this.preview_context;delete this.preview_canvas;this.preview_active=!1;this.flip()}},flip:function flip(){if(this.params.flip_horiz){var a=this.container.style;a.webkitTransform="scaleX(-1)";a.mozTransform="scaleX(-1)";a.msTransform="scaleX(-1)";a.oTransform="scaleX(-1)";a.transform="scaleX(-1)";a.filter="FlipH";a.msFilter="FlipH"}},unflip:function unflip(){if(this.params.flip_horiz){var a=this.container.style;a.webkitTransform="scaleX(1)";a.mozTransform="scaleX(1)";a.msTransform="scaleX(1)";a.oTransform="scaleX(1)";a.transform="scaleX(1)";a.filter="";a.msFilter=""}},savePreview:function savePreview(b,c){var d=this.params,a=this.preview_canvas,e=this.preview_context;if(c){var f=c.getContext("2d");f.drawImage(a,0,0)}b(c?null:a.toDataURL("image/"+d.image_format,d.jpeg_quality/100),a,e);if(this.params.unfreeze_snap)this.unfreeze()},snap:function snap(b,c){var e=this,f=this.params;if(!this.loaded)return this.dispatch("error",new d("Webcam is not loaded yet"));if(!b)return this.dispatch("error",new d("Please provide a callback function or canvas to snap()"));if(this.preview_active){this.savePreview(b,c);return null}var g=document.createElement("canvas");g.width=this.params.dest_width;g.height=this.params.dest_height;var i=g.getContext("2d");if(this.params.flip_horiz){i.translate(f.dest_width,0);i.scale(-1,1)}var a=function(){if(this.src&&this.width&&this.height){i.drawImage(this,0,0,f.dest_width,f.dest_height)}if(f.crop_width&&f.crop_height){var d=document.createElement("canvas");d.width=f.crop_width;d.height=f.crop_height;var a=d.getContext("2d");a.drawImage(g,Math.floor(f.dest_width/2-f.crop_width/2),Math.floor(f.dest_height/2-f.crop_height/2),f.crop_width,f.crop_height,0,0,f.crop_width,f.crop_height);i=a;g=d}if(c){var e=c.getContext("2d");e.drawImage(g,0,0)}b(c?null:g.toDataURL("image/"+f.image_format,f.jpeg_quality/100),g,i)};if(this.userMedia){i.drawImage(this.video,0,0,this.params.dest_width,this.params.dest_height);a()}else{var j=this.getMovie()._snap(),h=new Image;h.onload=a;h.src="data:image/"+this.params.image_format+";base64,"+j}return null},configure:function configure(a){if(!a)a="camera";this.getMovie()._configure(a)},flashNotify:function flashNotify(a,b){switch(a){case"flashLoadComplete":this.loaded=!0;this.dispatch("load");break;case"cameraLive":this.live=!0;this.dispatch("live");break;case"error":this.dispatch("error",new c(b));break;default:break;}},b64ToUint6:function b64ToUint6(a){return 64<a&&91>a?a-65:96<a&&123>a?a-71:47<a&&58>a?a+4:43===a?62:47===a?63:0},base64DecToArr:function base64DecToArr(b,d){for(var e=b.replace(/[^A-Za-z0-9\+\/]/g,""),a=e.length,f=d?Math.ceil((3*a+1>>2)/d)*d:3*a+1>>2,g=new Uint8Array(f),i,j,k=0,m=0,p=0;p<a;p++){j=3&p;k|=this.b64ToUint6(e.charCodeAt(p))<<18-6*j;if(3===j||1==a-p){for(i=0;3>i&&m<f;i++,m++){g[m]=255&k>>>(24&16>>>i)}k=0}}return g},upload:function upload(b,c,d){var a=this.params.upload_name||"webcam",e="";if(b.match(/^data\:image\/(\w+)/))e=RegExp.$1;else throw"Cannot locate image format in Data URI";var g=b.replace(/^data\:image\/\w+\;base64\,/,""),j=new XMLHttpRequest;j.open("POST",c,!0);if(j.upload&&j.upload.addEventListener){j.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;f.dispatch("uploadProgress",b,a)}},!1)}var k=this;j.onload=function(){if(d)d.apply(k,[j.status,j.responseText,j.statusText]);f.dispatch("uploadComplete",j.status,j.responseText,j.statusText)};var m=new Blob([this.base64DecToArr(g)],{type:"image/"+e}),h=new FormData;h.append(a,m,a+"."+e.replace(/e/,""));j.send(h)}};f.init();if("function"==typeof define&&define.amd){define ("filter_poodll/webcam",function(){return f})}else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){module.exports=f}else{b.Webcam=f}})(window);
//# sourceMappingURL=webcam.min.js.map
