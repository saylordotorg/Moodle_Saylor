define(["jquery","core/log"],function(a,b){"use strict";return b.debug("Hermes (the messenger) initialising"),{allowedURL:"",id:"",iframeembed:!1,enabled:!1,eventListeners:!1,clone:function(){return a.extend(!0,{},this)},init:function(a,b,c){this.allowedURL=b,this.id=a,this.iframeembed=c,this.enabled=!0,this.eventListeners=new Array,this.registerEvents()},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},on:function(a,b){var c=new Object;c.type=a,c.handler=b,this.eventListeners.push(c)},sendEvent:function(a){for(var b=0;b<this.eventListeners.length;b++)a.type==this.eventListeners[b].type&&this.eventListeners[b].handler(a)},postMessage:function(a){if(this.enabled)return a.hasOwnProperty("type")?void(this.iframeembed&&(a.id=this.id,window.parent.postMessage(a,this.allowedURL))):void b.debug('All message objects must have at least the "type" property')},registerEvents:function(){var a=this;window.addEventListener("message",function(b){if(null!=a.allowedURL&&0===a.allowedURL.indexOf(b.origin)){var c=b.data;c&&c.hasOwnProperty("id")&&c.id==a.id&&c.hasOwnProperty("type")&&a.sendEvent(b.data)}})}}});