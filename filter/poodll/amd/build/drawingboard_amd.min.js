define ("filter_poodll/drawingboard_amd",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/drawingboard"],function(a,b,c,d,e){"use strict";b.debug("Filter PoodLL: drawingboard.js initialising");return{instanceprops:[],loaddrawingboard:function loaddrawingboard(b){var c="#amdopts_"+b.recorderid,f=a(c).get(0);if(f){b=JSON.parse(f.value);if(b.bgimage){var g="transparent"}else{var g="background";b.bgimage="#FFF"}this.config=b;a(c).remove()}var h="#"+b.recorderid+"drawing-board-id",i=new e.Board(b.recorderid+"_drawing-board-id",{recorderid:b.recorderid,size:3,background:b.bgimage,controls:["Color",{Size:{type:"auto"}},{DrawingMode:{filler:!1,eraser:!0,pencil:!0}},"Navigation"],droppable:!0,webStorage:!1,enlargeYourContainer:!0,eraserColor:g});b.db=i;var j=b.vectordata;if(j){if(0!=j.indexOf("{\"shapes\"")&&0!=j.indexOf("{\"colors\"")){i.history=Y.JSON.parse(j);i.setImg(i.history.values[i.history.position-1])}}b.uploader=d.clone();b.uploader.init(h,b);this.instanceprops[b.recorderid]=b;this.registerEvents(b.recorderid)},registerEvents:function registerEvents(b){var d=this.instanceprops[b];if(d.autosave){var e=function(){var a=document.getElementById(b+"_messages");if(a){a.innerHTML="File has not been saved.";var e=document.getElementById(b+"_btn_upload_whiteboard");e.disabled=!1;var f=c.timeouthandles[b];if(f){clearTimeout(f)}c.timeouthandles[b]=setTimeout(function(){c.WhiteboardUploadHandler(b,d.db,d,d.uploader)},d.autosave)}},f=function(){var a=document.getElementById(b+"_messages");if(a){var e=c.timeouthandles[b];if(e){clearTimeout(e)}c.timeouthandles[b]=setTimeout(function(){c.WhiteboardUploadHandler(b,d.db,d,d.uploader)},d.autosave)}};d.db.ev.bind("board:startDrawing",e);d.db.ev.bind("board:stopDrawing",f);d.db.ev.bind("board:reset",f);d.db.ev.bind("historyNavigation",f)}else{var f=function(){var a=document.getElementById(b+"_messages");if(a){a.innerHTML="File has not been saved."}};d.db.ev.bind("board:stopDrawing",f)}var g=a("#"+b+"_btn_upload_whiteboard");if(g){if(d.autosave){g.click(function(){c.WhiteboardUploadHandler(b,d.db,d,d.uploader)})}else{g.click(function(){var a=c.getCvs(b,d.db,d);c.pokeVectorData(b,d.db,d);d.uploader.uploadFile(a.toDataURL(),"image")})}}}}});
//# sourceMappingURL=drawingboard_amd.min.js.map
