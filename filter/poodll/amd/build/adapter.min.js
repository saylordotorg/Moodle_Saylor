!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.adapter=a()}}(function(){return function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,b,c){"use strict";var d=a("./adapter_factory.js"),e=(0,d.adapterFactory)({window:"undefined"==typeof window?void 0:window});b.exports=e},{"./adapter_factory.js":2}],2:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.window,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},d=g.log,e=g.detectBrowser(b),f={browserDetails:e,commonShim:o,extractVersion:g.extractVersion,disableLog:g.disableLog,disableWarnings:g.disableWarnings,sdp:q};switch(e.browser){case"chrome":if(!i||!i.shimPeerConnection||!c.shimChrome)return d("Chrome shim is not included in this adapter release."),f;if(null===e.version)return d("Chrome shim can not determine version, not shimming."),f;d("adapter.js shimming chrome."),f.browserShim=i,o.shimAddIceCandidateNullOrEmpty(b,e),o.shimParameterlessSetLocalDescription(b,e),i.shimGetUserMedia(b,e),i.shimMediaStream(b,e),i.shimPeerConnection(b,e),i.shimOnTrack(b,e),i.shimAddTrackRemoveTrack(b,e),i.shimGetSendersWithDtmf(b,e),i.shimGetStats(b,e),i.shimSenderReceiverGetStats(b,e),i.fixNegotiationNeeded(b,e),o.shimRTCIceCandidate(b,e),o.shimConnectionState(b,e),o.shimMaxMessageSize(b,e),o.shimSendThrowTypeError(b,e),o.removeExtmapAllowMixed(b,e);break;case"firefox":if(!k||!k.shimPeerConnection||!c.shimFirefox)return d("Firefox shim is not included in this adapter release."),f;d("adapter.js shimming firefox."),f.browserShim=k,o.shimAddIceCandidateNullOrEmpty(b,e),o.shimParameterlessSetLocalDescription(b,e),k.shimGetUserMedia(b,e),k.shimPeerConnection(b,e),k.shimOnTrack(b,e),k.shimRemoveStream(b,e),k.shimSenderGetStats(b,e),k.shimReceiverGetStats(b,e),k.shimRTCDataChannel(b,e),k.shimAddTransceiver(b,e),k.shimGetParameters(b,e),k.shimCreateOffer(b,e),k.shimCreateAnswer(b,e),o.shimRTCIceCandidate(b,e),o.shimConnectionState(b,e),o.shimMaxMessageSize(b,e),o.shimSendThrowTypeError(b,e);break;case"safari":if(!m||!c.shimSafari)return d("Safari shim is not included in this adapter release."),f;d("adapter.js shimming safari."),f.browserShim=m,o.shimAddIceCandidateNullOrEmpty(b,e),o.shimParameterlessSetLocalDescription(b,e),m.shimRTCIceServerUrls(b,e),m.shimCreateOfferLegacy(b,e),m.shimCallbacksAPI(b,e),m.shimLocalStreamsAPI(b,e),m.shimRemoteStreamsAPI(b,e),m.shimTrackEventTransceiver(b,e),m.shimGetUserMedia(b,e),m.shimAudioContext(b,e),o.shimRTCIceCandidate(b,e),o.shimMaxMessageSize(b,e),o.shimSendThrowTypeError(b,e),o.removeExtmapAllowMixed(b,e);break;default:d("Unsupported browser!")}return f}Object.defineProperty(c,"__esModule",{value:!0}),c.adapterFactory=e;var f=a("./utils"),g=d(f),h=a("./chrome/chrome_shim"),i=d(h),j=a("./firefox/firefox_shim"),k=d(j),l=a("./safari/safari_shim"),m=d(l),n=a("./common_shim"),o=d(n),p=a("sdp"),q=d(p)},{"./chrome/chrome_shim":3,"./common_shim":6,"./firefox/firefox_shim":7,"./safari/safari_shim":10,"./utils":11,sdp:12}],3:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function f(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function g(a){if("object"!==("undefined"==typeof a?"undefined":o(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)s.wrapPeerConnectionEvent(a,"track",function(a){return a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}}),a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var c=this;return this._ontrackpoly||(this._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(d){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track};var f=new Event("track");f.track=d.track,f.receiver=e,f.transceiver={receiver:e},f.streams=[b.stream],c.dispatchEvent(f)}),b.stream.getTracks().forEach(function(d){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):{track:d};var f=new Event("track");f.track=d,f.receiver=e,f.transceiver={receiver:e},f.streams=[b.stream],c.dispatchEvent(f)})},this.addEventListener("addstream",this._ontrackpoly)),b.apply(this,arguments)}}}function h(a){if("object"===("undefined"==typeof a?"undefined":o(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){return void 0===this._dtmf&&("audio"===b.kind?this._dtmf=a.createDTMFSender(b):this._dtmf=null),this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var e=c.apply(this,arguments);return e||(e=b(this,a),this._senders.push(e)),e};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){d.apply(this,arguments);var b=this._senders.indexOf(a);b!==-1&&this._senders.splice(b,1)}}var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._senders=this._senders||[],e.apply(this,[a]),a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._senders=this._senders||[],f.apply(this,[a]),a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"===("undefined"==typeof a?"undefined":o(a))&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var g=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=g.apply(this,[]);return b.forEach(function(b){return b._pc=a}),b},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function i(a){if(a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var a=this,c=Array.prototype.slice.call(arguments),d=c[0],e=c[1],f=c[2];if(arguments.length>0&&"function"==typeof d)return b.apply(this,arguments);if(0===b.length&&(0===arguments.length||"function"!=typeof d))return b.apply(this,[]);var g=function(a){var b={},c=a.result();return c.forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=a.stat(b)}),b[c.id]=c}),b},h=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};if(arguments.length>=2){var i=function(a){e(h(g(a)))};return b.apply(this,[i,d])}return new Promise(function(c,d){b.apply(a,[function(a){c(h(g(a)))},d])}).then(e,f)}}}function j(a){if("object"===("undefined"==typeof a?"undefined":o(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in a.RTCRtpSender.prototype)){var b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=b.apply(this,[]);return c.forEach(function(b){return b._pc=a}),c});var c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=c.apply(this,arguments);return a._pc=this,a}),a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return s.filterStats(b,a.track,!0)})}}if(!("getStats"in a.RTCRtpReceiver.prototype)){var d=a.RTCPeerConnection.prototype.getReceivers;d&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=d.apply(this,[]);return b.forEach(function(b){return b._pc=a}),b}),s.wrapPeerConnectionEvent(a,"track",function(a){return a.receiver._pc=a.srcElement,a}),a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return s.filterStats(b,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var e=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){var b=arguments[0],c=void 0,d=void 0,f=void 0;return this.getSenders().forEach(function(a){a.track===b&&(c?f=!0:c=a)}),this.getReceivers().forEach(function(a){return a.track===b&&(d?f=!0:d=a),a.track===b}),f||c&&d?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():d?d.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}}}function k(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var d=b.apply(this,arguments);return this._shimmedLocalStreams[c.id]?this._shimmedLocalStreams[c.id].indexOf(d)===-1&&this._shimmedLocalStreams[c.id].push(d):this._shimmedLocalStreams[c.id]=[c,d],d};var c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});if(c)throw new DOMException("Track already exists.","InvalidAccessError")});var d=this.getSenders();c.apply(this,arguments);var e=this.getSenders().filter(function(a){return d.indexOf(a)===-1});this._shimmedLocalStreams[a.id]=[a].concat(e)};var d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],d.apply(this,arguments)};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(function(c){var d=b._shimmedLocalStreams[c].indexOf(a);d!==-1&&b._shimmedLocalStreams[c].splice(d,1),1===b._shimmedLocalStreams[c].length&&delete b._shimmedLocalStreams[c]}),e.apply(this,arguments)}}function l(a,b){function c(a,b){var c=b.sdp;return Object.keys(a._reverseStreams||[]).forEach(function(b){var d=a._reverseStreams[b],e=a._streams[d.id];c=c.replace(new RegExp(e.id,"g"),d.id)}),new RTCSessionDescription({type:b.type,sdp:c})}function d(a,b){var c=b.sdp;return Object.keys(a._reverseStreams||[]).forEach(function(b){var d=a._reverseStreams[b],e=a._streams[d.id];c=c.replace(new RegExp(d.id,"g"),e.id)}),new RTCSessionDescription({type:b.type,sdp:c})}if(a.RTCPeerConnection){if(a.RTCPeerConnection.prototype.addTrack&&b.version>=65)return k(a);var f=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=f.apply(this);return this._reverseStreams=this._reverseStreams||{},b.map(function(b){return a._reverseStreams[b.id]})};var g=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(b){var c=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},b.getTracks().forEach(function(a){var b=c.getSenders().find(function(b){return b.track===a});if(b)throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[b.id]){var d=new a.MediaStream(b.getTracks());this._streams[b.id]=d,this._reverseStreams[d.id]=b,b=d}g.apply(this,[b])};var h=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},h.apply(this,[this._streams[a.id]||a]),delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id],delete this._streams[a.id]},a.RTCPeerConnection.prototype.addTrack=function(b,c){var d=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,1);if(1!==e.length||!e[0].getTracks().find(function(a){return a===b}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var f=this.getSenders().find(function(a){return a.track===b});if(f)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var g=this._streams[c.id];if(g)g.addTrack(b),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))});else{var h=new a.MediaStream([b]);this._streams[c.id]=h,this._reverseStreams[h.id]=c,this.addStream(h)}return this.getSenders().find(function(a){return a.track===b})},["createOffer","createAnswer"].forEach(function(b){var d=a.RTCPeerConnection.prototype[b],f=e({},b,function(){var a=this,b=arguments,e=arguments.length&&"function"==typeof arguments[0];return e?d.apply(this,[function(d){var e=c(a,d);b[0].apply(null,[e])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):d.apply(this,arguments).then(function(b){return c(a,b)})});a.RTCPeerConnection.prototype[b]=f[b]});var i=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=d(this,arguments[0]),i.apply(this,arguments)):i.apply(this,arguments)};var j=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=j.get.apply(this);return""===a.type?a:c(this,a)}}),a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var c=a._pc===this;if(!c)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var d=void 0;Object.keys(this._streams).forEach(function(c){var e=b._streams[c].getTracks().find(function(b){return a.track===b});e&&(d=b._streams[c])}),d&&(1===d.getTracks().length?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}}function m(a,b){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),a.RTCPeerConnection&&b.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b],d=e({},b,function(){return arguments[0]=new("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)});a.RTCPeerConnection.prototype[b]=d[b]})}function n(a,b){s.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){var c=a.target;if(!(b.version<72||c.getConfiguration&&"plan-b"===c.getConfiguration().sdpSemantics)||"stable"===c.signalingState)return a})}Object.defineProperty(c,"__esModule",{value:!0}),c.shimGetDisplayMedia=c.shimGetUserMedia=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},p=a("./getusermedia");Object.defineProperty(c,"shimGetUserMedia",{enumerable:!0,get:function(){return p.shimGetUserMedia}});var q=a("./getdisplaymedia");Object.defineProperty(c,"shimGetDisplayMedia",{enumerable:!0,get:function(){return q.shimGetDisplayMedia}}),c.shimMediaStream=f,c.shimOnTrack=g,c.shimGetSendersWithDtmf=h,c.shimGetStats=i,c.shimSenderReceiverGetStats=j,c.shimAddTrackRemoveTrackWithNative=k,c.shimAddTrackRemoveTrack=l,c.shimPeerConnection=m,c.fixNegotiationNeeded=n;var r=a("../utils.js"),s=d(r)},{"../utils.js":11,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(a,b,c){"use strict";function d(a,b){if(!(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)&&a.navigator.mediaDevices)return"function"!=typeof b?void console.error("shimGetDisplayMedia: getSourceId argument is not a function"):void(a.navigator.mediaDevices.getDisplayMedia=function(c){return b(c).then(function(b){var d=c.video&&c.video.width,e=c.video&&c.video.height,f=c.video&&c.video.frameRate;return c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b,maxFrameRate:f||3}},d&&(c.video.mandatory.maxWidth=d),e&&(c.video.mandatory.maxHeight=e),a.navigator.mediaDevices.getUserMedia(c)})})}Object.defineProperty(c,"__esModule",{value:!0}),c.shimGetDisplayMedia=d},{}],5:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){var c=a&&a.navigator;if(c.mediaDevices){var d=function(a){if("object"!==("undefined"==typeof a?"undefined":f(a))||a.mandatory||a.optional)return a;var b={};return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d="object"===f(a[c])?a[c]:{ideal:a[c]};void 0!==d.exact&&"number"==typeof d.exact&&(d.min=d.max=d.exact);var e=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==d.ideal){b.optional=b.optional||[];var g={};"number"==typeof d.ideal?(g[e("min",c)]=d.ideal,b.optional.push(g),g={},g[e("max",c)]=d.ideal,b.optional.push(g)):(g[e("",c)]=d.ideal,b.optional.push(g))}void 0!==d.exact&&"number"!=typeof d.exact?(b.mandatory=b.mandatory||{},b.mandatory[e("",c)]=d.exact):["min","max"].forEach(function(a){void 0!==d[a]&&(b.mandatory=b.mandatory||{},b.mandatory[e(a,c)]=d[a])})}}),a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced)),b},e=function(a,e){if(b.version>=61)return e(a);if(a=JSON.parse(JSON.stringify(a)),a&&"object"===f(a.audio)){var g=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};a=JSON.parse(JSON.stringify(a)),g(a.audio,"autoGainControl","googAutoGainControl"),g(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=d(a.audio)}if(a&&"object"===f(a.video)){var h=a.video.facingMode;h=h&&("object"===("undefined"==typeof h?"undefined":f(h))?h:{ideal:h});var j=b.version<66;if(h&&("user"===h.exact||"environment"===h.exact||"user"===h.ideal||"environment"===h.ideal)&&(!c.mediaDevices.getSupportedConstraints||!c.mediaDevices.getSupportedConstraints().facingMode||j)){delete a.video.facingMode;var k=void 0;if("environment"===h.exact||"environment"===h.ideal?k=["back","rear"]:"user"!==h.exact&&"user"!==h.ideal||(k=["front"]),k)return c.mediaDevices.enumerateDevices().then(function(b){b=b.filter(function(a){return"videoinput"===a.kind});var c=b.find(function(a){return k.some(function(b){return a.label.toLowerCase().includes(b)})});return!c&&b.length&&k.includes("back")&&(c=b[b.length-1]),c&&(a.video.deviceId=h.exact?{exact:c.deviceId}:{ideal:c.deviceId}),a.video=d(a.video),i("chrome: "+JSON.stringify(a)),e(a)})}a.video=d(a.video)}return i("chrome: "+JSON.stringify(a)),e(a)},g=function(a){return b.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},h=function(a,b,d){e(a,function(a){c.webkitGetUserMedia(a,b,function(a){d&&d(g(a))})})};if(c.getUserMedia=h.bind(c),c.mediaDevices.getUserMedia){var j=c.mediaDevices.getUserMedia.bind(c.mediaDevices);c.mediaDevices.getUserMedia=function(a){return e(a,function(a){return j(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(g(a))})})}}}}Object.defineProperty(c,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c.shimGetUserMedia=e;var g=a("../utils.js"),h=d(g),i=h.log},{"../utils.js":11}],6:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){if(a.RTCIceCandidate&&!(a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)){var b=a.RTCIceCandidate;a.RTCIceCandidate=function(a){if("object"===("undefined"==typeof a?"undefined":m(a))&&a.candidate&&0===a.candidate.indexOf("a=")&&(a=JSON.parse(JSON.stringify(a)),a.candidate=a.candidate.substr(2)),a.candidate&&a.candidate.length){var c=new b(a),d=o["default"].parseCandidate(a.candidate),e=Object.assign(c,d);return e.toJSON=function(){return{candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex,usernameFragment:e.usernameFragment}},e}return new b(a)},a.RTCIceCandidate.prototype=b.prototype,q.wrapPeerConnectionEvent(a,"icecandidate",function(b){return b.candidate&&Object.defineProperty(b,"candidate",{value:new a.RTCIceCandidate(b.candidate),writable:"false"}),b})}}function g(a,b){if(a.RTCPeerConnection){"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"==typeof this._sctp?null:this._sctp}});var c=function(a){if(!a||!a.sdp)return!1;var b=o["default"].splitSections(a.sdp);return b.shift(),b.some(function(a){var b=o["default"].parseMLine(a);return b&&"application"===b.kind&&b.protocol.indexOf("SCTP")!==-1})},d=function(a){var b=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===b||b.length<2)return-1;var c=parseInt(b[1],10);return c!==c?-1:c},e=function(a){var c=65536;return"firefox"===b.browser&&(c=b.version<57?a===-1?16384:2147483637:b.version<60?57===b.version?65535:65536:2147483637),c},f=function(a,c){var d=65536;"firefox"===b.browser&&57===b.version&&(d=65535);var e=o["default"].matchPrefix(a.sdp,"a=max-message-size:");return e.length>0?d=parseInt(e[0].substr(19),10):"firefox"===b.browser&&c!==-1&&(d=2147483637),d},g=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===b.browser&&b.version>=76){var a=this.getConfiguration(),h=a.sdpSemantics;"plan-b"===h&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"==typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(c(arguments[0])){var i=d(arguments[0]),j=e(i),k=f(arguments[0],i),l=void 0;l=0===j&&0===k?Number.POSITIVE_INFINITY:0===j||0===k?Math.max(j,k):Math.min(j,k);var m={};Object.defineProperty(m,"maxMessageSize",{get:function(){return l}}),this._sctp=m}return g.apply(this,arguments)}}}function h(a){function b(a,b){var c=a.send;a.send=function(){var d=arguments[0],e=d.length||d.size||d.byteLength;if("open"===a.readyState&&b.sctp&&e>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var c=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){var a=c.apply(this,arguments);return b(a,this),a},q.wrapPeerConnectionEvent(a,"datachannel",function(a){return b(a.channel,a.target),a})}}function i(a){if(a.RTCPeerConnection&&!("connectionState"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype;Object.defineProperty(b,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(b,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(a){var c=b[a];b[a]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(a){var b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;var c=new Event("connectionstatechange",a);b.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),c.apply(this,arguments)}})}}function j(a,b){if(a.RTCPeerConnection&&!("chrome"===b.browser&&b.version>=71||"safari"===b.browser&&b.version>=605)){var c=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(b){if(b&&b.sdp&&b.sdp.indexOf("\na=extmap-allow-mixed")!==-1){var d=b.sdp.split("\n").filter(function(a){return"a=extmap-allow-mixed"!==a.trim()}).join("\n");a.RTCSessionDescription&&b instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:b.type,sdp:d}):b.sdp=d}return c.apply(this,arguments)}}}function k(a,b){if(a.RTCPeerConnection&&a.RTCPeerConnection.prototype){var c=a.RTCPeerConnection.prototype.addIceCandidate;c&&0!==c.length&&(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===b.browser&&b.version<78||"firefox"===b.browser&&b.version<68||"safari"===b.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}function l(a,b){if(a.RTCPeerConnection&&a.RTCPeerConnection.prototype){var c=a.RTCPeerConnection.prototype.setLocalDescription;c&&0!==c.length&&(a.RTCPeerConnection.prototype.setLocalDescription=function(){var a=this,b=arguments[0]||{};if("object"!==("undefined"==typeof b?"undefined":m(b))||b.type&&b.sdp)return c.apply(this,arguments);if(b={type:b.type,sdp:b.sdp},!b.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":b.type="offer";break;default:b.type="answer"}if(b.sdp||"offer"!==b.type&&"answer"!==b.type)return c.apply(this,[b]);var d="offer"===b.type?this.createOffer:this.createAnswer;return d.apply(this).then(function(b){return c.apply(a,[b])})})}}Object.defineProperty(c,"__esModule",{value:!0});var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c.shimRTCIceCandidate=f,c.shimMaxMessageSize=g,c.shimSendThrowTypeError=h,c.shimConnectionState=i,c.removeExtmapAllowMixed=j,c.shimAddIceCandidateNullOrEmpty=k,c.shimParameterlessSetLocalDescription=l;var n=a("sdp"),o=e(n),p=a("./utils"),q=d(p)},{"./utils":11,sdp:12}],7:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function f(a){"object"===("undefined"==typeof a?"undefined":p(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function g(a,b){if("object"===("undefined"==typeof a?"undefined":p(a))&&(a.RTCPeerConnection||a.mozRTCPeerConnection)){!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),b.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b],d=e({},b,function(){return arguments[0]=new("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)});a.RTCPeerConnection.prototype[b]=d[b]});var c={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},d=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var a=Array.prototype.slice.call(arguments),e=a[0],f=a[1],g=a[2];return d.apply(this,[e||null]).then(function(a){if(b.version<53&&!f)try{a.forEach(function(a){a.type=c[a.type]||a.type})}catch(d){if("TypeError"!==d.name)throw d;a.forEach(function(b,d){a.set(d,Object.assign({},b,{type:c[b.type]||b.type}))})}return a}).then(f,g)}}}function h(a){if("object"===("undefined"==typeof a?"undefined":p(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)){var b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=b.apply(this,[]);return c.forEach(function(b){return b._pc=a}),c});var c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=c.apply(this,arguments);return a._pc=this,a}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function i(a){if("object"===("undefined"==typeof a?"undefined":p(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)){var b=a.RTCPeerConnection.prototype.getReceivers;b&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,c=b.apply(this,[]);return c.forEach(function(b){return b._pc=a}),c}),t.wrapPeerConnectionEvent(a,"track",function(a){
return a.receiver._pc=a.srcElement,a}),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function j(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;t.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(c){c.track&&a.getTracks().includes(c.track)&&b.removeTrack(c)})})}function k(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function l(a){if("object"===("undefined"==typeof a?"undefined":p(a))&&a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.addTransceiver;b&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var a=arguments[1],c=a&&"sendEncodings"in a;c&&a.sendEncodings.forEach(function(a){if("rid"in a){var b=/^[a-z0-9]{0,16}$/i;if(!b.test(a.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});var d=b.apply(this,arguments);if(c){var e=d.sender,f=e.getParameters();"encodings"in f&&(1!==f.encodings.length||0!==Object.keys(f.encodings[0]).length)||(f.encodings=a.sendEncodings,e.sendEncodings=a.sendEncodings,this.setParametersPromises.push(e.setParameters(f).then(function(){delete e.sendEncodings})["catch"](function(){delete e.sendEncodings})))}return d})}}function m(a){if("object"===("undefined"==typeof a?"undefined":p(a))&&a.RTCRtpSender){var b=a.RTCRtpSender.prototype.getParameters;b&&(a.RTCRtpSender.prototype.getParameters=function(){var a=b.apply(this,arguments);return"encodings"in a||(a.encodings=[].concat(this.sendEncodings||[{}])),a})}}function n(a){if("object"===("undefined"==typeof a?"undefined":p(a))&&a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){var a=this,c=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return b.apply(a,c)})["finally"](function(){a.setParametersPromises=[]}):b.apply(this,arguments)}}}function o(a){if("object"===("undefined"==typeof a?"undefined":p(a))&&a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){var a=this,c=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return b.apply(a,c)})["finally"](function(){a.setParametersPromises=[]}):b.apply(this,arguments)}}}Object.defineProperty(c,"__esModule",{value:!0}),c.shimGetDisplayMedia=c.shimGetUserMedia=void 0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},q=a("./getusermedia");Object.defineProperty(c,"shimGetUserMedia",{enumerable:!0,get:function(){return q.shimGetUserMedia}});var r=a("./getdisplaymedia");Object.defineProperty(c,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}}),c.shimOnTrack=f,c.shimPeerConnection=g,c.shimSenderGetStats=h,c.shimReceiverGetStats=i,c.shimRemoveStream=j,c.shimRTCDataChannel=k,c.shimAddTransceiver=l,c.shimGetParameters=m,c.shimCreateOffer=n,c.shimCreateAnswer=o;var s=a("../utils"),t=d(s)},{"../utils":11,"./getdisplaymedia":8,"./getusermedia":9}],8:[function(a,b,c){"use strict";function d(a,b){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||a.navigator.mediaDevices&&(a.navigator.mediaDevices.getDisplayMedia=function(c){if(!c||!c.video){var d=new DOMException("getDisplayMedia without video constraints is undefined");return d.name="NotFoundError",d.code=8,Promise.reject(d)}return c.video===!0?c.video={mediaSource:b}:c.video.mediaSource=b,a.navigator.mediaDevices.getUserMedia(c)})}Object.defineProperty(c,"__esModule",{value:!0}),c.shimGetDisplayMedia=d},{}],9:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){var c=a&&a.navigator,d=a&&a.MediaStreamTrack;if(c.getUserMedia=function(a,b,d){h.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),c.mediaDevices.getUserMedia(a).then(b,d)},!(b.version>55&&"autoGainControl"in c.mediaDevices.getSupportedConstraints())){var e=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},g=c.mediaDevices.getUserMedia.bind(c.mediaDevices);if(c.mediaDevices.getUserMedia=function(a){return"object"===("undefined"==typeof a?"undefined":f(a))&&"object"===f(a.audio)&&(a=JSON.parse(JSON.stringify(a)),e(a.audio,"autoGainControl","mozAutoGainControl"),e(a.audio,"noiseSuppression","mozNoiseSuppression")),g(a)},d&&d.prototype.getSettings){var i=d.prototype.getSettings;d.prototype.getSettings=function(){var a=i.apply(this,arguments);return e(a,"mozAutoGainControl","autoGainControl"),e(a,"mozNoiseSuppression","noiseSuppression"),a}}if(d&&d.prototype.applyConstraints){var j=d.prototype.applyConstraints;d.prototype.applyConstraints=function(a){return"audio"===this.kind&&"object"===("undefined"==typeof a?"undefined":f(a))&&(a=JSON.parse(JSON.stringify(a)),e(a,"autoGainControl","mozAutoGainControl"),e(a,"noiseSuppression","mozNoiseSuppression")),j.apply(this,[a])}}}}Object.defineProperty(c,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c.shimGetUserMedia=e;var g=a("../utils"),h=d(g)},{"../utils":11}],10:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){if("object"===("undefined"==typeof a?"undefined":n(a))&&a.RTCPeerConnection){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(a)||this._localStreams.push(a),a.getAudioTracks().forEach(function(d){return b.call(c,d,a)}),a.getVideoTracks().forEach(function(d){return b.call(c,d,a)})},a.RTCPeerConnection.prototype.addTrack=function(a){for(var c=this,d=arguments.length,e=Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];return e&&e.forEach(function(a){c._localStreams?c._localStreams.includes(a)||c._localStreams.push(a):c._localStreams=[a]}),b.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);var c=this._localStreams.indexOf(a);if(c!==-1){this._localStreams.splice(c,1);var d=a.getTracks();this.getSenders().forEach(function(a){d.includes(a.track)&&b.removeTrack(a)})}})}}function f(a){if("object"===("undefined"==typeof a?"undefined":n(a))&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=a),this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){if(b._remoteStreams||(b._remoteStreams=[]),!b._remoteStreams.includes(a)){b._remoteStreams.push(a);var c=new Event("addstream");c.stream=a,b.dispatchEvent(c)}})})}});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(function(b){if(a._remoteStreams||(a._remoteStreams=[]),!(a._remoteStreams.indexOf(b)>=0)){a._remoteStreams.push(b);var c=new Event("addstream");c.stream=b,a.dispatchEvent(c)}})}),b.apply(a,arguments)}}}function g(a){if("object"===("undefined"==typeof a?"undefined":n(a))&&a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype,c=b.createOffer,d=b.createAnswer,e=b.setLocalDescription,f=b.setRemoteDescription,g=b.addIceCandidate;b.createOffer=function(a,b){var d=arguments.length>=2?arguments[2]:arguments[0],e=c.apply(this,[d]);return b?(e.then(a,b),Promise.resolve()):e},b.createAnswer=function(a,b){var c=arguments.length>=2?arguments[2]:arguments[0],e=d.apply(this,[c]);return b?(e.then(a,b),Promise.resolve()):e};var h=function(a,b,c){var d=e.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d};b.setLocalDescription=h,h=function(a,b,c){var d=f.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d},b.setRemoteDescription=h,h=function(a,b,c){var d=g.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d},b.addIceCandidate=h}}function h(a){var b=a&&a.navigator;if(b.mediaDevices&&b.mediaDevices.getUserMedia){var c=b.mediaDevices,d=c.getUserMedia.bind(c);b.mediaDevices.getUserMedia=function(a){return d(i(a))}}!b.getUserMedia&&b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=function(a,c,d){b.mediaDevices.getUserMedia(a).then(c,d)}.bind(b))}function i(a){return a&&void 0!==a.video?Object.assign({},a,{video:p.compactObject(a.video)}):a}function j(a){if(a.RTCPeerConnection){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,c){if(a&&a.iceServers){for(var d=[],e=0;e<a.iceServers.length;e++){var f=a.iceServers[e];!f.hasOwnProperty("urls")&&f.hasOwnProperty("url")?(p.deprecated("RTCIceServer.url","RTCIceServer.urls"),f=JSON.parse(JSON.stringify(f)),f.urls=f.url,delete f.url,d.push(f)):d.push(a.iceServers[e])}a.iceServers=d}return new b(a,c)},a.RTCPeerConnection.prototype=b.prototype,"generateCertificate"in b&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})}}function k(a){"object"===("undefined"==typeof a?"undefined":n(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function l(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!=typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var c=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});a.offerToReceiveAudio===!1&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):a.offerToReceiveAudio!==!0||c||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!=typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);var d=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});a.offerToReceiveVideo===!1&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):a.offerToReceiveVideo!==!0||d||this.addTransceiver("video",{direction:"recvonly"})}return b.apply(this,arguments)}}function m(a){"object"!==("undefined"==typeof a?"undefined":n(a))||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}Object.defineProperty(c,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c.shimLocalStreamsAPI=e,c.shimRemoteStreamsAPI=f,c.shimCallbacksAPI=g,c.shimGetUserMedia=h,c.shimConstraints=i,c.shimRTCIceServerUrls=j,c.shimTrackEventTransceiver=k,c.shimCreateOfferLegacy=l,c.shimAudioContext=m;var o=a("../utils"),p=d(o)},{"../utils":11}],11:[function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b,c){var d=a.match(b);return d&&d.length>=c&&parseInt(d[c],10)}function f(a,b,c){if(a.RTCPeerConnection){var d=a.RTCPeerConnection.prototype,e=d.addEventListener;d.addEventListener=function(a,d){if(a!==b)return e.apply(this,arguments);var f=function(a){var b=c(a);b&&(d.handleEvent?d.handleEvent(b):d(b))};return this._eventMap=this._eventMap||{},this._eventMap[b]||(this._eventMap[b]=new Map),this._eventMap[b].set(d,f),e.apply(this,[a,f])};var f=d.removeEventListener;d.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[b])return f.apply(this,arguments);if(!this._eventMap[b].has(c))return f.apply(this,arguments);var d=this._eventMap[b].get(c);return this._eventMap[b]["delete"](c),0===this._eventMap[b].size&&delete this._eventMap[b],0===Object.keys(this._eventMap).length&&delete this._eventMap,f.apply(this,[a,d])},Object.defineProperty(d,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]),a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}}function g(a){return"boolean"!=typeof a?new Error("Argument type: "+("undefined"==typeof a?"undefined":p(a))+". Please use a boolean."):(q=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function h(a){return"boolean"!=typeof a?new Error("Argument type: "+("undefined"==typeof a?"undefined":p(a))+". Please use a boolean."):(r=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function i(){if("object"===("undefined"==typeof window?"undefined":p(window))){if(q)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function j(a,b){r&&console.warn(a+" is deprecated, please use "+b+" instead.")}function k(a){var b={browser:null,version:null};if("undefined"==typeof a||!a.navigator)return b.browser="Not a browser.",b;var c=a.navigator;if(c.mozGetUserMedia)b.browser="firefox",b.version=e(c.userAgent,/Firefox\/(\d+)\./,1);else if(c.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection&&!a.RTCIceGatherer)b.browser="chrome",b.version=e(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!a.RTCPeerConnection||!c.userAgent.match(/AppleWebKit\/(\d+)\./))return b.browser="Not a supported browser.",b;b.browser="safari",b.version=e(c.userAgent,/AppleWebKit\/(\d+)\./,1),b.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype}return b}function l(a){return"[object Object]"===Object.prototype.toString.call(a)}function m(a){return l(a)?Object.keys(a).reduce(function(b,c){var e=l(a[c]),f=e?m(a[c]):a[c],g=e&&!Object.keys(f).length;return void 0===f||g?b:Object.assign(b,d({},c,f))},{}):a}function n(a,b,c){b&&!c.has(b.id)&&(c.set(b.id,b),Object.keys(b).forEach(function(d){d.endsWith("Id")?n(a,a.get(b[d]),c):d.endsWith("Ids")&&b[d].forEach(function(b){n(a,a.get(b),c)})}))}function o(a,b,c){var d=c?"outbound-rtp":"inbound-rtp",e=new Map;if(null===b)return e;var f=[];return a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&f.push(a)}),f.forEach(function(b){a.forEach(function(c){c.type===d&&c.trackId===b.id&&n(a,c,e)})}),e}Object.defineProperty(c,"__esModule",{value:!0});var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c.extractVersion=e,c.wrapPeerConnectionEvent=f,c.disableLog=g,c.disableWarnings=h,c.log=i,c.deprecated=j,c.detectBrowser=k,c.compactObject=m,c.walkStats=n,c.filterStats=o;var q=!0,r=!0},{}],12:[function(a,b,c){"use strict";var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e={};e.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},e.localCName=e.generateIdentifier(),e.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})},e.splitSections=function(a){var b=a.split("\nm=");return b.map(function(a,b){return(b>0?"m="+a:a).trim()+"\r\n"})},e.getDescription=function(a){var b=e.splitSections(a);return b&&b[0]},e.getMediaSections=function(a){var b=e.splitSections(a);return b.shift(),b},e.matchPrefix=function(a,b){return e.splitLines(a).filter(function(a){return 0===a.indexOf(b)})},e.parseCandidate=function(a){var b=void 0;b=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var c={foundation:b[0],component:{1:"rtp",2:"rtcp"}[b[1]]||b[1],protocol:b[2].toLowerCase(),priority:parseInt(b[3],10),ip:b[4],address:b[4],port:parseInt(b[5],10),type:b[7]},d=8;d<b.length;d+=2)switch(b[d]){case"raddr":c.relatedAddress=b[d+1];break;case"rport":c.relatedPort=parseInt(b[d+1],10);break;case"tcptype":c.tcpType=b[d+1];break;case"ufrag":c.ufrag=b[d+1],c.usernameFragment=b[d+1];break;default:void 0===c[b[d]]&&(c[b[d]]=b[d+1])}return c},e.writeCandidate=function(a){var b=[];b.push(a.foundation);var c=a.component;"rtp"===c?b.push(1):"rtcp"===c?b.push(2):b.push(c),b.push(a.protocol.toUpperCase()),b.push(a.priority),b.push(a.address||a.ip),b.push(a.port);var d=a.type;return b.push("typ"),b.push(d),"host"!==d&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort)),a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType)),(a.usernameFragment||a.ufrag)&&(b.push("ufrag"),b.push(a.usernameFragment||a.ufrag)),"candidate:"+b.join(" ")},e.parseIceOptions=function(a){return a.substr(14).split(" ")},e.parseRtpMap=function(a){var b=a.substr(9).split(" "),c={payloadType:parseInt(b.shift(),10)};return b=b[0].split("/"),c.name=b[0],c.clockRate=parseInt(b[1],10),c.channels=3===b.length?parseInt(b[2],10):1,c.numChannels=c.channels,c},e.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);var c=a.channels||a.numChannels||1;return"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==c?"/"+c:"")+"\r\n"},e.parseExtmap=function(a){var b=a.substr(9).split(" ");return{id:parseInt(b[0],10),direction:b[0].indexOf("/")>0?b[0].split("/")[1]:"sendrecv",uri:b[1]}},e.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"},e.parseFmtp=function(a){for(var b={},c=void 0,d=a.substr(a.indexOf(" ")+1).split(";"),e=0;e<d.length;e++)c=d[e].trim().split("="),b[c[0].trim()]=c[1];return b},e.writeFmtp=function(a){var b="",c=a.payloadType;if(void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.parameters&&Object.keys(a.parameters).length){var d=[];Object.keys(a.parameters).forEach(function(b){void 0!==a.parameters[b]?d.push(b+"="+a.parameters[b]):d.push(b)}),b+="a=fmtp:"+c+" "+d.join(";")+"\r\n"}return b},e.parseRtcpFb=function(a){var b=a.substr(a.indexOf(" ")+1).split(" ");return{type:b.shift(),parameter:b.join(" ")}},e.writeRtcpFb=function(a){var b="",c=a.payloadType;return void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"}),b},e.parseSsrcMedia=function(a){var b=a.indexOf(" "),c={ssrc:parseInt(a.substr(7,b-7),10)},d=a.indexOf(":",b);return d>-1?(c.attribute=a.substr(b+1,d-b-1),c.value=a.substr(d+1)):c.attribute=a.substr(b+1),c},e.parseSsrcGroup=function(a){var b=a.substr(13).split(" ");return{semantics:b.shift(),ssrcs:b.map(function(a){return parseInt(a,10)})}},e.getMid=function(a){var b=e.matchPrefix(a,"a=mid:")[0];if(b)return b.substr(6)},e.parseFingerprint=function(a){var b=a.substr(14).split(" ");return{algorithm:b[0].toLowerCase(),value:b[1].toUpperCase()}},e.getDtlsParameters=function(a,b){var c=e.matchPrefix(a+b,"a=fingerprint:");return{role:"auto",fingerprints:c.map(e.parseFingerprint)}},e.writeDtlsParameters=function(a,b){var c="a=setup:"+b+"\r\n";return a.fingerprints.forEach(function(a){c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"}),c},e.parseCryptoLine=function(a){var b=a.substr(9).split(" ");return{tag:parseInt(b[0],10),cryptoSuite:b[1],keyParams:b[2],sessionParams:b.slice(3)}},e.writeCryptoLine=function(a){return"a=crypto:"+a.tag+" "+a.cryptoSuite+" "+("object"===d(a.keyParams)?e.writeCryptoKeyParams(a.keyParams):a.keyParams)+(a.sessionParams?" "+a.sessionParams.join(" "):"")+"\r\n"},e.parseCryptoKeyParams=function(a){if(0!==a.indexOf("inline:"))return null;var b=a.substr(7).split("|");return{keyMethod:"inline",keySalt:b[0],lifeTime:b[1],mkiValue:b[2]?b[2].split(":")[0]:void 0,mkiLength:b[2]?b[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(a){return a.keyMethod+":"+a.keySalt+(a.lifeTime?"|"+a.lifeTime:"")+(a.mkiValue&&a.mkiLength?"|"+a.mkiValue+":"+a.mkiLength:"")},e.getCryptoParameters=function(a,b){var c=e.matchPrefix(a+b,"a=crypto:");return c.map(e.parseCryptoLine)},e.getIceParameters=function(a,b){var c=e.matchPrefix(a+b,"a=ice-ufrag:")[0],d=e.matchPrefix(a+b,"a=ice-pwd:")[0];return c&&d?{usernameFragment:c.substr(12),password:d.substr(10)}:null},e.writeIceParameters=function(a){var b="a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n";return a.iceLite&&(b+="a=ice-lite\r\n"),b},e.parseRtpParameters=function(a){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=e.splitLines(a),d=c[0].split(" "),f=3;f<d.length;f++){var g=d[f],h=e.matchPrefix(a,"a=rtpmap:"+g+" ")[0];if(h){var i=e.parseRtpMap(h),j=e.matchPrefix(a,"a=fmtp:"+g+" ");switch(i.parameters=j.length?e.parseFmtp(j[0]):{},i.rtcpFeedback=e.matchPrefix(a,"a=rtcp-fb:"+g+" ").map(e.parseRtcpFb),b.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":b.fecMechanisms.push(i.name.toUpperCase())}}}return e.matchPrefix(a,"a=extmap:").forEach(function(a){b.headerExtensions.push(e.parseExtmap(a))}),b},e.writeRtpDescription=function(a,b){var c="";c+="m="+a+" ",c+=b.codecs.length>0?"9":"0",c+=" UDP/TLS/RTP/SAVPF ",c+=b.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n",c+="c=IN IP4 0.0.0.0\r\n",c+="a=rtcp:9 IN IP4 0.0.0.0\r\n",b.codecs.forEach(function(a){c+=e.writeRtpMap(a),c+=e.writeFmtp(a),c+=e.writeRtcpFb(a)});var d=0;return b.codecs.forEach(function(a){a.maxptime>d&&(d=a.maxptime)}),d>0&&(c+="a=maxptime:"+d+"\r\n"),b.headerExtensions&&b.headerExtensions.forEach(function(a){c+=e.writeExtmap(a)}),c},e.parseRtpEncodingParameters=function(a){var b=[],c=e.parseRtpParameters(a),d=c.fecMechanisms.indexOf("RED")!==-1,f=c.fecMechanisms.indexOf("ULPFEC")!==-1,g=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),h=g.length>0&&g[0].ssrc,i=void 0,j=e.matchPrefix(a,"a=ssrc-group:FID").map(function(a){var b=a.substr(17).split(" ");return b.map(function(a){return parseInt(a,10)})});j.length>0&&j[0].length>1&&j[0][0]===h&&(i=j[0][1]),c.codecs.forEach(function(a){if("RTX"===a.name.toUpperCase()&&a.parameters.apt){var c={ssrc:h,codecPayloadType:parseInt(a.parameters.apt,10)};h&&i&&(c.rtx={ssrc:i}),b.push(c),d&&(c=JSON.parse(JSON.stringify(c)),c.fec={ssrc:h,mechanism:f?"red+ulpfec":"red"},b.push(c))}}),0===b.length&&h&&b.push({ssrc:h});var k=e.matchPrefix(a,"b=");return k.length&&(k=0===k[0].indexOf("b=TIAS:")?parseInt(k[0].substr(7),10):0===k[0].indexOf("b=AS:")?1e3*parseInt(k[0].substr(5),10)*.95-16e3:void 0,b.forEach(function(a){a.maxBitrate=k})),b},e.parseRtcpParameters=function(a){var b={},c=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];c&&(b.cname=c.value,b.ssrc=c.ssrc);var d=e.matchPrefix(a,"a=rtcp-rsize");b.reducedSize=d.length>0,b.compound=0===d.length;var f=e.matchPrefix(a,"a=rtcp-mux");return b.mux=f.length>0,b},e.writeRtcpParameters=function(a){var b="";return a.reducedSize&&(b+="a=rtcp-rsize\r\n"),a.mux&&(b+="a=rtcp-mux\r\n"),void 0!==a.ssrc&&a.cname&&(b+="a=ssrc:"+a.ssrc+" cname:"+a.cname+"\r\n"),b},e.parseMsid=function(a){var b=void 0,c=e.matchPrefix(a,"a=msid:");if(1===c.length)return b=c[0].substr(7).split(" "),{stream:b[0],track:b[1]};var d=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});return d.length>0?(b=d[0].value.split(" "),{stream:b[0],track:b[1]}):void 0},e.parseSctpDescription=function(a){var b=e.parseMLine(a),c=e.matchPrefix(a,"a=max-message-size:"),d=void 0;c.length>0&&(d=parseInt(c[0].substr(19),10)),isNaN(d)&&(d=65536);var f=e.matchPrefix(a,"a=sctp-port:");if(f.length>0)return{port:parseInt(f[0].substr(12),10),protocol:b.fmt,maxMessageSize:d};var g=e.matchPrefix(a,"a=sctpmap:");if(g.length>0){var h=g[0].substr(10).split(" ");return{port:parseInt(h[0],10),protocol:h[1],maxMessageSize:d}}},e.writeSctpDescription=function(a,b){var c=[];return c="DTLS/SCTP"!==a.protocol?["m="+a.kind+" 9 "+a.protocol+" "+b.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+b.port+"\r\n"]:["m="+a.kind+" 9 "+a.protocol+" "+b.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+b.port+" "+b.protocol+" 65535\r\n"],void 0!==b.maxMessageSize&&c.push("a=max-message-size:"+b.maxMessageSize+"\r\n"),c.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,21)},e.writeSessionBoilerplate=function(a,b,c){var d=void 0,f=void 0!==b?b:2;d=a?a:e.generateSessionId();var g=c||"thisisadapterortc";return"v=0\r\no="+g+" "+d+" "+f+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},e.getDirection=function(a,b){for(var c=e.splitLines(a),d=0;d<c.length;d++)switch(c[d]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[d].substr(2)}return b?e.getDirection(b):"sendrecv"},e.getKind=function(a){var b=e.splitLines(a),c=b[0].split(" ");return c[0].substr(2)},e.isRejected=function(a){return"0"===a.split(" ",2)[1]},e.parseMLine=function(a){var b=e.splitLines(a),c=b[0].substr(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},e.parseOLine=function(a){var b=e.matchPrefix(a,"o=")[0],c=b.substr(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},e.isValidSDP=function(a){if("string"!=typeof a||0===a.length)return!1;for(var b=e.splitLines(a),c=0;c<b.length;c++)if(b[c].length<2||"="!==b[c].charAt(1))return!1;return!0},"object"===("undefined"==typeof b?"undefined":d(b))&&(b.exports=e)},{}]},{},[1])(1)});