define(["jquery","core/log","filter_poodll/utils_amd","filter_poodll/msr_stereoaudio","filter_poodll/msr_plain"],function(a,b,c,d,e){"use strict";return b.debug("PoodLL MS Recorder: initialising"),{sampleRate:48e3,mimeType:"audio/wav",audioChannels:1,bufferSize:2048,therecorder:null,audioctx:null,audioanalyser:null,clone:function(){return a.extend(!0,{},this)},init:function(a,f,g,h,i){if(this.audioctx=f,this.audioanalyser=g,"auto"!=i)switch(i){case"stereoaudio":"audio"==h?this.therecorder=d:this.therecorder=e;break;case"plain":default:this.therecorder=e}else c.has_mediarecorder()?(this.therecorder=e,b.debug("using plain recorder")):"audio"==h&&(this.therecorder=d,b.debug("using stereo recorder"));this.therecorder&&this.therecorder.init(this,a,f,h)},start:function(a){this.therecorder.start(a),this.audioanalyser.start()},stop:function(){this.therecorder.stop(),this.audioanalyser.clear()},pause:function(){this.therecorder.pause(),this.audioanalyser.clear()},resume:function(){this.therecorder.resume(),this.audioanalyser.start()},ondataavailable:function(a){b.debug("ondataavailable:"+a)},onStartedDrawingNonBlankFrames:function(){b.debug("started drawing non blank frames:")},onstop:function(a){b.debug(a)}}});