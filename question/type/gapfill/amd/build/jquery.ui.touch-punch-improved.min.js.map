{"version":3,"sources":["../src/jquery.ui.touch-punch-improved.js"],"names":["factory","define","amd","window","jQuery","$","pointerEnabled","navigator","msPointerEnabled","support","touch","document","ui","mouse","mouseProto","prototype","_mouseInit","touchHandled","fixTouch","winPageX","pageXOffset","winPageY","pageYOffset","x","clientX","y","clientY","pageY","Math","floor","pageX","simulateMouseEvent","event","simulatedType","originalEvent","touches","length","isPrimary","changedTouches","simulatedEvent","createEvent","coord","target","is","stopPropagation","preventDefault","initMouseEvent","screenX","screenY","dispatchEvent","_touchStart","self","_mouseCapture","_touchMoved","_touchMove","_touchEnd","element","on","proxy","call"],"mappings":"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","sourcesContent":["/*\n * JQuery UI Touch Punch Improved 0.3.1\n *\n *\n * Copyright 2013, Chris Hutchinson <chris@brushd.com>\n * Original jquery-ui-touch-punch Copyright 2011, Dave Furfero\n * Dual licensed under the MIT or GPL Version 2 licenses.\n *\n * Depends:\n * jquery.ui.widget.js\n * jquery.ui.mouse.js\n */\n(function(factory) {\n    if (typeof define === \"function\" && define.amd) {\n\n        // AMD. Register as an anonymous module.\n        define([\"jquery\", \"jqueryui\"], factory);\n    } else {\n\n        // Browser globals.\n        factory(window.jQuery);\n    }\n}(function($) {\n    var pointerEnabled = window.navigator.pointerEnabled\n        || window.navigator.msPointerEnabled;\n\n    // Detect touch support.\n    $.support.touch = 'ontouchend' in document || pointerEnabled;\n\n    // Ignore browsers without touch support or mouse support.\n    if (!$.support.touch || !$.ui.mouse) {\n        return;\n    }\n\n    var mouseProto = $.ui.mouse.prototype,\n        _mouseInit = mouseProto._mouseInit,\n        touchHandled;\n\n    /**\n     *  See http://stackoverflow.com/a/12714084/220825.\n     * @param {*} touch\n     * @returns {object}\n     */\n    function fixTouch(touch) {\n        var winPageX = window.pageXOffset,\n            winPageY = window.pageYOffset,\n            x = touch.clientX,\n            y = touch.clientY;\n\n        if (touch.pageY === 0 && Math.floor(y) > Math.floor(touch.pageY)\n         || touch.pageX === 0 && Math.floor(x) > Math.floor(touch.pageX)) {\n            // ...iOS4 clientX/clientY have the value that should have been.\n            // ...in pageX/pageY. While pageX/page/ have the value 0.\n            x = x - winPageX;\n            y = y - winPageY;\n        } else if (y < (touch.pageY - winPageY) || x < (touch.pageX - winPageX)) {\n            // Some Android browsers have totally bogus values for clientX/Y.\n            // when scrolling/zooming a page. Detectable since clientX/clientY.\n            // should never be smaller than pageX/pageY minus page scroll.\n            x = touch.pageX - winPageX;\n            y = touch.pageY - winPageY;\n        }\n\n        return {\n            clientX: x,\n            clientY: y\n        };\n    }\n\n    /**\n     * Simulate a mouse event based on a corresponding touch event\n     * @param {Object} event A touch event\n     * @param {String} simulatedType The corresponding mouse event\n     */\n    function simulateMouseEvent(event, simulatedType) {\n        // Ignore multi-touch events.\n        if ((!pointerEnabled && event.originalEvent.touches.length > 1) || (pointerEnabled && !event.isPrimary)) {\n            return;\n        }\n\n        var touch = pointerEnabled ? event.originalEvent : event.originalEvent.changedTouches[0],\n            simulatedEvent = document.createEvent('MouseEvents'),\n            coord = fixTouch(touch);\n\n        // Check if element is an input or a textarea.\n        if ($(touch.target).is(\"input\") || $(touch.target).is(\"textarea\")) {\n            event.stopPropagation();\n        } else {\n            event.preventDefault();\n        }\n\n        // Initialize the simulated mouse event using the touch event's coordinates.\n        simulatedEvent.initMouseEvent(\n            simulatedType, // ...type.\n            true, // ...bubbles.\n            true, // ...cancelable.\n            window, // ...view.\n            1, // ...detail\n            event.screenX || touch.screenX, // ...screenX.\n            event.screenY || touch.screenY, // ...screenY.\n            event.clientX || coord.clientX, // ...clientX.\n            event.clientY || coord.clientY, // ...clientY.\n            false, // ...ctrlKey.\n            false, // ...altKey.\n            false, // ...shiftKey.\n            false, // ...metaKey.\n            0, // ...button.\n            null // ...relatedTarget.\n        );\n\n        // Dispatch the simulated event to the target element.\n        event.target.dispatchEvent(simulatedEvent);\n    }\n\n    /**\n     * Handle the jQuery UI widget's touchstart events\n     * @param {Object} event The widget element's touchstart event\n     */\n    mouseProto._touchStart = function(event) {\n        var self = this;\n\n        // Ignore the event if another widget is already being handled.\n        if (touchHandled || (!pointerEnabled && !self._mouseCapture(event.originalEvent.changedTouches[0]))) {\n            return;\n        }\n\n        // Set the flag to prevent other widgets from inheriting the touch event.\n        touchHandled = true;\n\n        // Track movement to determine if interaction was a click.\n        self._touchMoved = false;\n\n        // Simulate the mouseover event.\n        simulateMouseEvent(event, 'mouseover');\n\n        // Simulate the mousemove event.\n        simulateMouseEvent(event, 'mousemove');\n\n        // Simulate the mousedown event.\n        simulateMouseEvent(event, 'mousedown');\n    };\n\n    /**\n     * Handle the jQuery UI widget's touchmove events\n     * @param {Object} event The document's touchmove event\n     */\n    mouseProto._touchMove = function(event) {\n        // Ignore event if not handled.\n        if (!touchHandled) {\n            return;\n        }\n\n        // Interaction was not a click.\n        this._touchMoved = true;\n\n        // Simulate the mousemove event.\n        simulateMouseEvent(event, 'mousemove');\n    };\n\n    /**\n     * Handle the jQuery UI widget's touchend events\n     * @param {Object} event The document's touchend event\n     */\n    mouseProto._touchEnd = function(event) {\n        // Ignore event if not handled.\n        if (!touchHandled) {\n            return;\n        }\n\n        // Simulate the mouseup event.\n        simulateMouseEvent(event, 'mouseup');\n\n        // Simulate the mouseout event.\n        simulateMouseEvent(event, 'mouseout');\n\n        // If the touch interaction did not move, it should trigger a click.\n        if (!this._touchMoved) {\n            // Simulate the click event.\n            simulateMouseEvent(event, 'click');\n        }\n\n        // Unset the flag to allow other widgets to inherit the touch event.\n        touchHandled = false;\n    };\n\n    /**\n     * A duck punch of the $.ui.mouse _mouseInit method to support touch events.\n     * This method extends the widget with bound touch event handlers that\n     * translate touch events to mouse events and pass them to the widget's\n     * original mouse event handling methods.\n     */\n    mouseProto._mouseInit = function() {\n        var self = this;\n\n        self.element.on({\n            'touchstart': $.proxy(self, '_touchStart'),\n            'touchmove': $.proxy(self, '_touchMove'),\n            'touchend': $.proxy(self, '_touchEnd'),\n            'pointerDown': $.proxy(self, '_touchStart'),\n            'pointerMove': $.proxy(self, '_touchMove'),\n            'pointerUp': $.proxy(self, '_touchEnd'),\n            'MSPointerDown': $.proxy(self, '_touchStart'),\n            'MSPointerMove': $.proxy(self, '_touchMove'),\n            'MSPointerUp': $.proxy(self, '_touchEnd')\n        });\n\n        // Call the original $.ui.mouse init method.\n        _mouseInit.call(self);\n    };\n\n}));"],"file":"jquery.ui.touch-punch-improved.min.js"}