{"version":3,"file":"dragdrop.min.js","sources":["../src/dragdrop.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript code for the gapfill question type.\n *\n * @copyright  2020 Marcus Green\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport const init = (singleuse) => {\n  Window.singleuse = singleuse;\n  var draggables = document.querySelectorAll('span[class*=\"draggable\"]');\n  draggables.forEach(function(e) {\n    e.addEventListener('dragstart', dragStart);\n  });\n  document.querySelectorAll('input[class*=\"droptarget\"]').forEach(function(e) {\n    e.addEventListener(\"dblclick\", function() {\n      if (Window.singleuse) {\n        dragShow(this);\n      }\n      this.value = \"\";\n    });\n\n    e.addEventListener(\"drop\", drop);\n\n  });\n  /**\n   *\n   * @param {*} that\n   */\n  function dragShow(that) {\n    var targetVal = that.value;\n    draggables.forEach(function(e) {\n      if (e.innerText.trim() === targetVal.trim()) {\n        e.classList.remove(\"hide\");\n        that.value = \"\";\n      }\n    });\n  }\n\n  /**\n   * Stops strange things happening on ios drop event\n   * @param {*} e\n   */\n  document.addEventListener('dragover', function(e) {\n    e.preventDefault();\n  });\n\n\n  /**\n   *\n   * @param {*} e\n   */\n  function drop(e) {\n    dragShow(this);\n    e.target.value = e.dataTransfer.getData('text/plain');\n    var sourceId = e.dataTransfer.getData(\"sourceId\");\n    var sourceEl = document.getElementById(sourceId);\n    if (Window.singleuse) {\n      sourceEl.classList.add('hide');\n      e.preventDefault();\n    }\n    e.preventDefault();\n  }\n  /**\n   *\n   * @param {*} e\n   */\n   function dragStart(e) {\n    e.dataTransfer.setData('text/plain', e.target.innerText);\n    e.dataTransfer.setData('sourceId', this.id);\n    e.dataTransfer.effectAllowed = \"move\";\n    e.dataTransfer.dropEffect = \"move\";\n  }\n};\n\n"],"names":["singleuse","Window","draggables","document","querySelectorAll","dragShow","that","targetVal","value","forEach","e","innerText","trim","classList","remove","drop","this","target","dataTransfer","getData","sourceId","sourceEl","getElementById","add","preventDefault","dragStart","setData","id","effectAllowed","dropEffect","addEventListener"],"mappings":"2JAsBqBA,YACnBC,OAAOD,UAAYA,cACfE,WAAaC,SAASC,iBAAiB,qCAmBlCC,SAASC,UACZC,UAAYD,KAAKE,MACrBN,WAAWO,SAAQ,SAASC,GACtBA,EAAEC,UAAUC,SAAWL,UAAUK,SACnCF,EAAEG,UAAUC,OAAO,QACnBR,KAAKE,MAAQ,gBAkBVO,KAAKL,GACZL,SAASW,MACTN,EAAEO,OAAOT,MAAQE,EAAEQ,aAAaC,QAAQ,kBACpCC,SAAWV,EAAEQ,aAAaC,QAAQ,YAClCE,SAAWlB,SAASmB,eAAeF,UACnCnB,OAAOD,YACTqB,SAASR,UAAUU,IAAI,QACvBb,EAAEc,kBAEJd,EAAEc,0BAMMC,UAAUf,GAClBA,EAAEQ,aAAaQ,QAAQ,aAAchB,EAAEO,OAAON,WAC9CD,EAAEQ,aAAaQ,QAAQ,WAAYV,KAAKW,IACxCjB,EAAEQ,aAAaU,cAAgB,OAC/BlB,EAAEQ,aAAaW,WAAa,OA5D9B3B,WAAWO,SAAQ,SAASC,GAC1BA,EAAEoB,iBAAiB,YAAaL,cAElCtB,SAASC,iBAAiB,8BAA8BK,SAAQ,SAASC,GACvEA,EAAEoB,iBAAiB,YAAY,WACzB7B,OAAOD,WACTK,SAASW,WAENR,MAAQ,MAGfE,EAAEoB,iBAAiB,OAAQf,SAqB7BZ,SAAS2B,iBAAiB,YAAY,SAASpB,GAC7CA,EAAEc"}