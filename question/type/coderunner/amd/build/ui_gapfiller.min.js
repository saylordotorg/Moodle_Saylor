define ("qtype_coderunner/ui_gapfiller",["jquery"],function(a){function b(b,c,d,e){var f;this.textArea=a(document.getElementById(b));this.readOnly=this.textArea.prop("readonly");this.uiParams=e;this.fail=!1;this.htmlDiv=null;this.source=e.ui_source||"globalextra";if("globalextra"!==this.source&&"test0"!==this.source){alert("Invalid source for HTML in ui_gapfiller");this.source="globalextra"}if("globalextra"==this.source){f=this.textArea.attr("data-globalextra")}else{f=this.textArea.attr("data-test0")}this.html=f.replace("<","&lt;");this.reload()}b.prototype.failed=function(){return this.fail};b.prototype.sync=function(){var b=[],c=!0;this.getFields().each(function(){var d,e;d=a(this).attr("name");if("cr_gapfiller_field"!==d){alert("Unexpected UI element found in answer box")}else{e=a(this).val();b.push(e);if(""!==e){c=!1}}});if(c){this.textArea.val("")}else{this.textArea.val(JSON.stringify(b))}};b.prototype.getElement=function(){return this.htmlDiv};b.prototype.getFields=function(){return a(this.htmlDiv).find(".coderunner-ui-element")};b.prototype.setField=function(a,b){if("checkbox"===a.attr("type")||"radio"===a.attr("type")){a.prop("checked",a.val()===b)}else{a.val(b)}};b.prototype.markedUpHtml=function(){function a(a){for(var b,d="{[(*+\\",e="",f=0;f<a.length;f++){b=a[f];for(var g=0;g<d.length;g++){if(b===d[g]){b="\\"+b}}e+=b}return e}var b=a("{["),c=a("]}"),d=new RegExp(b+" *((?:\\d+)|(?:\\d+, *\\d+)) *"+c),e=this.html.split(d),f="<pre>"+e[0],g;for(g=1;g<e.length;g+=2){f+=this.markUp(e[g]);if(g+1<e.length){f+=e[g+1]}}f=f+"</pre>";return f};b.prototype.markUp=function(a){var d,e="";function b(a){return"<input name=\"cr_gapfiller_field\" class=\"coderunner-ui-element\" size=\""+a+"\">"}function c(a,b){return"<textarea name=\"cr_gapfiller_field\" class =\"coderunner-ui-element\" rows=\""+a+"\" cols=\""+b+"\" style=\"width:auto;\"></textarea>"}d=a.split(",");if(1==d.length){e=b(parseInt(d[0]))}else{e=c(parseInt(d[0]),parseInt(d[1]))}return e};b.prototype.reload=function(){var b=a(this.textArea).val(),c,d,e,f;this.htmlDiv=a("<div style='height:fit-content' class='qtype-coderunner-html-outer-div'>"+this.markedUpHtml()+"</div>");if(b){try{d=JSON.parse(b);f=this.getFields();for(e=0;e<f.length;e++){c=e<d.length?d[e]:"???";this.setField(a(f[e]),c)}}catch(a){}}};b.prototype.resize=function(){};b.prototype.hasFocus=function(){var a=!1;this.getFields().each(function(){if(this===document.activeElement){a=!0}});return a};b.prototype.destroy=function(){this.sync();a(this.htmlDiv).remove();this.htmlDiv=null};return{Constructor:b}});
//# sourceMappingURL=ui_gapfiller.min.js.map
