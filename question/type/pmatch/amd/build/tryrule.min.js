define("qtype_pmatch/tryrule",["exports","core/notification"],(function(_exports,_notification){var obj;
/**
   * This class provides functionality for try rule.
   *
   * This is based on the work of Dr Alistair Willis published:
   * http://aclweb.org/anthology/W/W15/W15-0628.pdf
   *
   * @module    qtype_pmatch
   * @class     tryrule
   * @copyright 2016 The Open University
   * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   * @since     2.9
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=(obj=_notification)&&obj.__esModule?obj:{default:obj};_exports.init=()=>{document.addEventListener("click",(e=>{const button=e.target.closest('input[name="tryrule"]');if(!button)return;e.preventDefault();const tryRow=button.closest(".try-rule");let ruleRow=tryRow;for(;!ruleRow.matches(".answer-rule");)ruleRow=ruleRow.previousElementSibling;((answerNumber,tryRow)=>{const rule=document.getElementById("id_answer_"+answerNumber).value;if(!rule)return;const pendingid={};M.util.js_pending(pendingid);const data=new FormData;data.append("type","tryrule"),data.append("qid",tryRow.closest("form").querySelector('input[name="id"]').value),data.append("ruletxt",rule),data.append("fraction",document.getElementById("id_fraction_"+answerNumber).value),data.append("sesskey",M.cfg.sesskey),fetch(M.cfg.wwwroot+"/question/type/pmatch/api/api.php",{method:"POST",body:data}).then((response=>response.json())).then((text=>{tryRow.querySelector(".try-rule-result").innerHTML=text,M.util.js_complete(pendingid)})).catch(_notification.default.exception)})(ruleRow.id.replace("fitem_id_answer_",""),tryRow)}))}}));

//# sourceMappingURL=tryrule.min.js.map