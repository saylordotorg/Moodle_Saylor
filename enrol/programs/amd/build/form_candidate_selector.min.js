define("enrol_programs/form_candidate_selector",["exports","core/ajax","core/templates","core/str"],(function(_exports,_ajax,_templates,_str){var obj;function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _transport(){return(_transport=_asyncToGenerator(regeneratorRuntime.mark((function _callee(selector,query,callback,failure){var programId,request,response,msg,labels;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return programId=document.querySelector(selector).closest("form").querySelector("[name=programid]").value,request={methodname:"enrol_programs_search_candidate",args:{programid:programId,query:query}},_context.prev=2,_context.next=5,_ajax.default.call([request])[0];case 5:if(!(response=_context.sent).overflow){_context.next=13;break}return _context.next=9,(0,_str.get_string)("toomanyuserstoshow","core",">"+response.maxusersperpage);case 9:msg=_context.sent,callback(msg),_context.next=20;break;case 13:return labels=[],response.list.forEach((function(user){labels.push((0,_templates.render)("core_user/form_user_selector_suggestion",user))})),_context.next=17,Promise.all(labels);case 17:labels=_context.sent,response.list.forEach((function(user,index){user.label=labels[index]})),callback(response.list);case 20:_context.next=25;break;case 22:_context.prev=22,_context.t0=_context.catch(2),failure(_context.t0);case 25:case"end":return _context.stop()}}),_callee,null,[[2,22]])})))).apply(this,arguments)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.processResults=function(selector,results){return Array.isArray(results)?results.map((function(result){return{value:result.id,label:result.label}})):results},_exports.transport=function(_x,_x2,_x3,_x4){return _transport.apply(this,arguments)},_ajax=(obj=_ajax)&&obj.__esModule?obj:{default:obj}}));

//# sourceMappingURL=form_candidate_selector.min.js.map